// This file was automatically generated by odin.
// Do not edit by hand as changes will be lost.
#include <R.h>
#include <Rmath.h>
#include <Rinternals.h>
#include <R_ext/Rdynload.h>
#include <stdbool.h>

typedef enum {
  CONSTANT,
  LINEAR,
  SPLINE
} interpolate_type;

typedef struct interpolate_data {
  interpolate_type type;
  size_t n;     // number of points
  size_t ny;    // number of y entries per 'x' point
  size_t i;     // index of last point checked
  double *x;    // x points of interpolation
  double *y;    // y points of interpolation
  double *k;    // knots when using spline interpolation
} interpolate_data;

interpolate_data * interpolate_alloc(interpolate_type type, size_t n,
                                     size_t ny, double *x, double *y);
void interpolate_free(interpolate_data* obj);
int interpolate_constant_run(double x, interpolate_data* obj, double *y);
int interpolate_linear_run(double x, interpolate_data* obj, double *y);
int interpolate_spline_run(double x, interpolate_data* obj, double *y);

// Utility:
int interpolate_search(double target, interpolate_data *obj);

// Splines
void spline_knots(size_t n, double *x, double* y, double *k, double **A);
double spline_eval_i(size_t i, double x, double *xs, double *ys, double *ks);
void gauss_solve(size_t n, double **A, double *x);
void spline_knots_A(size_t n, double *x, double *y, double **A);

// Interface:
void odin_interpolate_check(size_t nx, size_t ny, size_t i, const char *name_arg, const char *name_target);

// Collect together all the parameters and transient memory
// required to run the model in a struct.
typedef struct main_model_pars {
  int odin_use_dde;
  double replaceDeaths;
  int dim_c_t_comm;
  double *c_t_comm;
  int dim_c_t_noncomm;
  double *c_t_noncomm;
  int dim_c_y_comm;
  int dim_c_y_comm_1;
  int dim_c_y_comm_2;
  double *c_y_comm;
  int dim_c_y_noncomm;
  int dim_c_y_noncomm_1;
  int dim_c_y_noncomm_2;
  double *c_y_noncomm;
  double who_believe_comm;
  int dim_testing_prob_t;
  double *testing_prob_t;
  int dim_testing_prob_y;
  int dim_testing_prob_y_1;
  int dim_testing_prob_y_2;
  double *testing_prob_y;
  int dim_ART_prob_t;
  double *ART_prob_t;
  int dim_ART_prob_y;
  int dim_ART_prob_y_1;
  int dim_ART_prob_y_2;
  double *ART_prob_y;
  double RR_test_onPrEP;
  double RR_test_CD4200;
  double RR_ART_CD4200;
  int Ncat;
  double Nage;
  double infect_ART;
  double infect_acute;
  double infect_AIDS;
  double R;
  int dim_epsilon_t;
  double *epsilon_t;
  int dim_epsilon_y;
  double *epsilon_y;
  int dim_fc_t_comm;
  double *fc_t_comm;
  int dim_fc_y_comm;
  int dim_fc_y_comm_1;
  int dim_fc_y_comm_2;
  int dim_fc_y_comm_3;
  int dim_fc_y_comm_12;
  double *fc_y_comm;
  int dim_fP_t_comm;
  double *fP_t_comm;
  int dim_fP_y_comm;
  int dim_fP_y_comm_1;
  int dim_fP_y_comm_2;
  double *fP_y_comm;
  int dim_fc_t_noncomm;
  double *fc_t_noncomm;
  int dim_fc_y_noncomm;
  int dim_fc_y_noncomm_1;
  int dim_fc_y_noncomm_2;
  int dim_fc_y_noncomm_3;
  int dim_fc_y_noncomm_12;
  double *fc_y_noncomm;
  int dim_fP_t_noncomm;
  double *fP_t_noncomm;
  int dim_fP_y_noncomm;
  int dim_fP_y_noncomm_1;
  int dim_fP_y_noncomm_2;
  double *fP_y_noncomm;
  double dur_FSW;
  int dim_zetaa_t;
  double *zetaa_t;
  int dim_zetab_t;
  double *zetab_t;
  int dim_zetac_t;
  double *zetac_t;
  int dim_zetaa_y;
  int dim_zetaa_y_1;
  int dim_zetaa_y_2;
  double *zetaa_y;
  int dim_zetab_y;
  int dim_zetab_y_1;
  int dim_zetab_y_2;
  double *zetab_y;
  int dim_zetac_y;
  int dim_zetac_y_1;
  int dim_zetac_y_2;
  double *zetac_y;
  int dim_c_comm;
  double *c_comm;
  int offset_output_c_comm;
  int dim_c_noncomm;
  double *c_noncomm;
  int offset_output_c_noncomm;
  int dim_new_people_in_group;
  double *new_people_in_group;
  int offset_output_new_people_in_group;
  int dim_comm_partnerships_requested;
  int dim_comm_partnerships_requested_1;
  int dim_comm_partnerships_requested_2;
  double *comm_partnerships_requested;
  int dim_noncomm_partnerships_requested;
  int dim_noncomm_partnerships_requested_1;
  int dim_noncomm_partnerships_requested_2;
  double *noncomm_partnerships_requested;
  int dim_testing_prob;
  double *testing_prob;
  int offset_output_testing_prob;
  int dim_ART_prob;
  double *ART_prob;
  int offset_output_ART_prob;
  int dim_tau;
  double *tau;
  int offset_output_tau;
  int dim_rho;
  double *rho;
  int offset_output_rho;
  int dim_frac_F;
  double *frac_F;
  int offset_output_frac_F;
  int dim_frac_N_sexualpop;
  double *frac_N_sexualpop;
  int offset_output_frac_N_sexualpop;
  int dim_zetaa;
  double *zetaa;
  int offset_output_zetaa;
  int dim_zetab;
  double *zetab;
  int offset_output_zetab;
  int dim_zetac;
  double *zetac;
  int offset_output_zetac;
  int dim_omega;
  double *omega;
  int offset_output_omega;
  int dim_frac_N;
  double *frac_N;
  int offset_output_frac_N;
  int dim_mu;
  double *mu;
  int offset_output_mu;
  int dim_gamma01;
  double *gamma01;
  int offset_output_gamma01;
  int dim_gamma02;
  double *gamma02;
  int dim_gamma03;
  double *gamma03;
  int dim_gamma04;
  double *gamma04;
  int dim_gamma11;
  double *gamma11;
  int dim_gamma22;
  double *gamma22;
  int dim_gamma23;
  double *gamma23;
  int dim_gamma24;
  double *gamma24;
  int dim_gamma32;
  double *gamma32;
  int dim_gamma33;
  double *gamma33;
  int dim_gamma34;
  double *gamma34;
  int dim_gamma42;
  double *gamma42;
  int dim_gamma43;
  double *gamma43;
  int dim_gamma44;
  double *gamma44;
  int dim_phi2;
  double *phi2;
  int dim_phi3;
  double *phi3;
  int dim_phi4;
  double *phi4;
  int dim_phi5;
  double *phi5;
  int dim_psia;
  double *psia;
  int dim_psib;
  double *psib;
  int dim_kappaa;
  double *kappaa;
  int offset_output_kappaa;
  int dim_kappab;
  double *kappab;
  int offset_output_kappab;
  int dim_kappac;
  double *kappac;
  int offset_output_kappac;
  int dim_alpha01;
  double *alpha01;
  int dim_alpha02;
  double *alpha02;
  int dim_alpha03;
  double *alpha03;
  int dim_alpha04;
  double *alpha04;
  int dim_alpha05;
  double *alpha05;
  int offset_output_alpha05;
  int dim_alpha11;
  double *alpha11;
  int dim_alpha22;
  double *alpha22;
  int dim_alpha23;
  double *alpha23;
  int dim_alpha24;
  double *alpha24;
  int dim_alpha25;
  double *alpha25;
  int dim_alpha32;
  double *alpha32;
  int dim_alpha33;
  double *alpha33;
  int dim_alpha34;
  double *alpha34;
  int dim_alpha35;
  double *alpha35;
  int offset_output_alpha35;
  int dim_alpha42;
  double *alpha42;
  int dim_alpha43;
  double *alpha43;
  int dim_alpha44;
  double *alpha44;
  int dim_alpha45;
  double *alpha45;
  int dim_beta_comm;
  double *beta_comm;
  int offset_output_beta_comm;
  int dim_beta_noncomm;
  double *beta_noncomm;
  int offset_output_beta_noncomm;
  int dim_p_comm;
  int dim_p_comm_1;
  int dim_p_comm_2;
  double *p_comm;
  int offset_output_p_comm;
  int dim_p_noncomm;
  int dim_p_noncomm_1;
  int dim_p_noncomm_2;
  double *p_noncomm;
  int offset_output_p_noncomm;
  int dim_ec;
  double *ec;
  int dim_eP;
  double *eP;
  int dim_eP0;
  double *eP0;
  int dim_eP1a;
  double *eP1a;
  int dim_eP1b;
  double *eP1b;
  int dim_eP1c;
  double *eP1c;
  int dim_eP1d;
  double *eP1d;
  int dim_fc_comm;
  int dim_fc_comm_1;
  int dim_fc_comm_2;
  double *fc_comm;
  int offset_output_fc_comm;
  int dim_fP_comm;
  double *fP_comm;
  int offset_output_fP_comm;
  int dim_fc_noncomm;
  int dim_fc_noncomm_1;
  int dim_fc_noncomm_2;
  double *fc_noncomm;
  int offset_output_fc_noncomm;
  int dim_fP_noncomm;
  double *fP_noncomm;
  int offset_output_fP_noncomm;
  int dim_n_comm;
  int dim_n_comm_1;
  int dim_n_comm_2;
  double *n_comm;
  int offset_output_n_comm;
  int dim_n_noncomm;
  int dim_n_noncomm_1;
  int dim_n_noncomm_2;
  double *n_noncomm;
  int offset_output_n_noncomm;
  int dim_cumuInf;
  double *initial_cumuInf;
  int offset_cumuInf;
  int dim_OnPrEP;
  double *initial_OnPrEP;
  int offset_OnPrEP;
  int dim_S0;
  double *initial_S0;
  int offset_S0;
  int dim_S1a;
  double *initial_S1a;
  int offset_S1a;
  int dim_S1b;
  double *initial_S1b;
  int offset_S1b;
  int dim_S1c;
  double *initial_S1c;
  int offset_S1c;
  int dim_S1d;
  double *initial_S1d;
  int offset_S1d;
  int dim_I01;
  double *initial_I01;
  int offset_I01;
  int dim_I11;
  double *initial_I11;
  int offset_I11;
  int dim_I02;
  double *initial_I02;
  int offset_I02;
  int dim_I03;
  double *initial_I03;
  int offset_I03;
  int dim_I04;
  double *initial_I04;
  int offset_I04;
  int dim_I05;
  double *initial_I05;
  int offset_I05;
  int dim_I22;
  double *initial_I22;
  int offset_I22;
  int dim_I23;
  double *initial_I23;
  int offset_I23;
  int dim_I24;
  double *initial_I24;
  int offset_I24;
  int dim_I25;
  double *initial_I25;
  int offset_I25;
  int dim_I32;
  double *initial_I32;
  int offset_I32;
  int dim_I33;
  double *initial_I33;
  int offset_I33;
  int dim_I34;
  double *initial_I34;
  int offset_I34;
  int dim_I35;
  double *initial_I35;
  int offset_I35;
  int dim_I42;
  double *initial_I42;
  int offset_I42;
  int dim_I43;
  double *initial_I43;
  int offset_I43;
  int dim_I44;
  double *initial_I44;
  int offset_I44;
  int dim_I45;
  double *initial_I45;
  int offset_I45;
  int dim_S0_init;
  double *S0_init;
  int dim_S1a_init;
  double *S1a_init;
  int dim_S1b_init;
  double *S1b_init;
  int dim_S1c_init;
  double *S1c_init;
  int dim_S1d_init;
  double *S1d_init;
  int dim_I01_init;
  double *I01_init;
  int dim_I11_init;
  double *I11_init;
  int dim_I02_init;
  double *I02_init;
  int dim_I03_init;
  double *I03_init;
  int dim_I04_init;
  double *I04_init;
  int dim_I05_init;
  double *I05_init;
  int dim_I22_init;
  double *I22_init;
  int dim_I23_init;
  double *I23_init;
  int dim_I24_init;
  double *I24_init;
  int dim_I25_init;
  double *I25_init;
  int dim_I32_init;
  double *I32_init;
  int dim_I33_init;
  double *I33_init;
  int dim_I34_init;
  double *I34_init;
  int dim_I35_init;
  double *I35_init;
  int dim_I42_init;
  double *I42_init;
  int dim_I43_init;
  double *I43_init;
  int dim_I44_init;
  double *I44_init;
  int dim_I45_init;
  double *I45_init;
  int dim_N;
  double *N;
  int offset_output_N;
  int dim_E0;
  double *E0;
  int offset_output_E0;
  int dim_E1a;
  double *E1a;
  int offset_output_E1a;
  int dim_E1b;
  double *E1b;
  int offset_output_E1b;
  int dim_E1c;
  double *E1c;
  int offset_output_E1c;
  int dim_E1d;
  double *E1d;
  int offset_output_E1d;
  int dim_cumuInf_init;
  double *cumuInf_init;
  int dim_alphaItot;
  double *alphaItot;
  int offset_output_alphaItot;
  int dim_prev;
  double *prev;
  int offset_output_prev;
  int dim_lambda;
  int dim_lambda_1;
  int dim_lambda_2;
  double *lambda;
  int offset_output_lambda;
  int dim_lambda_0;
  int dim_lambda_0_1;
  int dim_lambda_0_2;
  double *lambda_0;
  int offset_output_lambda_0;
  int dim_lambda_1a;
  int dim_lambda_1a_1;
  int dim_lambda_1a_2;
  double *lambda_1a;
  int offset_output_lambda_1a;
  int dim_lambda_1b;
  int dim_lambda_1b_1;
  int dim_lambda_1b_2;
  double *lambda_1b;
  int offset_output_lambda_1b;
  int dim_lambda_1c;
  int dim_lambda_1c_1;
  int dim_lambda_1c_2;
  double *lambda_1c;
  int offset_output_lambda_1c;
  int dim_lambda_1d;
  int dim_lambda_1d_1;
  int dim_lambda_1d_2;
  double *lambda_1d;
  int offset_output_lambda_1d;
  int dim_lambda_sum_0;
  double *lambda_sum_0;
  int offset_output_lambda_sum_0;
  int dim_lambda_sum_1a;
  double *lambda_sum_1a;
  int offset_output_lambda_sum_1a;
  int dim_lambda_sum_1b;
  double *lambda_sum_1b;
  int offset_output_lambda_sum_1b;
  int dim_lambda_sum_1c;
  double *lambda_sum_1c;
  int offset_output_lambda_sum_1c;
  int dim_lambda_sum_1d;
  double *lambda_sum_1d;
  int offset_output_lambda_sum_1d;
  int dim_c_comm_balanced;
  double *c_comm_balanced;
  int offset_output_c_comm_balanced;
  int dim_c_noncomm_balanced;
  double *c_noncomm_balanced;
  int offset_output_c_noncomm_balanced;
  int dim_theta;
  int dim_theta_1;
  int dim_theta_2;
  double *theta;
  int offset_output_theta;
  int dim_OnPrEP_init;
  double *OnPrEP_init;
  int dim_M_comm;
  int dim_M_comm_1;
  int dim_M_comm_2;
  double *M_comm;
  int offset_output_M_comm;
  int dim_M_noncomm;
  int dim_M_noncomm_1;
  int dim_M_noncomm_2;
  double *M_noncomm;
  int offset_output_M_noncomm;
  int dim_in_S0;
  int dim_in_S0_1;
  int dim_in_S0_2;
  double *in_S0;
  int dim_in_S1a;
  int dim_in_S1a_1;
  int dim_in_S1a_2;
  double *in_S1a;
  int dim_in_S1b;
  int dim_in_S1b_1;
  int dim_in_S1b_2;
  double *in_S1b;
  int dim_in_S1c;
  int dim_in_S1c_1;
  int dim_in_S1c_2;
  double *in_S1c;
  int dim_in_S1d;
  int dim_in_S1d_1;
  int dim_in_S1d_2;
  double *in_S1d;
  int dim_in_I01;
  int dim_in_I01_1;
  int dim_in_I01_2;
  double *in_I01;
  int dim_in_I11;
  int dim_in_I11_1;
  int dim_in_I11_2;
  double *in_I11;
  int dim_in_I02;
  int dim_in_I02_1;
  int dim_in_I02_2;
  double *in_I02;
  int dim_in_I03;
  int dim_in_I03_1;
  int dim_in_I03_2;
  double *in_I03;
  int dim_in_I04;
  int dim_in_I04_1;
  int dim_in_I04_2;
  double *in_I04;
  int dim_in_I05;
  int dim_in_I05_1;
  int dim_in_I05_2;
  double *in_I05;
  int dim_in_I22;
  int dim_in_I22_1;
  int dim_in_I22_2;
  double *in_I22;
  int dim_in_I23;
  int dim_in_I23_1;
  int dim_in_I23_2;
  double *in_I23;
  int dim_in_I24;
  int dim_in_I24_1;
  int dim_in_I24_2;
  double *in_I24;
  int dim_in_I25;
  int dim_in_I25_1;
  int dim_in_I25_2;
  double *in_I25;
  int dim_in_I32;
  int dim_in_I32_1;
  int dim_in_I32_2;
  double *in_I32;
  int dim_in_I33;
  int dim_in_I33_1;
  int dim_in_I33_2;
  double *in_I33;
  int dim_in_I34;
  int dim_in_I34_1;
  int dim_in_I34_2;
  double *in_I34;
  int dim_in_I35;
  int dim_in_I35_1;
  int dim_in_I35_2;
  double *in_I35;
  int dim_in_I42;
  int dim_in_I42_1;
  int dim_in_I42_2;
  double *in_I42;
  int dim_in_I43;
  int dim_in_I43_1;
  int dim_in_I43_2;
  double *in_I43;
  int dim_in_I44;
  int dim_in_I44_1;
  int dim_in_I44_2;
  double *in_I44;
  int dim_in_I45;
  int dim_in_I45_1;
  int dim_in_I45_2;
  double *in_I45;
  int dim_sum_in_S0;
  double *sum_in_S0;
  int offset_output_sum_in_S0;
  int dim_rate_move_in;
  int dim_rate_move_in_1;
  int dim_rate_move_in_2;
  double *rate_move_in;
  int offset_output_rate_move_in;
  int dim_rate_move_out;
  double *rate_move_out;
  int offset_output_rate_move_out;
  interpolate_data *interpolate_c_comm;
  interpolate_data *interpolate_c_noncomm;
  interpolate_data *interpolate_testing_prob;
  interpolate_data *interpolate_ART_prob;
  interpolate_data *interpolate_epsilon;
  double epsilon;
  interpolate_data *interpolate_zetaa;
  interpolate_data *interpolate_zetab;
  interpolate_data *interpolate_zetac;
  interpolate_data *interpolate_fc_comm;
  interpolate_data *interpolate_fP_comm;
  interpolate_data *interpolate_fc_noncomm;
  interpolate_data *interpolate_fP_noncomm;
  int dim;
  int dim_output;
} main_model_pars;
main_model_pars* main_model_get_pointer(SEXP main_model_ptr, int closed_error);
SEXP main_model_set_user(main_model_pars *main_model_p, SEXP user);

SEXP get_ds_pars();
double get_user_double(SEXP user, const char *name, double default_value);
double* get_user_array_dim(SEXP user, const char *name, bool is_real, int nd, int *dest_dim);
SEXP get_user_array_check_rank(SEXP user, const char *name, int nd);
void get_user_array_copy(SEXP el, const char *name, bool is_real, void *dest);
void odin_set_dim(SEXP target, int nd, ...);
int get_user_int(SEXP user, const char *name, int default_value);
void get_user_array(SEXP user, const char *name, bool is_real, void *dest, int nd, ...);
SEXP get_list_element(SEXP list, const char *name);
double odin_sum1(double *x, int from_i, int to_i);
double odin_sum2(double *x, int from_i, int to_i, int from_j, int to_j, int dim_x_1);
double FOI_part(double I, double N, double beta, double RR, double fc, double fP, double n, double eP, double ec);
double all_FOI_together(double c, double p, double S0, double S1a, double S1b, double S1c, double I01, double I11, double I02, double I03, double I04, double I05, double I22, double I23, double I24, double I25, double I32, double I33, double I34, double I35, double I42, double I43, double I44, double I45, double N, double beta, double R, double fc, double fP, double n, double eP, double ec, double infect_ART, double infect_acute, double infect_AIDS);
double compute_lambda(double c_comm, double p_comm, double S0, double S1a, double S1b, double S1c, double I01, double I11, double I02, double I03, double I04, double I05, double I22, double I23, double I24, double I25, double I32, double I33, double I34, double I35, double I42, double I43, double I44, double I45, double N, double beta_comm, double R, double fc_comm, double fP_comm, double n_comm, double eP, double ec, double fc_noncomm, double fP_noncomm, double n_noncomm, double c_noncomm, double p_noncomm, double infect_ART, double infect_acute, double infect_AIDS,  double beta_noncomm);

// Create the pointer; this will establish the struct, allocate
// memory for things that are constant size, and initialize
// constant variables
static void main_model_finalize(SEXP main_model_ptr);
SEXP main_model_create(SEXP user, SEXP odin_use_dde) {
  main_model_pars *main_model_p = (main_model_pars*) Calloc(1, main_model_pars);
  main_model_p->replaceDeaths = NA_REAL;
  main_model_p->c_t_comm = NULL;
  main_model_p->c_t_noncomm = NULL;
  main_model_p->c_y_comm = NULL;
  main_model_p->c_y_noncomm = NULL;
  main_model_p->who_believe_comm = NA_REAL;
  main_model_p->testing_prob_t = NULL;
  main_model_p->testing_prob_y = NULL;
  main_model_p->ART_prob_t = NULL;
  main_model_p->ART_prob_y = NULL;
  main_model_p->RR_test_onPrEP = NA_REAL;
  main_model_p->RR_test_CD4200 = NA_REAL;
  main_model_p->RR_ART_CD4200 = NA_REAL;
  main_model_p->Ncat = NA_INTEGER;
  main_model_p->Nage = NA_REAL;
  main_model_p->infect_ART = NA_REAL;
  main_model_p->infect_acute = NA_REAL;
  main_model_p->infect_AIDS = NA_REAL;
  main_model_p->R = NA_REAL;
  main_model_p->epsilon_t = NULL;
  main_model_p->epsilon_y = NULL;
  main_model_p->fc_t_comm = NULL;
  main_model_p->fc_y_comm = NULL;
  main_model_p->fP_t_comm = NULL;
  main_model_p->fP_y_comm = NULL;
  main_model_p->fc_t_noncomm = NULL;
  main_model_p->fc_y_noncomm = NULL;
  main_model_p->fP_t_noncomm = NULL;
  main_model_p->fP_y_noncomm = NULL;
  main_model_p->dur_FSW = NA_REAL;
  main_model_p->zetaa_t = NULL;
  main_model_p->zetab_t = NULL;
  main_model_p->zetac_t = NULL;
  main_model_p->zetaa_y = NULL;
  main_model_p->zetab_y = NULL;
  main_model_p->zetac_y = NULL;
  main_model_p->c_comm = NULL;
  main_model_p->c_noncomm = NULL;
  main_model_p->new_people_in_group = NULL;
  main_model_p->comm_partnerships_requested = NULL;
  main_model_p->noncomm_partnerships_requested = NULL;
  main_model_p->testing_prob = NULL;
  main_model_p->ART_prob = NULL;
  main_model_p->tau = NULL;
  main_model_p->rho = NULL;
  main_model_p->frac_F = NULL;
  main_model_p->frac_N_sexualpop = NULL;
  main_model_p->zetaa = NULL;
  main_model_p->zetab = NULL;
  main_model_p->zetac = NULL;
  main_model_p->omega = NULL;
  main_model_p->frac_N = NULL;
  main_model_p->mu = NULL;
  main_model_p->gamma01 = NULL;
  main_model_p->gamma02 = NULL;
  main_model_p->gamma03 = NULL;
  main_model_p->gamma04 = NULL;
  main_model_p->gamma11 = NULL;
  main_model_p->gamma22 = NULL;
  main_model_p->gamma23 = NULL;
  main_model_p->gamma24 = NULL;
  main_model_p->gamma32 = NULL;
  main_model_p->gamma33 = NULL;
  main_model_p->gamma34 = NULL;
  main_model_p->gamma42 = NULL;
  main_model_p->gamma43 = NULL;
  main_model_p->gamma44 = NULL;
  main_model_p->phi2 = NULL;
  main_model_p->phi3 = NULL;
  main_model_p->phi4 = NULL;
  main_model_p->phi5 = NULL;
  main_model_p->psia = NULL;
  main_model_p->psib = NULL;
  main_model_p->kappaa = NULL;
  main_model_p->kappab = NULL;
  main_model_p->kappac = NULL;
  main_model_p->alpha01 = NULL;
  main_model_p->alpha02 = NULL;
  main_model_p->alpha03 = NULL;
  main_model_p->alpha04 = NULL;
  main_model_p->alpha05 = NULL;
  main_model_p->alpha11 = NULL;
  main_model_p->alpha22 = NULL;
  main_model_p->alpha23 = NULL;
  main_model_p->alpha24 = NULL;
  main_model_p->alpha25 = NULL;
  main_model_p->alpha32 = NULL;
  main_model_p->alpha33 = NULL;
  main_model_p->alpha34 = NULL;
  main_model_p->alpha35 = NULL;
  main_model_p->alpha42 = NULL;
  main_model_p->alpha43 = NULL;
  main_model_p->alpha44 = NULL;
  main_model_p->alpha45 = NULL;
  main_model_p->beta_comm = NULL;
  main_model_p->beta_noncomm = NULL;
  main_model_p->p_comm = NULL;
  main_model_p->p_noncomm = NULL;
  main_model_p->ec = NULL;
  main_model_p->eP = NULL;
  main_model_p->eP0 = NULL;
  main_model_p->eP1a = NULL;
  main_model_p->eP1b = NULL;
  main_model_p->eP1c = NULL;
  main_model_p->eP1d = NULL;
  main_model_p->fc_comm = NULL;
  main_model_p->fP_comm = NULL;
  main_model_p->fc_noncomm = NULL;
  main_model_p->fP_noncomm = NULL;
  main_model_p->n_comm = NULL;
  main_model_p->n_noncomm = NULL;
  main_model_p->initial_cumuInf = NULL;
  main_model_p->initial_OnPrEP = NULL;
  main_model_p->initial_S0 = NULL;
  main_model_p->initial_S1a = NULL;
  main_model_p->initial_S1b = NULL;
  main_model_p->initial_S1c = NULL;
  main_model_p->initial_S1d = NULL;
  main_model_p->initial_I01 = NULL;
  main_model_p->initial_I11 = NULL;
  main_model_p->initial_I02 = NULL;
  main_model_p->initial_I03 = NULL;
  main_model_p->initial_I04 = NULL;
  main_model_p->initial_I05 = NULL;
  main_model_p->initial_I22 = NULL;
  main_model_p->initial_I23 = NULL;
  main_model_p->initial_I24 = NULL;
  main_model_p->initial_I25 = NULL;
  main_model_p->initial_I32 = NULL;
  main_model_p->initial_I33 = NULL;
  main_model_p->initial_I34 = NULL;
  main_model_p->initial_I35 = NULL;
  main_model_p->initial_I42 = NULL;
  main_model_p->initial_I43 = NULL;
  main_model_p->initial_I44 = NULL;
  main_model_p->initial_I45 = NULL;
  main_model_p->S0_init = NULL;
  main_model_p->S1a_init = NULL;
  main_model_p->S1b_init = NULL;
  main_model_p->S1c_init = NULL;
  main_model_p->S1d_init = NULL;
  main_model_p->I01_init = NULL;
  main_model_p->I11_init = NULL;
  main_model_p->I02_init = NULL;
  main_model_p->I03_init = NULL;
  main_model_p->I04_init = NULL;
  main_model_p->I05_init = NULL;
  main_model_p->I22_init = NULL;
  main_model_p->I23_init = NULL;
  main_model_p->I24_init = NULL;
  main_model_p->I25_init = NULL;
  main_model_p->I32_init = NULL;
  main_model_p->I33_init = NULL;
  main_model_p->I34_init = NULL;
  main_model_p->I35_init = NULL;
  main_model_p->I42_init = NULL;
  main_model_p->I43_init = NULL;
  main_model_p->I44_init = NULL;
  main_model_p->I45_init = NULL;
  main_model_p->N = NULL;
  main_model_p->E0 = NULL;
  main_model_p->E1a = NULL;
  main_model_p->E1b = NULL;
  main_model_p->E1c = NULL;
  main_model_p->E1d = NULL;
  main_model_p->cumuInf_init = NULL;
  main_model_p->alphaItot = NULL;
  main_model_p->prev = NULL;
  main_model_p->lambda = NULL;
  main_model_p->lambda_0 = NULL;
  main_model_p->lambda_1a = NULL;
  main_model_p->lambda_1b = NULL;
  main_model_p->lambda_1c = NULL;
  main_model_p->lambda_1d = NULL;
  main_model_p->lambda_sum_0 = NULL;
  main_model_p->lambda_sum_1a = NULL;
  main_model_p->lambda_sum_1b = NULL;
  main_model_p->lambda_sum_1c = NULL;
  main_model_p->lambda_sum_1d = NULL;
  main_model_p->c_comm_balanced = NULL;
  main_model_p->c_noncomm_balanced = NULL;
  main_model_p->theta = NULL;
  main_model_p->OnPrEP_init = NULL;
  main_model_p->M_comm = NULL;
  main_model_p->M_noncomm = NULL;
  main_model_p->in_S0 = NULL;
  main_model_p->in_S1a = NULL;
  main_model_p->in_S1b = NULL;
  main_model_p->in_S1c = NULL;
  main_model_p->in_S1d = NULL;
  main_model_p->in_I01 = NULL;
  main_model_p->in_I11 = NULL;
  main_model_p->in_I02 = NULL;
  main_model_p->in_I03 = NULL;
  main_model_p->in_I04 = NULL;
  main_model_p->in_I05 = NULL;
  main_model_p->in_I22 = NULL;
  main_model_p->in_I23 = NULL;
  main_model_p->in_I24 = NULL;
  main_model_p->in_I25 = NULL;
  main_model_p->in_I32 = NULL;
  main_model_p->in_I33 = NULL;
  main_model_p->in_I34 = NULL;
  main_model_p->in_I35 = NULL;
  main_model_p->in_I42 = NULL;
  main_model_p->in_I43 = NULL;
  main_model_p->in_I44 = NULL;
  main_model_p->in_I45 = NULL;
  main_model_p->sum_in_S0 = NULL;
  main_model_p->rate_move_in = NULL;
  main_model_p->rate_move_out = NULL;
  SEXP main_model_ptr = PROTECT(R_MakeExternalPtr(main_model_p, R_NilValue, R_NilValue));
  R_RegisterCFinalizer(main_model_ptr, main_model_finalize);
  main_model_set_user(main_model_p, user);
  main_model_p->odin_use_dde = INTEGER(odin_use_dde)[0];
  UNPROTECT(1);
  return main_model_ptr;
}

// Set user-supplied parameter values.
SEXP main_model_set_user(main_model_pars *main_model_p, SEXP user) {
  main_model_p->replaceDeaths = get_user_double(user, "replaceDeaths", main_model_p->replaceDeaths);
  Free(main_model_p->c_t_comm);
  {
    double *tmp = (double*)get_user_array_dim(user, "c_t_comm", true, 1, &main_model_p->dim_c_t_comm);
    main_model_p->c_t_comm = (double*) Calloc(main_model_p->dim_c_t_comm, double);
    memcpy(main_model_p->c_t_comm, tmp, main_model_p->dim_c_t_comm * sizeof(double));
    Free(tmp);
  }
  Free(main_model_p->c_t_noncomm);
  {
    double *tmp = (double*)get_user_array_dim(user, "c_t_noncomm", true, 1, &main_model_p->dim_c_t_noncomm);
    main_model_p->c_t_noncomm = (double*) Calloc(main_model_p->dim_c_t_noncomm, double);
    memcpy(main_model_p->c_t_noncomm, tmp, main_model_p->dim_c_t_noncomm * sizeof(double));
    Free(tmp);
  }
  Free(main_model_p->c_y_comm);
  {
    int tmp_dim[2];
    double *tmp = get_user_array_dim(user, "c_y_comm", true, 2, tmp_dim);
    main_model_p->dim_c_y_comm_1 = tmp_dim[0];
    main_model_p->dim_c_y_comm_2 = tmp_dim[1];
    main_model_p->dim_c_y_comm = main_model_p->dim_c_y_comm_1 * main_model_p->dim_c_y_comm_2;
    main_model_p->c_y_comm = (double*) Calloc(main_model_p->dim_c_y_comm, double);
    memcpy(main_model_p->c_y_comm, tmp, main_model_p->dim_c_y_comm * sizeof(double));
    Free(tmp);
  }
  Free(main_model_p->c_y_noncomm);
  {
    int tmp_dim[2];
    double *tmp = get_user_array_dim(user, "c_y_noncomm", true, 2, tmp_dim);
    main_model_p->dim_c_y_noncomm_1 = tmp_dim[0];
    main_model_p->dim_c_y_noncomm_2 = tmp_dim[1];
    main_model_p->dim_c_y_noncomm = main_model_p->dim_c_y_noncomm_1 * main_model_p->dim_c_y_noncomm_2;
    main_model_p->c_y_noncomm = (double*) Calloc(main_model_p->dim_c_y_noncomm, double);
    memcpy(main_model_p->c_y_noncomm, tmp, main_model_p->dim_c_y_noncomm * sizeof(double));
    Free(tmp);
  }
  main_model_p->who_believe_comm = get_user_double(user, "who_believe_comm", main_model_p->who_believe_comm);
  Free(main_model_p->testing_prob_t);
  {
    double *tmp = (double*)get_user_array_dim(user, "testing_prob_t", true, 1, &main_model_p->dim_testing_prob_t);
    main_model_p->testing_prob_t = (double*) Calloc(main_model_p->dim_testing_prob_t, double);
    memcpy(main_model_p->testing_prob_t, tmp, main_model_p->dim_testing_prob_t * sizeof(double));
    Free(tmp);
  }
  Free(main_model_p->testing_prob_y);
  {
    int tmp_dim[2];
    double *tmp = get_user_array_dim(user, "testing_prob_y", true, 2, tmp_dim);
    main_model_p->dim_testing_prob_y_1 = tmp_dim[0];
    main_model_p->dim_testing_prob_y_2 = tmp_dim[1];
    main_model_p->dim_testing_prob_y = main_model_p->dim_testing_prob_y_1 * main_model_p->dim_testing_prob_y_2;
    main_model_p->testing_prob_y = (double*) Calloc(main_model_p->dim_testing_prob_y, double);
    memcpy(main_model_p->testing_prob_y, tmp, main_model_p->dim_testing_prob_y * sizeof(double));
    Free(tmp);
  }
  Free(main_model_p->ART_prob_t);
  {
    double *tmp = (double*)get_user_array_dim(user, "ART_prob_t", true, 1, &main_model_p->dim_ART_prob_t);
    main_model_p->ART_prob_t = (double*) Calloc(main_model_p->dim_ART_prob_t, double);
    memcpy(main_model_p->ART_prob_t, tmp, main_model_p->dim_ART_prob_t * sizeof(double));
    Free(tmp);
  }
  Free(main_model_p->ART_prob_y);
  {
    int tmp_dim[2];
    double *tmp = get_user_array_dim(user, "ART_prob_y", true, 2, tmp_dim);
    main_model_p->dim_ART_prob_y_1 = tmp_dim[0];
    main_model_p->dim_ART_prob_y_2 = tmp_dim[1];
    main_model_p->dim_ART_prob_y = main_model_p->dim_ART_prob_y_1 * main_model_p->dim_ART_prob_y_2;
    main_model_p->ART_prob_y = (double*) Calloc(main_model_p->dim_ART_prob_y, double);
    memcpy(main_model_p->ART_prob_y, tmp, main_model_p->dim_ART_prob_y * sizeof(double));
    Free(tmp);
  }
  main_model_p->RR_test_onPrEP = get_user_double(user, "RR_test_onPrEP", main_model_p->RR_test_onPrEP);
  main_model_p->RR_test_CD4200 = get_user_double(user, "RR_test_CD4200", main_model_p->RR_test_CD4200);
  main_model_p->RR_ART_CD4200 = get_user_double(user, "RR_ART_CD4200", main_model_p->RR_ART_CD4200);
  main_model_p->Ncat = get_user_int(user, "Ncat", main_model_p->Ncat);
  main_model_p->Nage = get_user_double(user, "Nage", main_model_p->Nage);
  main_model_p->infect_ART = get_user_double(user, "infect_ART", main_model_p->infect_ART);
  main_model_p->infect_acute = get_user_double(user, "infect_acute", main_model_p->infect_acute);
  main_model_p->infect_AIDS = get_user_double(user, "infect_AIDS", main_model_p->infect_AIDS);
  main_model_p->R = get_user_double(user, "R", main_model_p->R);
  Free(main_model_p->epsilon_t);
  {
    double *tmp = (double*)get_user_array_dim(user, "epsilon_t", true, 1, &main_model_p->dim_epsilon_t);
    main_model_p->epsilon_t = (double*) Calloc(main_model_p->dim_epsilon_t, double);
    memcpy(main_model_p->epsilon_t, tmp, main_model_p->dim_epsilon_t * sizeof(double));
    Free(tmp);
  }
  Free(main_model_p->epsilon_y);
  {
    double *tmp = (double*)get_user_array_dim(user, "epsilon_y", true, 1, &main_model_p->dim_epsilon_y);
    main_model_p->epsilon_y = (double*) Calloc(main_model_p->dim_epsilon_y, double);
    memcpy(main_model_p->epsilon_y, tmp, main_model_p->dim_epsilon_y * sizeof(double));
    Free(tmp);
  }
  Free(main_model_p->fc_t_comm);
  {
    double *tmp = (double*)get_user_array_dim(user, "fc_t_comm", true, 1, &main_model_p->dim_fc_t_comm);
    main_model_p->fc_t_comm = (double*) Calloc(main_model_p->dim_fc_t_comm, double);
    memcpy(main_model_p->fc_t_comm, tmp, main_model_p->dim_fc_t_comm * sizeof(double));
    Free(tmp);
  }
  Free(main_model_p->fc_y_comm);
  {
    int tmp_dim[3];
    double *tmp = get_user_array_dim(user, "fc_y_comm", true, 3, tmp_dim);
    main_model_p->dim_fc_y_comm_1 = tmp_dim[0];
    main_model_p->dim_fc_y_comm_2 = tmp_dim[1];
    main_model_p->dim_fc_y_comm_3 = tmp_dim[2];
    main_model_p->dim_fc_y_comm_12 = main_model_p->dim_fc_y_comm_1 * main_model_p->dim_fc_y_comm_2;
    main_model_p->dim_fc_y_comm = main_model_p->dim_fc_y_comm_1 * main_model_p->dim_fc_y_comm_2 * main_model_p->dim_fc_y_comm_3;
    main_model_p->fc_y_comm = (double*) Calloc(main_model_p->dim_fc_y_comm, double);
    memcpy(main_model_p->fc_y_comm, tmp, main_model_p->dim_fc_y_comm * sizeof(double));
    Free(tmp);
  }
  Free(main_model_p->fP_t_comm);
  {
    double *tmp = (double*)get_user_array_dim(user, "fP_t_comm", true, 1, &main_model_p->dim_fP_t_comm);
    main_model_p->fP_t_comm = (double*) Calloc(main_model_p->dim_fP_t_comm, double);
    memcpy(main_model_p->fP_t_comm, tmp, main_model_p->dim_fP_t_comm * sizeof(double));
    Free(tmp);
  }
  Free(main_model_p->fP_y_comm);
  {
    int tmp_dim[2];
    double *tmp = get_user_array_dim(user, "fP_y_comm", true, 2, tmp_dim);
    main_model_p->dim_fP_y_comm_1 = tmp_dim[0];
    main_model_p->dim_fP_y_comm_2 = tmp_dim[1];
    main_model_p->dim_fP_y_comm = main_model_p->dim_fP_y_comm_1 * main_model_p->dim_fP_y_comm_2;
    main_model_p->fP_y_comm = (double*) Calloc(main_model_p->dim_fP_y_comm, double);
    memcpy(main_model_p->fP_y_comm, tmp, main_model_p->dim_fP_y_comm * sizeof(double));
    Free(tmp);
  }
  Free(main_model_p->fc_t_noncomm);
  {
    double *tmp = (double*)get_user_array_dim(user, "fc_t_noncomm", true, 1, &main_model_p->dim_fc_t_noncomm);
    main_model_p->fc_t_noncomm = (double*) Calloc(main_model_p->dim_fc_t_noncomm, double);
    memcpy(main_model_p->fc_t_noncomm, tmp, main_model_p->dim_fc_t_noncomm * sizeof(double));
    Free(tmp);
  }
  Free(main_model_p->fc_y_noncomm);
  {
    int tmp_dim[3];
    double *tmp = get_user_array_dim(user, "fc_y_noncomm", true, 3, tmp_dim);
    main_model_p->dim_fc_y_noncomm_1 = tmp_dim[0];
    main_model_p->dim_fc_y_noncomm_2 = tmp_dim[1];
    main_model_p->dim_fc_y_noncomm_3 = tmp_dim[2];
    main_model_p->dim_fc_y_noncomm_12 = main_model_p->dim_fc_y_noncomm_1 * main_model_p->dim_fc_y_noncomm_2;
    main_model_p->dim_fc_y_noncomm = main_model_p->dim_fc_y_noncomm_1 * main_model_p->dim_fc_y_noncomm_2 * main_model_p->dim_fc_y_noncomm_3;
    main_model_p->fc_y_noncomm = (double*) Calloc(main_model_p->dim_fc_y_noncomm, double);
    memcpy(main_model_p->fc_y_noncomm, tmp, main_model_p->dim_fc_y_noncomm * sizeof(double));
    Free(tmp);
  }
  Free(main_model_p->fP_t_noncomm);
  {
    double *tmp = (double*)get_user_array_dim(user, "fP_t_noncomm", true, 1, &main_model_p->dim_fP_t_noncomm);
    main_model_p->fP_t_noncomm = (double*) Calloc(main_model_p->dim_fP_t_noncomm, double);
    memcpy(main_model_p->fP_t_noncomm, tmp, main_model_p->dim_fP_t_noncomm * sizeof(double));
    Free(tmp);
  }
  Free(main_model_p->fP_y_noncomm);
  {
    int tmp_dim[2];
    double *tmp = get_user_array_dim(user, "fP_y_noncomm", true, 2, tmp_dim);
    main_model_p->dim_fP_y_noncomm_1 = tmp_dim[0];
    main_model_p->dim_fP_y_noncomm_2 = tmp_dim[1];
    main_model_p->dim_fP_y_noncomm = main_model_p->dim_fP_y_noncomm_1 * main_model_p->dim_fP_y_noncomm_2;
    main_model_p->fP_y_noncomm = (double*) Calloc(main_model_p->dim_fP_y_noncomm, double);
    memcpy(main_model_p->fP_y_noncomm, tmp, main_model_p->dim_fP_y_noncomm * sizeof(double));
    Free(tmp);
  }
  main_model_p->dur_FSW = get_user_double(user, "dur_FSW", main_model_p->dur_FSW);
  Free(main_model_p->zetaa_t);
  {
    double *tmp = (double*)get_user_array_dim(user, "zetaa_t", true, 1, &main_model_p->dim_zetaa_t);
    main_model_p->zetaa_t = (double*) Calloc(main_model_p->dim_zetaa_t, double);
    memcpy(main_model_p->zetaa_t, tmp, main_model_p->dim_zetaa_t * sizeof(double));
    Free(tmp);
  }
  Free(main_model_p->zetab_t);
  {
    double *tmp = (double*)get_user_array_dim(user, "zetab_t", true, 1, &main_model_p->dim_zetab_t);
    main_model_p->zetab_t = (double*) Calloc(main_model_p->dim_zetab_t, double);
    memcpy(main_model_p->zetab_t, tmp, main_model_p->dim_zetab_t * sizeof(double));
    Free(tmp);
  }
  Free(main_model_p->zetac_t);
  {
    double *tmp = (double*)get_user_array_dim(user, "zetac_t", true, 1, &main_model_p->dim_zetac_t);
    main_model_p->zetac_t = (double*) Calloc(main_model_p->dim_zetac_t, double);
    memcpy(main_model_p->zetac_t, tmp, main_model_p->dim_zetac_t * sizeof(double));
    Free(tmp);
  }
  Free(main_model_p->zetaa_y);
  {
    int tmp_dim[2];
    double *tmp = get_user_array_dim(user, "zetaa_y", true, 2, tmp_dim);
    main_model_p->dim_zetaa_y_1 = tmp_dim[0];
    main_model_p->dim_zetaa_y_2 = tmp_dim[1];
    main_model_p->dim_zetaa_y = main_model_p->dim_zetaa_y_1 * main_model_p->dim_zetaa_y_2;
    main_model_p->zetaa_y = (double*) Calloc(main_model_p->dim_zetaa_y, double);
    memcpy(main_model_p->zetaa_y, tmp, main_model_p->dim_zetaa_y * sizeof(double));
    Free(tmp);
  }
  Free(main_model_p->zetab_y);
  {
    int tmp_dim[2];
    double *tmp = get_user_array_dim(user, "zetab_y", true, 2, tmp_dim);
    main_model_p->dim_zetab_y_1 = tmp_dim[0];
    main_model_p->dim_zetab_y_2 = tmp_dim[1];
    main_model_p->dim_zetab_y = main_model_p->dim_zetab_y_1 * main_model_p->dim_zetab_y_2;
    main_model_p->zetab_y = (double*) Calloc(main_model_p->dim_zetab_y, double);
    memcpy(main_model_p->zetab_y, tmp, main_model_p->dim_zetab_y * sizeof(double));
    Free(tmp);
  }
  Free(main_model_p->zetac_y);
  {
    int tmp_dim[2];
    double *tmp = get_user_array_dim(user, "zetac_y", true, 2, tmp_dim);
    main_model_p->dim_zetac_y_1 = tmp_dim[0];
    main_model_p->dim_zetac_y_2 = tmp_dim[1];
    main_model_p->dim_zetac_y = main_model_p->dim_zetac_y_1 * main_model_p->dim_zetac_y_2;
    main_model_p->zetac_y = (double*) Calloc(main_model_p->dim_zetac_y, double);
    memcpy(main_model_p->zetac_y, tmp, main_model_p->dim_zetac_y * sizeof(double));
    Free(tmp);
  }
  Free(main_model_p->c_comm);
  {
    double *tmp = (double*)get_user_array_dim(user, "c_comm", true, 1, &main_model_p->dim_c_comm);
    main_model_p->c_comm = (double*) Calloc(main_model_p->dim_c_comm, double);
    memcpy(main_model_p->c_comm, tmp, main_model_p->dim_c_comm * sizeof(double));
    Free(tmp);
  }
  main_model_p->offset_output_c_comm = 21;
  Free(main_model_p->c_noncomm);
  {
    double *tmp = (double*)get_user_array_dim(user, "c_noncomm", true, 1, &main_model_p->dim_c_noncomm);
    main_model_p->c_noncomm = (double*) Calloc(main_model_p->dim_c_noncomm, double);
    memcpy(main_model_p->c_noncomm, tmp, main_model_p->dim_c_noncomm * sizeof(double));
    Free(tmp);
  }
  main_model_p->offset_output_c_noncomm = 21 + main_model_p->dim_c_comm;
  Free(main_model_p->new_people_in_group);
  main_model_p->dim_new_people_in_group = main_model_p->Ncat;
  main_model_p->new_people_in_group = (double*) Calloc(main_model_p->dim_new_people_in_group, double);
  main_model_p->offset_output_new_people_in_group = main_model_p->offset_output_c_noncomm + main_model_p->dim_c_noncomm;
  Free(main_model_p->comm_partnerships_requested);
  main_model_p->dim_comm_partnerships_requested_1 = main_model_p->Ncat;
  main_model_p->dim_comm_partnerships_requested_2 = main_model_p->Ncat;
  main_model_p->dim_comm_partnerships_requested = main_model_p->dim_comm_partnerships_requested_1 * main_model_p->dim_comm_partnerships_requested_2;
  main_model_p->comm_partnerships_requested = (double*) Calloc(main_model_p->dim_comm_partnerships_requested, double);
  Free(main_model_p->noncomm_partnerships_requested);
  main_model_p->dim_noncomm_partnerships_requested_1 = main_model_p->Ncat;
  main_model_p->dim_noncomm_partnerships_requested_2 = main_model_p->Ncat;
  main_model_p->dim_noncomm_partnerships_requested = main_model_p->dim_noncomm_partnerships_requested_1 * main_model_p->dim_noncomm_partnerships_requested_2;
  main_model_p->noncomm_partnerships_requested = (double*) Calloc(main_model_p->dim_noncomm_partnerships_requested, double);
  Free(main_model_p->testing_prob);
  main_model_p->dim_testing_prob = main_model_p->Ncat;
  main_model_p->testing_prob = (double*) Calloc(main_model_p->dim_testing_prob, double);
  main_model_p->offset_output_testing_prob = main_model_p->offset_output_new_people_in_group + main_model_p->dim_new_people_in_group;
  Free(main_model_p->ART_prob);
  main_model_p->dim_ART_prob = main_model_p->Ncat;
  main_model_p->ART_prob = (double*) Calloc(main_model_p->dim_ART_prob, double);
  main_model_p->offset_output_ART_prob = main_model_p->offset_output_testing_prob + main_model_p->dim_testing_prob;
  Free(main_model_p->tau);
  main_model_p->dim_tau = main_model_p->Ncat;
  main_model_p->tau = (double*) Calloc(main_model_p->dim_tau, double);
  main_model_p->offset_output_tau = main_model_p->offset_output_ART_prob + main_model_p->dim_ART_prob;
  Free(main_model_p->rho);
  main_model_p->dim_rho = main_model_p->Ncat;
  main_model_p->rho = (double*) Calloc(main_model_p->dim_rho, double);
  main_model_p->offset_output_rho = main_model_p->offset_output_tau + main_model_p->dim_tau;
  Free(main_model_p->frac_F);
  main_model_p->dim_frac_F = main_model_p->Ncat;
  main_model_p->frac_F = (double*) Calloc(main_model_p->dim_frac_F, double);
  main_model_p->offset_output_frac_F = main_model_p->offset_output_rho + main_model_p->dim_rho;
  Free(main_model_p->frac_N_sexualpop);
  main_model_p->dim_frac_N_sexualpop = main_model_p->Ncat;
  main_model_p->frac_N_sexualpop = (double*) Calloc(main_model_p->dim_frac_N_sexualpop, double);
  main_model_p->offset_output_frac_N_sexualpop = main_model_p->offset_output_frac_F + main_model_p->dim_frac_F;
  Free(main_model_p->zetaa);
  main_model_p->dim_zetaa = main_model_p->Ncat;
  main_model_p->zetaa = (double*) Calloc(main_model_p->dim_zetaa, double);
  main_model_p->offset_output_zetaa = main_model_p->offset_output_frac_N_sexualpop + main_model_p->dim_frac_N_sexualpop;
  Free(main_model_p->zetab);
  main_model_p->dim_zetab = main_model_p->Ncat;
  main_model_p->zetab = (double*) Calloc(main_model_p->dim_zetab, double);
  main_model_p->offset_output_zetab = main_model_p->offset_output_zetaa + main_model_p->dim_zetaa;
  Free(main_model_p->zetac);
  main_model_p->dim_zetac = main_model_p->Ncat;
  main_model_p->zetac = (double*) Calloc(main_model_p->dim_zetac, double);
  main_model_p->offset_output_zetac = main_model_p->offset_output_zetab + main_model_p->dim_zetab;
  Free(main_model_p->omega);
  main_model_p->dim_omega = main_model_p->Ncat;
  main_model_p->omega = (double*) Calloc(main_model_p->dim_omega, double);
  main_model_p->offset_output_omega = main_model_p->offset_output_zetac + main_model_p->dim_zetac;
  get_user_array(user, "omega", true, main_model_p->omega, 1, main_model_p->dim_omega);
  Free(main_model_p->frac_N);
  main_model_p->dim_frac_N = main_model_p->Ncat;
  main_model_p->frac_N = (double*) Calloc(main_model_p->dim_frac_N, double);
  main_model_p->offset_output_frac_N = main_model_p->offset_output_omega + main_model_p->dim_omega;
  Free(main_model_p->mu);
  main_model_p->dim_mu = main_model_p->Ncat;
  main_model_p->mu = (double*) Calloc(main_model_p->dim_mu, double);
  main_model_p->offset_output_mu = main_model_p->offset_output_frac_N + main_model_p->dim_frac_N;
  get_user_array(user, "mu", true, main_model_p->mu, 1, main_model_p->dim_mu);
  Free(main_model_p->gamma01);
  main_model_p->dim_gamma01 = main_model_p->Ncat;
  main_model_p->gamma01 = (double*) Calloc(main_model_p->dim_gamma01, double);
  main_model_p->offset_output_gamma01 = main_model_p->offset_output_mu + main_model_p->dim_mu;
  get_user_array(user, "gamma01", true, main_model_p->gamma01, 1, main_model_p->dim_gamma01);
  Free(main_model_p->gamma02);
  main_model_p->dim_gamma02 = main_model_p->Ncat;
  main_model_p->gamma02 = (double*) Calloc(main_model_p->dim_gamma02, double);
  get_user_array(user, "gamma02", true, main_model_p->gamma02, 1, main_model_p->dim_gamma02);
  Free(main_model_p->gamma03);
  main_model_p->dim_gamma03 = main_model_p->Ncat;
  main_model_p->gamma03 = (double*) Calloc(main_model_p->dim_gamma03, double);
  get_user_array(user, "gamma03", true, main_model_p->gamma03, 1, main_model_p->dim_gamma03);
  Free(main_model_p->gamma04);
  main_model_p->dim_gamma04 = main_model_p->Ncat;
  main_model_p->gamma04 = (double*) Calloc(main_model_p->dim_gamma04, double);
  get_user_array(user, "gamma04", true, main_model_p->gamma04, 1, main_model_p->dim_gamma04);
  Free(main_model_p->gamma11);
  main_model_p->dim_gamma11 = main_model_p->Ncat;
  main_model_p->gamma11 = (double*) Calloc(main_model_p->dim_gamma11, double);
  get_user_array(user, "gamma11", true, main_model_p->gamma11, 1, main_model_p->dim_gamma11);
  Free(main_model_p->gamma22);
  main_model_p->dim_gamma22 = main_model_p->Ncat;
  main_model_p->gamma22 = (double*) Calloc(main_model_p->dim_gamma22, double);
  get_user_array(user, "gamma22", true, main_model_p->gamma22, 1, main_model_p->dim_gamma22);
  Free(main_model_p->gamma23);
  main_model_p->dim_gamma23 = main_model_p->Ncat;
  main_model_p->gamma23 = (double*) Calloc(main_model_p->dim_gamma23, double);
  get_user_array(user, "gamma23", true, main_model_p->gamma23, 1, main_model_p->dim_gamma23);
  Free(main_model_p->gamma24);
  main_model_p->dim_gamma24 = main_model_p->Ncat;
  main_model_p->gamma24 = (double*) Calloc(main_model_p->dim_gamma24, double);
  get_user_array(user, "gamma24", true, main_model_p->gamma24, 1, main_model_p->dim_gamma24);
  Free(main_model_p->gamma32);
  main_model_p->dim_gamma32 = main_model_p->Ncat;
  main_model_p->gamma32 = (double*) Calloc(main_model_p->dim_gamma32, double);
  get_user_array(user, "gamma32", true, main_model_p->gamma32, 1, main_model_p->dim_gamma32);
  Free(main_model_p->gamma33);
  main_model_p->dim_gamma33 = main_model_p->Ncat;
  main_model_p->gamma33 = (double*) Calloc(main_model_p->dim_gamma33, double);
  get_user_array(user, "gamma33", true, main_model_p->gamma33, 1, main_model_p->dim_gamma33);
  Free(main_model_p->gamma34);
  main_model_p->dim_gamma34 = main_model_p->Ncat;
  main_model_p->gamma34 = (double*) Calloc(main_model_p->dim_gamma34, double);
  get_user_array(user, "gamma34", true, main_model_p->gamma34, 1, main_model_p->dim_gamma34);
  Free(main_model_p->gamma42);
  main_model_p->dim_gamma42 = main_model_p->Ncat;
  main_model_p->gamma42 = (double*) Calloc(main_model_p->dim_gamma42, double);
  get_user_array(user, "gamma42", true, main_model_p->gamma42, 1, main_model_p->dim_gamma42);
  Free(main_model_p->gamma43);
  main_model_p->dim_gamma43 = main_model_p->Ncat;
  main_model_p->gamma43 = (double*) Calloc(main_model_p->dim_gamma43, double);
  get_user_array(user, "gamma43", true, main_model_p->gamma43, 1, main_model_p->dim_gamma43);
  Free(main_model_p->gamma44);
  main_model_p->dim_gamma44 = main_model_p->Ncat;
  main_model_p->gamma44 = (double*) Calloc(main_model_p->dim_gamma44, double);
  get_user_array(user, "gamma44", true, main_model_p->gamma44, 1, main_model_p->dim_gamma44);
  Free(main_model_p->phi2);
  main_model_p->dim_phi2 = main_model_p->Ncat;
  main_model_p->phi2 = (double*) Calloc(main_model_p->dim_phi2, double);
  get_user_array(user, "phi2", true, main_model_p->phi2, 1, main_model_p->dim_phi2);
  Free(main_model_p->phi3);
  main_model_p->dim_phi3 = main_model_p->Ncat;
  main_model_p->phi3 = (double*) Calloc(main_model_p->dim_phi3, double);
  get_user_array(user, "phi3", true, main_model_p->phi3, 1, main_model_p->dim_phi3);
  Free(main_model_p->phi4);
  main_model_p->dim_phi4 = main_model_p->Ncat;
  main_model_p->phi4 = (double*) Calloc(main_model_p->dim_phi4, double);
  get_user_array(user, "phi4", true, main_model_p->phi4, 1, main_model_p->dim_phi4);
  Free(main_model_p->phi5);
  main_model_p->dim_phi5 = main_model_p->Ncat;
  main_model_p->phi5 = (double*) Calloc(main_model_p->dim_phi5, double);
  get_user_array(user, "phi5", true, main_model_p->phi5, 1, main_model_p->dim_phi5);
  Free(main_model_p->psia);
  main_model_p->dim_psia = main_model_p->Ncat;
  main_model_p->psia = (double*) Calloc(main_model_p->dim_psia, double);
  get_user_array(user, "psia", true, main_model_p->psia, 1, main_model_p->dim_psia);
  Free(main_model_p->psib);
  main_model_p->dim_psib = main_model_p->Ncat;
  main_model_p->psib = (double*) Calloc(main_model_p->dim_psib, double);
  get_user_array(user, "psib", true, main_model_p->psib, 1, main_model_p->dim_psib);
  Free(main_model_p->kappaa);
  main_model_p->dim_kappaa = main_model_p->Ncat;
  main_model_p->kappaa = (double*) Calloc(main_model_p->dim_kappaa, double);
  main_model_p->offset_output_kappaa = main_model_p->offset_output_gamma01 + main_model_p->dim_gamma01;
  get_user_array(user, "kappaa", true, main_model_p->kappaa, 1, main_model_p->dim_kappaa);
  Free(main_model_p->kappab);
  main_model_p->dim_kappab = main_model_p->Ncat;
  main_model_p->kappab = (double*) Calloc(main_model_p->dim_kappab, double);
  main_model_p->offset_output_kappab = main_model_p->offset_output_kappaa + main_model_p->dim_kappaa;
  get_user_array(user, "kappab", true, main_model_p->kappab, 1, main_model_p->dim_kappab);
  Free(main_model_p->kappac);
  main_model_p->dim_kappac = main_model_p->Ncat;
  main_model_p->kappac = (double*) Calloc(main_model_p->dim_kappac, double);
  main_model_p->offset_output_kappac = main_model_p->offset_output_kappab + main_model_p->dim_kappab;
  get_user_array(user, "kappac", true, main_model_p->kappac, 1, main_model_p->dim_kappac);
  Free(main_model_p->alpha01);
  main_model_p->dim_alpha01 = main_model_p->Ncat;
  main_model_p->alpha01 = (double*) Calloc(main_model_p->dim_alpha01, double);
  get_user_array(user, "alpha01", true, main_model_p->alpha01, 1, main_model_p->dim_alpha01);
  Free(main_model_p->alpha02);
  main_model_p->dim_alpha02 = main_model_p->Ncat;
  main_model_p->alpha02 = (double*) Calloc(main_model_p->dim_alpha02, double);
  get_user_array(user, "alpha02", true, main_model_p->alpha02, 1, main_model_p->dim_alpha02);
  Free(main_model_p->alpha03);
  main_model_p->dim_alpha03 = main_model_p->Ncat;
  main_model_p->alpha03 = (double*) Calloc(main_model_p->dim_alpha03, double);
  get_user_array(user, "alpha03", true, main_model_p->alpha03, 1, main_model_p->dim_alpha03);
  Free(main_model_p->alpha04);
  main_model_p->dim_alpha04 = main_model_p->Ncat;
  main_model_p->alpha04 = (double*) Calloc(main_model_p->dim_alpha04, double);
  get_user_array(user, "alpha04", true, main_model_p->alpha04, 1, main_model_p->dim_alpha04);
  Free(main_model_p->alpha05);
  main_model_p->dim_alpha05 = main_model_p->Ncat;
  main_model_p->alpha05 = (double*) Calloc(main_model_p->dim_alpha05, double);
  main_model_p->offset_output_alpha05 = main_model_p->offset_output_kappac + main_model_p->dim_kappac;
  get_user_array(user, "alpha05", true, main_model_p->alpha05, 1, main_model_p->dim_alpha05);
  Free(main_model_p->alpha11);
  main_model_p->dim_alpha11 = main_model_p->Ncat;
  main_model_p->alpha11 = (double*) Calloc(main_model_p->dim_alpha11, double);
  get_user_array(user, "alpha11", true, main_model_p->alpha11, 1, main_model_p->dim_alpha11);
  Free(main_model_p->alpha22);
  main_model_p->dim_alpha22 = main_model_p->Ncat;
  main_model_p->alpha22 = (double*) Calloc(main_model_p->dim_alpha22, double);
  get_user_array(user, "alpha22", true, main_model_p->alpha22, 1, main_model_p->dim_alpha22);
  Free(main_model_p->alpha23);
  main_model_p->dim_alpha23 = main_model_p->Ncat;
  main_model_p->alpha23 = (double*) Calloc(main_model_p->dim_alpha23, double);
  get_user_array(user, "alpha23", true, main_model_p->alpha23, 1, main_model_p->dim_alpha23);
  Free(main_model_p->alpha24);
  main_model_p->dim_alpha24 = main_model_p->Ncat;
  main_model_p->alpha24 = (double*) Calloc(main_model_p->dim_alpha24, double);
  get_user_array(user, "alpha24", true, main_model_p->alpha24, 1, main_model_p->dim_alpha24);
  Free(main_model_p->alpha25);
  main_model_p->dim_alpha25 = main_model_p->Ncat;
  main_model_p->alpha25 = (double*) Calloc(main_model_p->dim_alpha25, double);
  get_user_array(user, "alpha25", true, main_model_p->alpha25, 1, main_model_p->dim_alpha25);
  Free(main_model_p->alpha32);
  main_model_p->dim_alpha32 = main_model_p->Ncat;
  main_model_p->alpha32 = (double*) Calloc(main_model_p->dim_alpha32, double);
  get_user_array(user, "alpha32", true, main_model_p->alpha32, 1, main_model_p->dim_alpha32);
  Free(main_model_p->alpha33);
  main_model_p->dim_alpha33 = main_model_p->Ncat;
  main_model_p->alpha33 = (double*) Calloc(main_model_p->dim_alpha33, double);
  get_user_array(user, "alpha33", true, main_model_p->alpha33, 1, main_model_p->dim_alpha33);
  Free(main_model_p->alpha34);
  main_model_p->dim_alpha34 = main_model_p->Ncat;
  main_model_p->alpha34 = (double*) Calloc(main_model_p->dim_alpha34, double);
  get_user_array(user, "alpha34", true, main_model_p->alpha34, 1, main_model_p->dim_alpha34);
  Free(main_model_p->alpha35);
  main_model_p->dim_alpha35 = main_model_p->Ncat;
  main_model_p->alpha35 = (double*) Calloc(main_model_p->dim_alpha35, double);
  main_model_p->offset_output_alpha35 = main_model_p->offset_output_alpha05 + main_model_p->dim_alpha05;
  get_user_array(user, "alpha35", true, main_model_p->alpha35, 1, main_model_p->dim_alpha35);
  Free(main_model_p->alpha42);
  main_model_p->dim_alpha42 = main_model_p->Ncat;
  main_model_p->alpha42 = (double*) Calloc(main_model_p->dim_alpha42, double);
  get_user_array(user, "alpha42", true, main_model_p->alpha42, 1, main_model_p->dim_alpha42);
  Free(main_model_p->alpha43);
  main_model_p->dim_alpha43 = main_model_p->Ncat;
  main_model_p->alpha43 = (double*) Calloc(main_model_p->dim_alpha43, double);
  get_user_array(user, "alpha43", true, main_model_p->alpha43, 1, main_model_p->dim_alpha43);
  Free(main_model_p->alpha44);
  main_model_p->dim_alpha44 = main_model_p->Ncat;
  main_model_p->alpha44 = (double*) Calloc(main_model_p->dim_alpha44, double);
  get_user_array(user, "alpha44", true, main_model_p->alpha44, 1, main_model_p->dim_alpha44);
  Free(main_model_p->alpha45);
  main_model_p->dim_alpha45 = main_model_p->Ncat;
  main_model_p->alpha45 = (double*) Calloc(main_model_p->dim_alpha45, double);
  get_user_array(user, "alpha45", true, main_model_p->alpha45, 1, main_model_p->dim_alpha45);
  Free(main_model_p->beta_comm);
  main_model_p->dim_beta_comm = main_model_p->Ncat;
  main_model_p->beta_comm = (double*) Calloc(main_model_p->dim_beta_comm, double);
  main_model_p->offset_output_beta_comm = main_model_p->offset_output_alpha35 + main_model_p->dim_alpha35;
  get_user_array(user, "beta_comm", true, main_model_p->beta_comm, 1, main_model_p->dim_beta_comm);
  Free(main_model_p->beta_noncomm);
  main_model_p->dim_beta_noncomm = main_model_p->Ncat;
  main_model_p->beta_noncomm = (double*) Calloc(main_model_p->dim_beta_noncomm, double);
  main_model_p->offset_output_beta_noncomm = main_model_p->offset_output_beta_comm + main_model_p->dim_beta_comm;
  get_user_array(user, "beta_noncomm", true, main_model_p->beta_noncomm, 1, main_model_p->dim_beta_noncomm);
  Free(main_model_p->p_comm);
  main_model_p->dim_p_comm_1 = main_model_p->Ncat;
  main_model_p->dim_p_comm_2 = main_model_p->Ncat;
  main_model_p->dim_p_comm = main_model_p->dim_p_comm_1 * main_model_p->dim_p_comm_2;
  main_model_p->p_comm = (double*) Calloc(main_model_p->dim_p_comm, double);
  main_model_p->offset_output_p_comm = main_model_p->offset_output_beta_noncomm + main_model_p->dim_beta_noncomm;
  Free(main_model_p->p_noncomm);
  main_model_p->dim_p_noncomm_1 = main_model_p->Ncat;
  main_model_p->dim_p_noncomm_2 = main_model_p->Ncat;
  main_model_p->dim_p_noncomm = main_model_p->dim_p_noncomm_1 * main_model_p->dim_p_noncomm_2;
  main_model_p->p_noncomm = (double*) Calloc(main_model_p->dim_p_noncomm, double);
  main_model_p->offset_output_p_noncomm = main_model_p->offset_output_p_comm + main_model_p->dim_p_comm;
  Free(main_model_p->ec);
  main_model_p->dim_ec = main_model_p->Ncat;
  main_model_p->ec = (double*) Calloc(main_model_p->dim_ec, double);
  get_user_array(user, "ec", true, main_model_p->ec, 1, main_model_p->dim_ec);
  Free(main_model_p->eP);
  main_model_p->dim_eP = main_model_p->Ncat;
  main_model_p->eP = (double*) Calloc(main_model_p->dim_eP, double);
  get_user_array(user, "eP", true, main_model_p->eP, 1, main_model_p->dim_eP);
  Free(main_model_p->eP0);
  main_model_p->dim_eP0 = main_model_p->Ncat;
  main_model_p->eP0 = (double*) Calloc(main_model_p->dim_eP0, double);
  get_user_array(user, "eP0", true, main_model_p->eP0, 1, main_model_p->dim_eP0);
  Free(main_model_p->eP1a);
  main_model_p->dim_eP1a = main_model_p->Ncat;
  main_model_p->eP1a = (double*) Calloc(main_model_p->dim_eP1a, double);
  get_user_array(user, "eP1a", true, main_model_p->eP1a, 1, main_model_p->dim_eP1a);
  Free(main_model_p->eP1b);
  main_model_p->dim_eP1b = main_model_p->Ncat;
  main_model_p->eP1b = (double*) Calloc(main_model_p->dim_eP1b, double);
  get_user_array(user, "eP1b", true, main_model_p->eP1b, 1, main_model_p->dim_eP1b);
  Free(main_model_p->eP1c);
  main_model_p->dim_eP1c = main_model_p->Ncat;
  main_model_p->eP1c = (double*) Calloc(main_model_p->dim_eP1c, double);
  get_user_array(user, "eP1c", true, main_model_p->eP1c, 1, main_model_p->dim_eP1c);
  Free(main_model_p->eP1d);
  main_model_p->dim_eP1d = main_model_p->Ncat;
  main_model_p->eP1d = (double*) Calloc(main_model_p->dim_eP1d, double);
  get_user_array(user, "eP1d", true, main_model_p->eP1d, 1, main_model_p->dim_eP1d);
  Free(main_model_p->fc_comm);
  main_model_p->dim_fc_comm_1 = main_model_p->Ncat;
  main_model_p->dim_fc_comm_2 = main_model_p->Ncat;
  main_model_p->dim_fc_comm = main_model_p->dim_fc_comm_1 * main_model_p->dim_fc_comm_2;
  main_model_p->fc_comm = (double*) Calloc(main_model_p->dim_fc_comm, double);
  main_model_p->offset_output_fc_comm = main_model_p->offset_output_p_noncomm + main_model_p->dim_p_noncomm;
  Free(main_model_p->fP_comm);
  main_model_p->dim_fP_comm = main_model_p->Ncat;
  main_model_p->fP_comm = (double*) Calloc(main_model_p->dim_fP_comm, double);
  main_model_p->offset_output_fP_comm = main_model_p->offset_output_fc_comm + main_model_p->dim_fc_comm;
  Free(main_model_p->fc_noncomm);
  main_model_p->dim_fc_noncomm_1 = main_model_p->Ncat;
  main_model_p->dim_fc_noncomm_2 = main_model_p->Ncat;
  main_model_p->dim_fc_noncomm = main_model_p->dim_fc_noncomm_1 * main_model_p->dim_fc_noncomm_2;
  main_model_p->fc_noncomm = (double*) Calloc(main_model_p->dim_fc_noncomm, double);
  main_model_p->offset_output_fc_noncomm = main_model_p->offset_output_fP_comm + main_model_p->dim_fP_comm;
  Free(main_model_p->fP_noncomm);
  main_model_p->dim_fP_noncomm = main_model_p->Ncat;
  main_model_p->fP_noncomm = (double*) Calloc(main_model_p->dim_fP_noncomm, double);
  main_model_p->offset_output_fP_noncomm = main_model_p->offset_output_fc_noncomm + main_model_p->dim_fc_noncomm;
  Free(main_model_p->n_comm);
  main_model_p->dim_n_comm_1 = main_model_p->Ncat;
  main_model_p->dim_n_comm_2 = main_model_p->Ncat;
  main_model_p->dim_n_comm = main_model_p->dim_n_comm_1 * main_model_p->dim_n_comm_2;
  main_model_p->n_comm = (double*) Calloc(main_model_p->dim_n_comm, double);
  main_model_p->offset_output_n_comm = main_model_p->offset_output_fP_noncomm + main_model_p->dim_fP_noncomm;
  get_user_array(user, "n_comm", true, main_model_p->n_comm, 2, main_model_p->dim_n_comm_1, main_model_p->dim_n_comm_2);
  Free(main_model_p->n_noncomm);
  main_model_p->dim_n_noncomm_1 = main_model_p->Ncat;
  main_model_p->dim_n_noncomm_2 = main_model_p->Ncat;
  main_model_p->dim_n_noncomm = main_model_p->dim_n_noncomm_1 * main_model_p->dim_n_noncomm_2;
  main_model_p->n_noncomm = (double*) Calloc(main_model_p->dim_n_noncomm, double);
  main_model_p->offset_output_n_noncomm = main_model_p->offset_output_n_comm + main_model_p->dim_n_comm;
  get_user_array(user, "n_noncomm", true, main_model_p->n_noncomm, 2, main_model_p->dim_n_noncomm_1, main_model_p->dim_n_noncomm_2);
  Free(main_model_p->initial_cumuInf);
  main_model_p->dim_cumuInf = main_model_p->Ncat;
  main_model_p->initial_cumuInf = (double*) Calloc(main_model_p->dim_cumuInf, double);
  main_model_p->offset_cumuInf = 0;
  Free(main_model_p->initial_OnPrEP);
  main_model_p->dim_OnPrEP = main_model_p->Ncat;
  main_model_p->initial_OnPrEP = (double*) Calloc(main_model_p->dim_OnPrEP, double);
  main_model_p->offset_OnPrEP = main_model_p->dim_cumuInf;
  Free(main_model_p->initial_S0);
  main_model_p->dim_S0 = main_model_p->Ncat;
  main_model_p->initial_S0 = (double*) Calloc(main_model_p->dim_S0, double);
  main_model_p->offset_S0 = main_model_p->offset_OnPrEP + main_model_p->dim_OnPrEP;
  Free(main_model_p->initial_S1a);
  main_model_p->dim_S1a = main_model_p->Ncat;
  main_model_p->initial_S1a = (double*) Calloc(main_model_p->dim_S1a, double);
  main_model_p->offset_S1a = main_model_p->offset_S0 + main_model_p->dim_S0;
  Free(main_model_p->initial_S1b);
  main_model_p->dim_S1b = main_model_p->Ncat;
  main_model_p->initial_S1b = (double*) Calloc(main_model_p->dim_S1b, double);
  main_model_p->offset_S1b = main_model_p->offset_S1a + main_model_p->dim_S1a;
  Free(main_model_p->initial_S1c);
  main_model_p->dim_S1c = main_model_p->Ncat;
  main_model_p->initial_S1c = (double*) Calloc(main_model_p->dim_S1c, double);
  main_model_p->offset_S1c = main_model_p->offset_S1b + main_model_p->dim_S1b;
  Free(main_model_p->initial_S1d);
  main_model_p->dim_S1d = main_model_p->Ncat;
  main_model_p->initial_S1d = (double*) Calloc(main_model_p->dim_S1d, double);
  main_model_p->offset_S1d = main_model_p->offset_S1c + main_model_p->dim_S1c;
  Free(main_model_p->initial_I01);
  main_model_p->dim_I01 = main_model_p->Ncat;
  main_model_p->initial_I01 = (double*) Calloc(main_model_p->dim_I01, double);
  main_model_p->offset_I01 = main_model_p->offset_S1d + main_model_p->dim_S1d;
  Free(main_model_p->initial_I11);
  main_model_p->dim_I11 = main_model_p->Ncat;
  main_model_p->initial_I11 = (double*) Calloc(main_model_p->dim_I11, double);
  main_model_p->offset_I11 = main_model_p->offset_I01 + main_model_p->dim_I01;
  Free(main_model_p->initial_I02);
  main_model_p->dim_I02 = main_model_p->Ncat;
  main_model_p->initial_I02 = (double*) Calloc(main_model_p->dim_I02, double);
  main_model_p->offset_I02 = main_model_p->offset_I11 + main_model_p->dim_I11;
  Free(main_model_p->initial_I03);
  main_model_p->dim_I03 = main_model_p->Ncat;
  main_model_p->initial_I03 = (double*) Calloc(main_model_p->dim_I03, double);
  main_model_p->offset_I03 = main_model_p->offset_I02 + main_model_p->dim_I02;
  Free(main_model_p->initial_I04);
  main_model_p->dim_I04 = main_model_p->Ncat;
  main_model_p->initial_I04 = (double*) Calloc(main_model_p->dim_I04, double);
  main_model_p->offset_I04 = main_model_p->offset_I03 + main_model_p->dim_I03;
  Free(main_model_p->initial_I05);
  main_model_p->dim_I05 = main_model_p->Ncat;
  main_model_p->initial_I05 = (double*) Calloc(main_model_p->dim_I05, double);
  main_model_p->offset_I05 = main_model_p->offset_I04 + main_model_p->dim_I04;
  Free(main_model_p->initial_I22);
  main_model_p->dim_I22 = main_model_p->Ncat;
  main_model_p->initial_I22 = (double*) Calloc(main_model_p->dim_I22, double);
  main_model_p->offset_I22 = main_model_p->offset_I05 + main_model_p->dim_I05;
  Free(main_model_p->initial_I23);
  main_model_p->dim_I23 = main_model_p->Ncat;
  main_model_p->initial_I23 = (double*) Calloc(main_model_p->dim_I23, double);
  main_model_p->offset_I23 = main_model_p->offset_I22 + main_model_p->dim_I22;
  Free(main_model_p->initial_I24);
  main_model_p->dim_I24 = main_model_p->Ncat;
  main_model_p->initial_I24 = (double*) Calloc(main_model_p->dim_I24, double);
  main_model_p->offset_I24 = main_model_p->offset_I23 + main_model_p->dim_I23;
  Free(main_model_p->initial_I25);
  main_model_p->dim_I25 = main_model_p->Ncat;
  main_model_p->initial_I25 = (double*) Calloc(main_model_p->dim_I25, double);
  main_model_p->offset_I25 = main_model_p->offset_I24 + main_model_p->dim_I24;
  Free(main_model_p->initial_I32);
  main_model_p->dim_I32 = main_model_p->Ncat;
  main_model_p->initial_I32 = (double*) Calloc(main_model_p->dim_I32, double);
  main_model_p->offset_I32 = main_model_p->offset_I25 + main_model_p->dim_I25;
  Free(main_model_p->initial_I33);
  main_model_p->dim_I33 = main_model_p->Ncat;
  main_model_p->initial_I33 = (double*) Calloc(main_model_p->dim_I33, double);
  main_model_p->offset_I33 = main_model_p->offset_I32 + main_model_p->dim_I32;
  Free(main_model_p->initial_I34);
  main_model_p->dim_I34 = main_model_p->Ncat;
  main_model_p->initial_I34 = (double*) Calloc(main_model_p->dim_I34, double);
  main_model_p->offset_I34 = main_model_p->offset_I33 + main_model_p->dim_I33;
  Free(main_model_p->initial_I35);
  main_model_p->dim_I35 = main_model_p->Ncat;
  main_model_p->initial_I35 = (double*) Calloc(main_model_p->dim_I35, double);
  main_model_p->offset_I35 = main_model_p->offset_I34 + main_model_p->dim_I34;
  Free(main_model_p->initial_I42);
  main_model_p->dim_I42 = main_model_p->Ncat;
  main_model_p->initial_I42 = (double*) Calloc(main_model_p->dim_I42, double);
  main_model_p->offset_I42 = main_model_p->offset_I35 + main_model_p->dim_I35;
  Free(main_model_p->initial_I43);
  main_model_p->dim_I43 = main_model_p->Ncat;
  main_model_p->initial_I43 = (double*) Calloc(main_model_p->dim_I43, double);
  main_model_p->offset_I43 = main_model_p->offset_I42 + main_model_p->dim_I42;
  Free(main_model_p->initial_I44);
  main_model_p->dim_I44 = main_model_p->Ncat;
  main_model_p->initial_I44 = (double*) Calloc(main_model_p->dim_I44, double);
  main_model_p->offset_I44 = main_model_p->offset_I43 + main_model_p->dim_I43;
  Free(main_model_p->initial_I45);
  main_model_p->dim_I45 = main_model_p->Ncat;
  main_model_p->initial_I45 = (double*) Calloc(main_model_p->dim_I45, double);
  main_model_p->offset_I45 = main_model_p->offset_I44 + main_model_p->dim_I44;
  Free(main_model_p->S0_init);
  main_model_p->dim_S0_init = main_model_p->Ncat;
  main_model_p->S0_init = (double*) Calloc(main_model_p->dim_S0_init, double);
  get_user_array(user, "S0_init", true, main_model_p->S0_init, 1, main_model_p->dim_S0_init);
  for (int i = 0; i < main_model_p->dim_S0; ++i) {
    main_model_p->initial_S0[i] = main_model_p->S0_init[i];
  }
  Free(main_model_p->S1a_init);
  main_model_p->dim_S1a_init = main_model_p->Ncat;
  main_model_p->S1a_init = (double*) Calloc(main_model_p->dim_S1a_init, double);
  get_user_array(user, "S1a_init", true, main_model_p->S1a_init, 1, main_model_p->dim_S1a_init);
  for (int i = 0; i < main_model_p->dim_S1a; ++i) {
    main_model_p->initial_S1a[i] = main_model_p->S1a_init[i];
  }
  Free(main_model_p->S1b_init);
  main_model_p->dim_S1b_init = main_model_p->Ncat;
  main_model_p->S1b_init = (double*) Calloc(main_model_p->dim_S1b_init, double);
  get_user_array(user, "S1b_init", true, main_model_p->S1b_init, 1, main_model_p->dim_S1b_init);
  for (int i = 0; i < main_model_p->dim_S1b; ++i) {
    main_model_p->initial_S1b[i] = main_model_p->S1b_init[i];
  }
  Free(main_model_p->S1c_init);
  main_model_p->dim_S1c_init = main_model_p->Ncat;
  main_model_p->S1c_init = (double*) Calloc(main_model_p->dim_S1c_init, double);
  get_user_array(user, "S1c_init", true, main_model_p->S1c_init, 1, main_model_p->dim_S1c_init);
  for (int i = 0; i < main_model_p->dim_S1c; ++i) {
    main_model_p->initial_S1c[i] = main_model_p->S1c_init[i];
  }
  Free(main_model_p->S1d_init);
  main_model_p->dim_S1d_init = main_model_p->Ncat;
  main_model_p->S1d_init = (double*) Calloc(main_model_p->dim_S1d_init, double);
  get_user_array(user, "S1d_init", true, main_model_p->S1d_init, 1, main_model_p->dim_S1d_init);
  for (int i = 0; i < main_model_p->dim_S1d; ++i) {
    main_model_p->initial_S1d[i] = main_model_p->S1d_init[i];
  }
  Free(main_model_p->I01_init);
  main_model_p->dim_I01_init = main_model_p->Ncat;
  main_model_p->I01_init = (double*) Calloc(main_model_p->dim_I01_init, double);
  get_user_array(user, "I01_init", true, main_model_p->I01_init, 1, main_model_p->dim_I01_init);
  for (int i = 0; i < main_model_p->dim_I01; ++i) {
    main_model_p->initial_I01[i] = main_model_p->I01_init[i];
  }
  Free(main_model_p->I11_init);
  main_model_p->dim_I11_init = main_model_p->Ncat;
  main_model_p->I11_init = (double*) Calloc(main_model_p->dim_I11_init, double);
  get_user_array(user, "I11_init", true, main_model_p->I11_init, 1, main_model_p->dim_I11_init);
  for (int i = 0; i < main_model_p->dim_I11; ++i) {
    main_model_p->initial_I11[i] = main_model_p->I11_init[i];
  }
  Free(main_model_p->I02_init);
  main_model_p->dim_I02_init = main_model_p->Ncat;
  main_model_p->I02_init = (double*) Calloc(main_model_p->dim_I02_init, double);
  get_user_array(user, "I02_init", true, main_model_p->I02_init, 1, main_model_p->dim_I02_init);
  for (int i = 0; i < main_model_p->dim_I02; ++i) {
    main_model_p->initial_I02[i] = main_model_p->I02_init[i];
  }
  Free(main_model_p->I03_init);
  main_model_p->dim_I03_init = main_model_p->Ncat;
  main_model_p->I03_init = (double*) Calloc(main_model_p->dim_I03_init, double);
  get_user_array(user, "I03_init", true, main_model_p->I03_init, 1, main_model_p->dim_I03_init);
  for (int i = 0; i < main_model_p->dim_I03; ++i) {
    main_model_p->initial_I03[i] = main_model_p->I03_init[i];
  }
  Free(main_model_p->I04_init);
  main_model_p->dim_I04_init = main_model_p->Ncat;
  main_model_p->I04_init = (double*) Calloc(main_model_p->dim_I04_init, double);
  get_user_array(user, "I04_init", true, main_model_p->I04_init, 1, main_model_p->dim_I04_init);
  for (int i = 0; i < main_model_p->dim_I04; ++i) {
    main_model_p->initial_I04[i] = main_model_p->I04_init[i];
  }
  Free(main_model_p->I05_init);
  main_model_p->dim_I05_init = main_model_p->Ncat;
  main_model_p->I05_init = (double*) Calloc(main_model_p->dim_I05_init, double);
  get_user_array(user, "I05_init", true, main_model_p->I05_init, 1, main_model_p->dim_I05_init);
  for (int i = 0; i < main_model_p->dim_I05; ++i) {
    main_model_p->initial_I05[i] = main_model_p->I05_init[i];
  }
  Free(main_model_p->I22_init);
  main_model_p->dim_I22_init = main_model_p->Ncat;
  main_model_p->I22_init = (double*) Calloc(main_model_p->dim_I22_init, double);
  get_user_array(user, "I22_init", true, main_model_p->I22_init, 1, main_model_p->dim_I22_init);
  for (int i = 0; i < main_model_p->dim_I22; ++i) {
    main_model_p->initial_I22[i] = main_model_p->I22_init[i];
  }
  Free(main_model_p->I23_init);
  main_model_p->dim_I23_init = main_model_p->Ncat;
  main_model_p->I23_init = (double*) Calloc(main_model_p->dim_I23_init, double);
  get_user_array(user, "I23_init", true, main_model_p->I23_init, 1, main_model_p->dim_I23_init);
  for (int i = 0; i < main_model_p->dim_I23; ++i) {
    main_model_p->initial_I23[i] = main_model_p->I23_init[i];
  }
  Free(main_model_p->I24_init);
  main_model_p->dim_I24_init = main_model_p->Ncat;
  main_model_p->I24_init = (double*) Calloc(main_model_p->dim_I24_init, double);
  get_user_array(user, "I24_init", true, main_model_p->I24_init, 1, main_model_p->dim_I24_init);
  for (int i = 0; i < main_model_p->dim_I24; ++i) {
    main_model_p->initial_I24[i] = main_model_p->I24_init[i];
  }
  Free(main_model_p->I25_init);
  main_model_p->dim_I25_init = main_model_p->Ncat;
  main_model_p->I25_init = (double*) Calloc(main_model_p->dim_I25_init, double);
  get_user_array(user, "I25_init", true, main_model_p->I25_init, 1, main_model_p->dim_I25_init);
  for (int i = 0; i < main_model_p->dim_I25; ++i) {
    main_model_p->initial_I25[i] = main_model_p->I25_init[i];
  }
  Free(main_model_p->I32_init);
  main_model_p->dim_I32_init = main_model_p->Ncat;
  main_model_p->I32_init = (double*) Calloc(main_model_p->dim_I32_init, double);
  get_user_array(user, "I32_init", true, main_model_p->I32_init, 1, main_model_p->dim_I32_init);
  for (int i = 0; i < main_model_p->dim_I32; ++i) {
    main_model_p->initial_I32[i] = main_model_p->I32_init[i];
  }
  Free(main_model_p->I33_init);
  main_model_p->dim_I33_init = main_model_p->Ncat;
  main_model_p->I33_init = (double*) Calloc(main_model_p->dim_I33_init, double);
  get_user_array(user, "I33_init", true, main_model_p->I33_init, 1, main_model_p->dim_I33_init);
  for (int i = 0; i < main_model_p->dim_I33; ++i) {
    main_model_p->initial_I33[i] = main_model_p->I33_init[i];
  }
  Free(main_model_p->I34_init);
  main_model_p->dim_I34_init = main_model_p->Ncat;
  main_model_p->I34_init = (double*) Calloc(main_model_p->dim_I34_init, double);
  get_user_array(user, "I34_init", true, main_model_p->I34_init, 1, main_model_p->dim_I34_init);
  for (int i = 0; i < main_model_p->dim_I34; ++i) {
    main_model_p->initial_I34[i] = main_model_p->I34_init[i];
  }
  Free(main_model_p->I35_init);
  main_model_p->dim_I35_init = main_model_p->Ncat;
  main_model_p->I35_init = (double*) Calloc(main_model_p->dim_I35_init, double);
  get_user_array(user, "I35_init", true, main_model_p->I35_init, 1, main_model_p->dim_I35_init);
  for (int i = 0; i < main_model_p->dim_I35; ++i) {
    main_model_p->initial_I35[i] = main_model_p->I35_init[i];
  }
  Free(main_model_p->I42_init);
  main_model_p->dim_I42_init = main_model_p->Ncat;
  main_model_p->I42_init = (double*) Calloc(main_model_p->dim_I42_init, double);
  get_user_array(user, "I42_init", true, main_model_p->I42_init, 1, main_model_p->dim_I42_init);
  for (int i = 0; i < main_model_p->dim_I42; ++i) {
    main_model_p->initial_I42[i] = main_model_p->I42_init[i];
  }
  Free(main_model_p->I43_init);
  main_model_p->dim_I43_init = main_model_p->Ncat;
  main_model_p->I43_init = (double*) Calloc(main_model_p->dim_I43_init, double);
  get_user_array(user, "I43_init", true, main_model_p->I43_init, 1, main_model_p->dim_I43_init);
  for (int i = 0; i < main_model_p->dim_I43; ++i) {
    main_model_p->initial_I43[i] = main_model_p->I43_init[i];
  }
  Free(main_model_p->I44_init);
  main_model_p->dim_I44_init = main_model_p->Ncat;
  main_model_p->I44_init = (double*) Calloc(main_model_p->dim_I44_init, double);
  get_user_array(user, "I44_init", true, main_model_p->I44_init, 1, main_model_p->dim_I44_init);
  for (int i = 0; i < main_model_p->dim_I44; ++i) {
    main_model_p->initial_I44[i] = main_model_p->I44_init[i];
  }
  Free(main_model_p->I45_init);
  main_model_p->dim_I45_init = main_model_p->Ncat;
  main_model_p->I45_init = (double*) Calloc(main_model_p->dim_I45_init, double);
  get_user_array(user, "I45_init", true, main_model_p->I45_init, 1, main_model_p->dim_I45_init);
  for (int i = 0; i < main_model_p->dim_I45; ++i) {
    main_model_p->initial_I45[i] = main_model_p->I45_init[i];
  }
  Free(main_model_p->N);
  main_model_p->dim_N = main_model_p->Ncat;
  main_model_p->N = (double*) Calloc(main_model_p->dim_N, double);
  main_model_p->offset_output_N = main_model_p->offset_output_n_noncomm + main_model_p->dim_n_noncomm;
  Free(main_model_p->E0);
  main_model_p->dim_E0 = main_model_p->Ncat;
  main_model_p->E0 = (double*) Calloc(main_model_p->dim_E0, double);
  main_model_p->offset_output_E0 = main_model_p->offset_output_N + main_model_p->dim_N;
  Free(main_model_p->E1a);
  main_model_p->dim_E1a = main_model_p->Ncat;
  main_model_p->E1a = (double*) Calloc(main_model_p->dim_E1a, double);
  main_model_p->offset_output_E1a = main_model_p->offset_output_E0 + main_model_p->dim_E0;
  Free(main_model_p->E1b);
  main_model_p->dim_E1b = main_model_p->Ncat;
  main_model_p->E1b = (double*) Calloc(main_model_p->dim_E1b, double);
  main_model_p->offset_output_E1b = main_model_p->offset_output_E1a + main_model_p->dim_E1a;
  Free(main_model_p->E1c);
  main_model_p->dim_E1c = main_model_p->Ncat;
  main_model_p->E1c = (double*) Calloc(main_model_p->dim_E1c, double);
  main_model_p->offset_output_E1c = main_model_p->offset_output_E1b + main_model_p->dim_E1b;
  Free(main_model_p->E1d);
  main_model_p->dim_E1d = main_model_p->Ncat;
  main_model_p->E1d = (double*) Calloc(main_model_p->dim_E1d, double);
  main_model_p->offset_output_E1d = main_model_p->offset_output_E1c + main_model_p->dim_E1c;
  Free(main_model_p->cumuInf_init);
  main_model_p->dim_cumuInf_init = main_model_p->Ncat;
  main_model_p->cumuInf_init = (double*) Calloc(main_model_p->dim_cumuInf_init, double);
  get_user_array(user, "cumuInf_init", true, main_model_p->cumuInf_init, 1, main_model_p->dim_cumuInf_init);
  for (int i = 0; i < main_model_p->dim_cumuInf; ++i) {
    main_model_p->initial_cumuInf[i] = main_model_p->cumuInf_init[i];
  }
  Free(main_model_p->alphaItot);
  main_model_p->dim_alphaItot = main_model_p->Ncat;
  main_model_p->alphaItot = (double*) Calloc(main_model_p->dim_alphaItot, double);
  main_model_p->offset_output_alphaItot = main_model_p->offset_output_E1d + main_model_p->dim_E1d;
  Free(main_model_p->prev);
  main_model_p->dim_prev = main_model_p->Ncat;
  main_model_p->prev = (double*) Calloc(main_model_p->dim_prev, double);
  main_model_p->offset_output_prev = main_model_p->offset_output_alphaItot + main_model_p->dim_alphaItot;
  Free(main_model_p->lambda);
  main_model_p->dim_lambda_1 = main_model_p->Ncat;
  main_model_p->dim_lambda_2 = main_model_p->Ncat;
  main_model_p->dim_lambda = main_model_p->dim_lambda_1 * main_model_p->dim_lambda_2;
  main_model_p->lambda = (double*) Calloc(main_model_p->dim_lambda, double);
  main_model_p->offset_output_lambda = main_model_p->offset_output_prev + main_model_p->dim_prev;
  Free(main_model_p->lambda_0);
  main_model_p->dim_lambda_0_1 = main_model_p->Ncat;
  main_model_p->dim_lambda_0_2 = main_model_p->Ncat;
  main_model_p->dim_lambda_0 = main_model_p->dim_lambda_0_1 * main_model_p->dim_lambda_0_2;
  main_model_p->lambda_0 = (double*) Calloc(main_model_p->dim_lambda_0, double);
  main_model_p->offset_output_lambda_0 = main_model_p->offset_output_lambda + main_model_p->dim_lambda;
  Free(main_model_p->lambda_1a);
  main_model_p->dim_lambda_1a_1 = main_model_p->Ncat;
  main_model_p->dim_lambda_1a_2 = main_model_p->Ncat;
  main_model_p->dim_lambda_1a = main_model_p->dim_lambda_1a_1 * main_model_p->dim_lambda_1a_2;
  main_model_p->lambda_1a = (double*) Calloc(main_model_p->dim_lambda_1a, double);
  main_model_p->offset_output_lambda_1a = main_model_p->offset_output_lambda_0 + main_model_p->dim_lambda_0;
  Free(main_model_p->lambda_1b);
  main_model_p->dim_lambda_1b_1 = main_model_p->Ncat;
  main_model_p->dim_lambda_1b_2 = main_model_p->Ncat;
  main_model_p->dim_lambda_1b = main_model_p->dim_lambda_1b_1 * main_model_p->dim_lambda_1b_2;
  main_model_p->lambda_1b = (double*) Calloc(main_model_p->dim_lambda_1b, double);
  main_model_p->offset_output_lambda_1b = main_model_p->offset_output_lambda_1a + main_model_p->dim_lambda_1a;
  Free(main_model_p->lambda_1c);
  main_model_p->dim_lambda_1c_1 = main_model_p->Ncat;
  main_model_p->dim_lambda_1c_2 = main_model_p->Ncat;
  main_model_p->dim_lambda_1c = main_model_p->dim_lambda_1c_1 * main_model_p->dim_lambda_1c_2;
  main_model_p->lambda_1c = (double*) Calloc(main_model_p->dim_lambda_1c, double);
  main_model_p->offset_output_lambda_1c = main_model_p->offset_output_lambda_1b + main_model_p->dim_lambda_1b;
  Free(main_model_p->lambda_1d);
  main_model_p->dim_lambda_1d_1 = main_model_p->Ncat;
  main_model_p->dim_lambda_1d_2 = main_model_p->Ncat;
  main_model_p->dim_lambda_1d = main_model_p->dim_lambda_1d_1 * main_model_p->dim_lambda_1d_2;
  main_model_p->lambda_1d = (double*) Calloc(main_model_p->dim_lambda_1d, double);
  main_model_p->offset_output_lambda_1d = main_model_p->offset_output_lambda_1c + main_model_p->dim_lambda_1c;
  Free(main_model_p->lambda_sum_0);
  main_model_p->dim_lambda_sum_0 = main_model_p->Ncat;
  main_model_p->lambda_sum_0 = (double*) Calloc(main_model_p->dim_lambda_sum_0, double);
  main_model_p->offset_output_lambda_sum_0 = main_model_p->offset_output_lambda_1d + main_model_p->dim_lambda_1d;
  Free(main_model_p->lambda_sum_1a);
  main_model_p->dim_lambda_sum_1a = main_model_p->Ncat;
  main_model_p->lambda_sum_1a = (double*) Calloc(main_model_p->dim_lambda_sum_1a, double);
  main_model_p->offset_output_lambda_sum_1a = main_model_p->offset_output_lambda_sum_0 + main_model_p->dim_lambda_sum_0;
  Free(main_model_p->lambda_sum_1b);
  main_model_p->dim_lambda_sum_1b = main_model_p->Ncat;
  main_model_p->lambda_sum_1b = (double*) Calloc(main_model_p->dim_lambda_sum_1b, double);
  main_model_p->offset_output_lambda_sum_1b = main_model_p->offset_output_lambda_sum_1a + main_model_p->dim_lambda_sum_1a;
  Free(main_model_p->lambda_sum_1c);
  main_model_p->dim_lambda_sum_1c = main_model_p->Ncat;
  main_model_p->lambda_sum_1c = (double*) Calloc(main_model_p->dim_lambda_sum_1c, double);
  main_model_p->offset_output_lambda_sum_1c = main_model_p->offset_output_lambda_sum_1b + main_model_p->dim_lambda_sum_1b;
  Free(main_model_p->lambda_sum_1d);
  main_model_p->dim_lambda_sum_1d = main_model_p->Ncat;
  main_model_p->lambda_sum_1d = (double*) Calloc(main_model_p->dim_lambda_sum_1d, double);
  main_model_p->offset_output_lambda_sum_1d = main_model_p->offset_output_lambda_sum_1c + main_model_p->dim_lambda_sum_1c;
  Free(main_model_p->c_comm_balanced);
  main_model_p->dim_c_comm_balanced = main_model_p->Ncat;
  main_model_p->c_comm_balanced = (double*) Calloc(main_model_p->dim_c_comm_balanced, double);
  main_model_p->offset_output_c_comm_balanced = main_model_p->offset_output_lambda_sum_1d + main_model_p->dim_lambda_sum_1d;
  Free(main_model_p->c_noncomm_balanced);
  main_model_p->dim_c_noncomm_balanced = main_model_p->Ncat;
  main_model_p->c_noncomm_balanced = (double*) Calloc(main_model_p->dim_c_noncomm_balanced, double);
  main_model_p->offset_output_c_noncomm_balanced = main_model_p->offset_output_c_comm_balanced + main_model_p->dim_c_comm_balanced;
  Free(main_model_p->theta);
  main_model_p->dim_theta_1 = main_model_p->Ncat;
  main_model_p->dim_theta_2 = main_model_p->Ncat;
  main_model_p->dim_theta = main_model_p->dim_theta_1 * main_model_p->dim_theta_2;
  main_model_p->theta = (double*) Calloc(main_model_p->dim_theta, double);
  main_model_p->offset_output_theta = main_model_p->offset_output_c_noncomm_balanced + main_model_p->dim_c_noncomm_balanced;
  get_user_array(user, "theta", true, main_model_p->theta, 2, main_model_p->dim_theta_1, main_model_p->dim_theta_2);
  Free(main_model_p->OnPrEP_init);
  main_model_p->dim_OnPrEP_init = main_model_p->Ncat;
  main_model_p->OnPrEP_init = (double*) Calloc(main_model_p->dim_OnPrEP_init, double);
  get_user_array(user, "OnPrEP_init", true, main_model_p->OnPrEP_init, 1, main_model_p->dim_OnPrEP_init);
  for (int i = 0; i < main_model_p->dim_OnPrEP; ++i) {
    main_model_p->initial_OnPrEP[i] = main_model_p->OnPrEP_init[i];
  }
  Free(main_model_p->M_comm);
  main_model_p->dim_M_comm_1 = main_model_p->Ncat;
  main_model_p->dim_M_comm_2 = main_model_p->Ncat;
  main_model_p->dim_M_comm = main_model_p->dim_M_comm_1 * main_model_p->dim_M_comm_2;
  main_model_p->M_comm = (double*) Calloc(main_model_p->dim_M_comm, double);
  main_model_p->offset_output_M_comm = main_model_p->offset_output_theta + main_model_p->dim_theta;
  get_user_array(user, "M_comm", true, main_model_p->M_comm, 2, main_model_p->dim_M_comm_1, main_model_p->dim_M_comm_2);
  Free(main_model_p->M_noncomm);
  main_model_p->dim_M_noncomm_1 = main_model_p->Ncat;
  main_model_p->dim_M_noncomm_2 = main_model_p->Ncat;
  main_model_p->dim_M_noncomm = main_model_p->dim_M_noncomm_1 * main_model_p->dim_M_noncomm_2;
  main_model_p->M_noncomm = (double*) Calloc(main_model_p->dim_M_noncomm, double);
  main_model_p->offset_output_M_noncomm = main_model_p->offset_output_M_comm + main_model_p->dim_M_comm;
  get_user_array(user, "M_noncomm", true, main_model_p->M_noncomm, 2, main_model_p->dim_M_noncomm_1, main_model_p->dim_M_noncomm_2);
  Free(main_model_p->in_S0);
  main_model_p->dim_in_S0_1 = main_model_p->Ncat;
  main_model_p->dim_in_S0_2 = main_model_p->Ncat;
  main_model_p->dim_in_S0 = main_model_p->dim_in_S0_1 * main_model_p->dim_in_S0_2;
  main_model_p->in_S0 = (double*) Calloc(main_model_p->dim_in_S0, double);
  Free(main_model_p->in_S1a);
  main_model_p->dim_in_S1a_1 = main_model_p->Ncat;
  main_model_p->dim_in_S1a_2 = main_model_p->Ncat;
  main_model_p->dim_in_S1a = main_model_p->dim_in_S1a_1 * main_model_p->dim_in_S1a_2;
  main_model_p->in_S1a = (double*) Calloc(main_model_p->dim_in_S1a, double);
  Free(main_model_p->in_S1b);
  main_model_p->dim_in_S1b_1 = main_model_p->Ncat;
  main_model_p->dim_in_S1b_2 = main_model_p->Ncat;
  main_model_p->dim_in_S1b = main_model_p->dim_in_S1b_1 * main_model_p->dim_in_S1b_2;
  main_model_p->in_S1b = (double*) Calloc(main_model_p->dim_in_S1b, double);
  Free(main_model_p->in_S1c);
  main_model_p->dim_in_S1c_1 = main_model_p->Ncat;
  main_model_p->dim_in_S1c_2 = main_model_p->Ncat;
  main_model_p->dim_in_S1c = main_model_p->dim_in_S1c_1 * main_model_p->dim_in_S1c_2;
  main_model_p->in_S1c = (double*) Calloc(main_model_p->dim_in_S1c, double);
  Free(main_model_p->in_S1d);
  main_model_p->dim_in_S1d_1 = main_model_p->Ncat;
  main_model_p->dim_in_S1d_2 = main_model_p->Ncat;
  main_model_p->dim_in_S1d = main_model_p->dim_in_S1d_1 * main_model_p->dim_in_S1d_2;
  main_model_p->in_S1d = (double*) Calloc(main_model_p->dim_in_S1d, double);
  Free(main_model_p->in_I01);
  main_model_p->dim_in_I01_1 = main_model_p->Ncat;
  main_model_p->dim_in_I01_2 = main_model_p->Ncat;
  main_model_p->dim_in_I01 = main_model_p->dim_in_I01_1 * main_model_p->dim_in_I01_2;
  main_model_p->in_I01 = (double*) Calloc(main_model_p->dim_in_I01, double);
  Free(main_model_p->in_I11);
  main_model_p->dim_in_I11_1 = main_model_p->Ncat;
  main_model_p->dim_in_I11_2 = main_model_p->Ncat;
  main_model_p->dim_in_I11 = main_model_p->dim_in_I11_1 * main_model_p->dim_in_I11_2;
  main_model_p->in_I11 = (double*) Calloc(main_model_p->dim_in_I11, double);
  Free(main_model_p->in_I02);
  main_model_p->dim_in_I02_1 = main_model_p->Ncat;
  main_model_p->dim_in_I02_2 = main_model_p->Ncat;
  main_model_p->dim_in_I02 = main_model_p->dim_in_I02_1 * main_model_p->dim_in_I02_2;
  main_model_p->in_I02 = (double*) Calloc(main_model_p->dim_in_I02, double);
  Free(main_model_p->in_I03);
  main_model_p->dim_in_I03_1 = main_model_p->Ncat;
  main_model_p->dim_in_I03_2 = main_model_p->Ncat;
  main_model_p->dim_in_I03 = main_model_p->dim_in_I03_1 * main_model_p->dim_in_I03_2;
  main_model_p->in_I03 = (double*) Calloc(main_model_p->dim_in_I03, double);
  Free(main_model_p->in_I04);
  main_model_p->dim_in_I04_1 = main_model_p->Ncat;
  main_model_p->dim_in_I04_2 = main_model_p->Ncat;
  main_model_p->dim_in_I04 = main_model_p->dim_in_I04_1 * main_model_p->dim_in_I04_2;
  main_model_p->in_I04 = (double*) Calloc(main_model_p->dim_in_I04, double);
  Free(main_model_p->in_I05);
  main_model_p->dim_in_I05_1 = main_model_p->Ncat;
  main_model_p->dim_in_I05_2 = main_model_p->Ncat;
  main_model_p->dim_in_I05 = main_model_p->dim_in_I05_1 * main_model_p->dim_in_I05_2;
  main_model_p->in_I05 = (double*) Calloc(main_model_p->dim_in_I05, double);
  Free(main_model_p->in_I22);
  main_model_p->dim_in_I22_1 = main_model_p->Ncat;
  main_model_p->dim_in_I22_2 = main_model_p->Ncat;
  main_model_p->dim_in_I22 = main_model_p->dim_in_I22_1 * main_model_p->dim_in_I22_2;
  main_model_p->in_I22 = (double*) Calloc(main_model_p->dim_in_I22, double);
  Free(main_model_p->in_I23);
  main_model_p->dim_in_I23_1 = main_model_p->Ncat;
  main_model_p->dim_in_I23_2 = main_model_p->Ncat;
  main_model_p->dim_in_I23 = main_model_p->dim_in_I23_1 * main_model_p->dim_in_I23_2;
  main_model_p->in_I23 = (double*) Calloc(main_model_p->dim_in_I23, double);
  Free(main_model_p->in_I24);
  main_model_p->dim_in_I24_1 = main_model_p->Ncat;
  main_model_p->dim_in_I24_2 = main_model_p->Ncat;
  main_model_p->dim_in_I24 = main_model_p->dim_in_I24_1 * main_model_p->dim_in_I24_2;
  main_model_p->in_I24 = (double*) Calloc(main_model_p->dim_in_I24, double);
  Free(main_model_p->in_I25);
  main_model_p->dim_in_I25_1 = main_model_p->Ncat;
  main_model_p->dim_in_I25_2 = main_model_p->Ncat;
  main_model_p->dim_in_I25 = main_model_p->dim_in_I25_1 * main_model_p->dim_in_I25_2;
  main_model_p->in_I25 = (double*) Calloc(main_model_p->dim_in_I25, double);
  Free(main_model_p->in_I32);
  main_model_p->dim_in_I32_1 = main_model_p->Ncat;
  main_model_p->dim_in_I32_2 = main_model_p->Ncat;
  main_model_p->dim_in_I32 = main_model_p->dim_in_I32_1 * main_model_p->dim_in_I32_2;
  main_model_p->in_I32 = (double*) Calloc(main_model_p->dim_in_I32, double);
  Free(main_model_p->in_I33);
  main_model_p->dim_in_I33_1 = main_model_p->Ncat;
  main_model_p->dim_in_I33_2 = main_model_p->Ncat;
  main_model_p->dim_in_I33 = main_model_p->dim_in_I33_1 * main_model_p->dim_in_I33_2;
  main_model_p->in_I33 = (double*) Calloc(main_model_p->dim_in_I33, double);
  Free(main_model_p->in_I34);
  main_model_p->dim_in_I34_1 = main_model_p->Ncat;
  main_model_p->dim_in_I34_2 = main_model_p->Ncat;
  main_model_p->dim_in_I34 = main_model_p->dim_in_I34_1 * main_model_p->dim_in_I34_2;
  main_model_p->in_I34 = (double*) Calloc(main_model_p->dim_in_I34, double);
  Free(main_model_p->in_I35);
  main_model_p->dim_in_I35_1 = main_model_p->Ncat;
  main_model_p->dim_in_I35_2 = main_model_p->Ncat;
  main_model_p->dim_in_I35 = main_model_p->dim_in_I35_1 * main_model_p->dim_in_I35_2;
  main_model_p->in_I35 = (double*) Calloc(main_model_p->dim_in_I35, double);
  Free(main_model_p->in_I42);
  main_model_p->dim_in_I42_1 = main_model_p->Ncat;
  main_model_p->dim_in_I42_2 = main_model_p->Ncat;
  main_model_p->dim_in_I42 = main_model_p->dim_in_I42_1 * main_model_p->dim_in_I42_2;
  main_model_p->in_I42 = (double*) Calloc(main_model_p->dim_in_I42, double);
  Free(main_model_p->in_I43);
  main_model_p->dim_in_I43_1 = main_model_p->Ncat;
  main_model_p->dim_in_I43_2 = main_model_p->Ncat;
  main_model_p->dim_in_I43 = main_model_p->dim_in_I43_1 * main_model_p->dim_in_I43_2;
  main_model_p->in_I43 = (double*) Calloc(main_model_p->dim_in_I43, double);
  Free(main_model_p->in_I44);
  main_model_p->dim_in_I44_1 = main_model_p->Ncat;
  main_model_p->dim_in_I44_2 = main_model_p->Ncat;
  main_model_p->dim_in_I44 = main_model_p->dim_in_I44_1 * main_model_p->dim_in_I44_2;
  main_model_p->in_I44 = (double*) Calloc(main_model_p->dim_in_I44, double);
  Free(main_model_p->in_I45);
  main_model_p->dim_in_I45_1 = main_model_p->Ncat;
  main_model_p->dim_in_I45_2 = main_model_p->Ncat;
  main_model_p->dim_in_I45 = main_model_p->dim_in_I45_1 * main_model_p->dim_in_I45_2;
  main_model_p->in_I45 = (double*) Calloc(main_model_p->dim_in_I45, double);
  Free(main_model_p->sum_in_S0);
  main_model_p->dim_sum_in_S0 = main_model_p->Ncat;
  main_model_p->sum_in_S0 = (double*) Calloc(main_model_p->dim_sum_in_S0, double);
  main_model_p->offset_output_sum_in_S0 = main_model_p->offset_output_M_noncomm + main_model_p->dim_M_noncomm;
  Free(main_model_p->rate_move_in);
  main_model_p->dim_rate_move_in_1 = main_model_p->Ncat;
  main_model_p->dim_rate_move_in_2 = main_model_p->Ncat;
  main_model_p->dim_rate_move_in = main_model_p->dim_rate_move_in_1 * main_model_p->dim_rate_move_in_2;
  main_model_p->rate_move_in = (double*) Calloc(main_model_p->dim_rate_move_in, double);
  main_model_p->offset_output_rate_move_in = main_model_p->offset_output_sum_in_S0 + main_model_p->dim_sum_in_S0;
  get_user_array(user, "rate_move_in", true, main_model_p->rate_move_in, 2, main_model_p->dim_rate_move_in_1, main_model_p->dim_rate_move_in_2);
  Free(main_model_p->rate_move_out);
  main_model_p->dim_rate_move_out = main_model_p->Ncat;
  main_model_p->rate_move_out = (double*) Calloc(main_model_p->dim_rate_move_out, double);
  main_model_p->offset_output_rate_move_out = main_model_p->offset_output_rate_move_in + main_model_p->dim_rate_move_in;
  get_user_array(user, "rate_move_out", true, main_model_p->rate_move_out, 1, main_model_p->dim_rate_move_out);
  odin_interpolate_check(main_model_p->dim_c_t_comm, main_model_p->dim_c_y_comm_1, 1, "c_y_comm", "c_comm");
  odin_interpolate_check(main_model_p->dim_c_comm, main_model_p->dim_c_y_comm_2, 2, "c_y_comm", "c_comm");
  interpolate_free(main_model_p->interpolate_c_comm);
  main_model_p->interpolate_c_comm = interpolate_alloc(LINEAR, main_model_p->dim_c_t_comm, main_model_p->dim_c_comm, main_model_p->c_t_comm, main_model_p->c_y_comm);
  odin_interpolate_check(main_model_p->dim_c_t_noncomm, main_model_p->dim_c_y_noncomm_1, 1, "c_y_noncomm", "c_noncomm");
  odin_interpolate_check(main_model_p->dim_c_noncomm, main_model_p->dim_c_y_noncomm_2, 2, "c_y_noncomm", "c_noncomm");
  interpolate_free(main_model_p->interpolate_c_noncomm);
  main_model_p->interpolate_c_noncomm = interpolate_alloc(LINEAR, main_model_p->dim_c_t_noncomm, main_model_p->dim_c_noncomm, main_model_p->c_t_noncomm, main_model_p->c_y_noncomm);
  odin_interpolate_check(main_model_p->dim_testing_prob_t, main_model_p->dim_testing_prob_y_1, 1, "testing_prob_y", "testing_prob");
  odin_interpolate_check(main_model_p->dim_testing_prob, main_model_p->dim_testing_prob_y_2, 2, "testing_prob_y", "testing_prob");
  interpolate_free(main_model_p->interpolate_testing_prob);
  main_model_p->interpolate_testing_prob = interpolate_alloc(LINEAR, main_model_p->dim_testing_prob_t, main_model_p->dim_testing_prob, main_model_p->testing_prob_t, main_model_p->testing_prob_y);
  odin_interpolate_check(main_model_p->dim_ART_prob_t, main_model_p->dim_ART_prob_y_1, 1, "ART_prob_y", "ART_prob");
  odin_interpolate_check(main_model_p->dim_ART_prob, main_model_p->dim_ART_prob_y_2, 2, "ART_prob_y", "ART_prob");
  interpolate_free(main_model_p->interpolate_ART_prob);
  main_model_p->interpolate_ART_prob = interpolate_alloc(LINEAR, main_model_p->dim_ART_prob_t, main_model_p->dim_ART_prob, main_model_p->ART_prob_t, main_model_p->ART_prob_y);
  odin_interpolate_check(main_model_p->dim_epsilon_t, main_model_p->dim_epsilon_y, 0, "epsilon_y", "epsilon");
  interpolate_free(main_model_p->interpolate_epsilon);
  main_model_p->interpolate_epsilon = interpolate_alloc(CONSTANT, main_model_p->dim_epsilon_t, 1, main_model_p->epsilon_t, main_model_p->epsilon_y);
  odin_interpolate_check(main_model_p->dim_zetaa_t, main_model_p->dim_zetaa_y_1, 1, "zetaa_y", "zetaa");
  odin_interpolate_check(main_model_p->dim_zetaa, main_model_p->dim_zetaa_y_2, 2, "zetaa_y", "zetaa");
  interpolate_free(main_model_p->interpolate_zetaa);
  main_model_p->interpolate_zetaa = interpolate_alloc(CONSTANT, main_model_p->dim_zetaa_t, main_model_p->dim_zetaa, main_model_p->zetaa_t, main_model_p->zetaa_y);
  odin_interpolate_check(main_model_p->dim_zetab_t, main_model_p->dim_zetab_y_1, 1, "zetab_y", "zetab");
  odin_interpolate_check(main_model_p->dim_zetab, main_model_p->dim_zetab_y_2, 2, "zetab_y", "zetab");
  interpolate_free(main_model_p->interpolate_zetab);
  main_model_p->interpolate_zetab = interpolate_alloc(CONSTANT, main_model_p->dim_zetab_t, main_model_p->dim_zetab, main_model_p->zetab_t, main_model_p->zetab_y);
  odin_interpolate_check(main_model_p->dim_zetac_t, main_model_p->dim_zetac_y_1, 1, "zetac_y", "zetac");
  odin_interpolate_check(main_model_p->dim_zetac, main_model_p->dim_zetac_y_2, 2, "zetac_y", "zetac");
  interpolate_free(main_model_p->interpolate_zetac);
  main_model_p->interpolate_zetac = interpolate_alloc(CONSTANT, main_model_p->dim_zetac_t, main_model_p->dim_zetac, main_model_p->zetac_t, main_model_p->zetac_y);
  odin_interpolate_check(main_model_p->dim_fc_t_comm, main_model_p->dim_fc_y_comm_1, 1, "fc_y_comm", "fc_comm");
  odin_interpolate_check(main_model_p->dim_fc_comm_1, main_model_p->dim_fc_y_comm_2, 2, "fc_y_comm", "fc_comm");
  odin_interpolate_check(main_model_p->dim_fc_comm_2, main_model_p->dim_fc_y_comm_3, 3, "fc_y_comm", "fc_comm");
  interpolate_free(main_model_p->interpolate_fc_comm);
  main_model_p->interpolate_fc_comm = interpolate_alloc(LINEAR, main_model_p->dim_fc_t_comm, main_model_p->dim_fc_comm, main_model_p->fc_t_comm, main_model_p->fc_y_comm);
  odin_interpolate_check(main_model_p->dim_fP_t_comm, main_model_p->dim_fP_y_comm_1, 1, "fP_y_comm", "fP_comm");
  odin_interpolate_check(main_model_p->dim_fP_comm, main_model_p->dim_fP_y_comm_2, 2, "fP_y_comm", "fP_comm");
  interpolate_free(main_model_p->interpolate_fP_comm);
  main_model_p->interpolate_fP_comm = interpolate_alloc(LINEAR, main_model_p->dim_fP_t_comm, main_model_p->dim_fP_comm, main_model_p->fP_t_comm, main_model_p->fP_y_comm);
  odin_interpolate_check(main_model_p->dim_fc_t_noncomm, main_model_p->dim_fc_y_noncomm_1, 1, "fc_y_noncomm", "fc_noncomm");
  odin_interpolate_check(main_model_p->dim_fc_noncomm_1, main_model_p->dim_fc_y_noncomm_2, 2, "fc_y_noncomm", "fc_noncomm");
  odin_interpolate_check(main_model_p->dim_fc_noncomm_2, main_model_p->dim_fc_y_noncomm_3, 3, "fc_y_noncomm", "fc_noncomm");
  interpolate_free(main_model_p->interpolate_fc_noncomm);
  main_model_p->interpolate_fc_noncomm = interpolate_alloc(LINEAR, main_model_p->dim_fc_t_noncomm, main_model_p->dim_fc_noncomm, main_model_p->fc_t_noncomm, main_model_p->fc_y_noncomm);
  odin_interpolate_check(main_model_p->dim_fP_t_noncomm, main_model_p->dim_fP_y_noncomm_1, 1, "fP_y_noncomm", "fP_noncomm");
  odin_interpolate_check(main_model_p->dim_fP_noncomm, main_model_p->dim_fP_y_noncomm_2, 2, "fP_y_noncomm", "fP_noncomm");
  interpolate_free(main_model_p->interpolate_fP_noncomm);
  main_model_p->interpolate_fP_noncomm = interpolate_alloc(LINEAR, main_model_p->dim_fP_t_noncomm, main_model_p->dim_fP_noncomm, main_model_p->fP_t_noncomm, main_model_p->fP_y_noncomm);
  main_model_p->dim = main_model_p->offset_I45 + main_model_p->dim_I45;
  main_model_p->dim_output = main_model_p->offset_output_rate_move_out + main_model_p->dim_rate_move_out;
  return R_NilValue;
}
// Wrapper around this for use from R.
SEXP r_main_model_set_user(SEXP main_model_ptr, SEXP user) {
  main_model_pars *main_model_p = main_model_get_pointer(main_model_ptr, 1);
  main_model_set_user(main_model_p, user);
  return R_NilValue;
}

// Arrange to free all memory we have allocated
// This is called by R automatically when the pointer is
// garbage collected (i.e., when all objects holding the pointer
// go out of scope
void main_model_finalize(SEXP main_model_ptr) {
  main_model_pars *main_model_p = main_model_get_pointer(main_model_ptr, 0);
  if (main_model_ptr) {
    Free(main_model_p->c_t_comm);
    Free(main_model_p->c_t_noncomm);
    Free(main_model_p->c_y_comm);
    Free(main_model_p->c_y_noncomm);
    Free(main_model_p->testing_prob_t);
    Free(main_model_p->testing_prob_y);
    Free(main_model_p->ART_prob_t);
    Free(main_model_p->ART_prob_y);
    Free(main_model_p->epsilon_t);
    Free(main_model_p->epsilon_y);
    Free(main_model_p->fc_t_comm);
    Free(main_model_p->fc_y_comm);
    Free(main_model_p->fP_t_comm);
    Free(main_model_p->fP_y_comm);
    Free(main_model_p->fc_t_noncomm);
    Free(main_model_p->fc_y_noncomm);
    Free(main_model_p->fP_t_noncomm);
    Free(main_model_p->fP_y_noncomm);
    Free(main_model_p->zetaa_t);
    Free(main_model_p->zetab_t);
    Free(main_model_p->zetac_t);
    Free(main_model_p->zetaa_y);
    Free(main_model_p->zetab_y);
    Free(main_model_p->zetac_y);
    Free(main_model_p->c_comm);
    Free(main_model_p->c_noncomm);
    Free(main_model_p->new_people_in_group);
    Free(main_model_p->comm_partnerships_requested);
    Free(main_model_p->noncomm_partnerships_requested);
    Free(main_model_p->testing_prob);
    Free(main_model_p->ART_prob);
    Free(main_model_p->tau);
    Free(main_model_p->rho);
    Free(main_model_p->frac_F);
    Free(main_model_p->frac_N_sexualpop);
    Free(main_model_p->zetaa);
    Free(main_model_p->zetab);
    Free(main_model_p->zetac);
    Free(main_model_p->omega);
    Free(main_model_p->frac_N);
    Free(main_model_p->mu);
    Free(main_model_p->gamma01);
    Free(main_model_p->gamma02);
    Free(main_model_p->gamma03);
    Free(main_model_p->gamma04);
    Free(main_model_p->gamma11);
    Free(main_model_p->gamma22);
    Free(main_model_p->gamma23);
    Free(main_model_p->gamma24);
    Free(main_model_p->gamma32);
    Free(main_model_p->gamma33);
    Free(main_model_p->gamma34);
    Free(main_model_p->gamma42);
    Free(main_model_p->gamma43);
    Free(main_model_p->gamma44);
    Free(main_model_p->phi2);
    Free(main_model_p->phi3);
    Free(main_model_p->phi4);
    Free(main_model_p->phi5);
    Free(main_model_p->psia);
    Free(main_model_p->psib);
    Free(main_model_p->kappaa);
    Free(main_model_p->kappab);
    Free(main_model_p->kappac);
    Free(main_model_p->alpha01);
    Free(main_model_p->alpha02);
    Free(main_model_p->alpha03);
    Free(main_model_p->alpha04);
    Free(main_model_p->alpha05);
    Free(main_model_p->alpha11);
    Free(main_model_p->alpha22);
    Free(main_model_p->alpha23);
    Free(main_model_p->alpha24);
    Free(main_model_p->alpha25);
    Free(main_model_p->alpha32);
    Free(main_model_p->alpha33);
    Free(main_model_p->alpha34);
    Free(main_model_p->alpha35);
    Free(main_model_p->alpha42);
    Free(main_model_p->alpha43);
    Free(main_model_p->alpha44);
    Free(main_model_p->alpha45);
    Free(main_model_p->beta_comm);
    Free(main_model_p->beta_noncomm);
    Free(main_model_p->p_comm);
    Free(main_model_p->p_noncomm);
    Free(main_model_p->ec);
    Free(main_model_p->eP);
    Free(main_model_p->eP0);
    Free(main_model_p->eP1a);
    Free(main_model_p->eP1b);
    Free(main_model_p->eP1c);
    Free(main_model_p->eP1d);
    Free(main_model_p->fc_comm);
    Free(main_model_p->fP_comm);
    Free(main_model_p->fc_noncomm);
    Free(main_model_p->fP_noncomm);
    Free(main_model_p->n_comm);
    Free(main_model_p->n_noncomm);
    Free(main_model_p->initial_cumuInf);
    Free(main_model_p->initial_OnPrEP);
    Free(main_model_p->initial_S0);
    Free(main_model_p->initial_S1a);
    Free(main_model_p->initial_S1b);
    Free(main_model_p->initial_S1c);
    Free(main_model_p->initial_S1d);
    Free(main_model_p->initial_I01);
    Free(main_model_p->initial_I11);
    Free(main_model_p->initial_I02);
    Free(main_model_p->initial_I03);
    Free(main_model_p->initial_I04);
    Free(main_model_p->initial_I05);
    Free(main_model_p->initial_I22);
    Free(main_model_p->initial_I23);
    Free(main_model_p->initial_I24);
    Free(main_model_p->initial_I25);
    Free(main_model_p->initial_I32);
    Free(main_model_p->initial_I33);
    Free(main_model_p->initial_I34);
    Free(main_model_p->initial_I35);
    Free(main_model_p->initial_I42);
    Free(main_model_p->initial_I43);
    Free(main_model_p->initial_I44);
    Free(main_model_p->initial_I45);
    Free(main_model_p->S0_init);
    Free(main_model_p->S1a_init);
    Free(main_model_p->S1b_init);
    Free(main_model_p->S1c_init);
    Free(main_model_p->S1d_init);
    Free(main_model_p->I01_init);
    Free(main_model_p->I11_init);
    Free(main_model_p->I02_init);
    Free(main_model_p->I03_init);
    Free(main_model_p->I04_init);
    Free(main_model_p->I05_init);
    Free(main_model_p->I22_init);
    Free(main_model_p->I23_init);
    Free(main_model_p->I24_init);
    Free(main_model_p->I25_init);
    Free(main_model_p->I32_init);
    Free(main_model_p->I33_init);
    Free(main_model_p->I34_init);
    Free(main_model_p->I35_init);
    Free(main_model_p->I42_init);
    Free(main_model_p->I43_init);
    Free(main_model_p->I44_init);
    Free(main_model_p->I45_init);
    Free(main_model_p->N);
    Free(main_model_p->E0);
    Free(main_model_p->E1a);
    Free(main_model_p->E1b);
    Free(main_model_p->E1c);
    Free(main_model_p->E1d);
    Free(main_model_p->cumuInf_init);
    Free(main_model_p->alphaItot);
    Free(main_model_p->prev);
    Free(main_model_p->lambda);
    Free(main_model_p->lambda_0);
    Free(main_model_p->lambda_1a);
    Free(main_model_p->lambda_1b);
    Free(main_model_p->lambda_1c);
    Free(main_model_p->lambda_1d);
    Free(main_model_p->lambda_sum_0);
    Free(main_model_p->lambda_sum_1a);
    Free(main_model_p->lambda_sum_1b);
    Free(main_model_p->lambda_sum_1c);
    Free(main_model_p->lambda_sum_1d);
    Free(main_model_p->c_comm_balanced);
    Free(main_model_p->c_noncomm_balanced);
    Free(main_model_p->theta);
    Free(main_model_p->OnPrEP_init);
    Free(main_model_p->M_comm);
    Free(main_model_p->M_noncomm);
    Free(main_model_p->in_S0);
    Free(main_model_p->in_S1a);
    Free(main_model_p->in_S1b);
    Free(main_model_p->in_S1c);
    Free(main_model_p->in_S1d);
    Free(main_model_p->in_I01);
    Free(main_model_p->in_I11);
    Free(main_model_p->in_I02);
    Free(main_model_p->in_I03);
    Free(main_model_p->in_I04);
    Free(main_model_p->in_I05);
    Free(main_model_p->in_I22);
    Free(main_model_p->in_I23);
    Free(main_model_p->in_I24);
    Free(main_model_p->in_I25);
    Free(main_model_p->in_I32);
    Free(main_model_p->in_I33);
    Free(main_model_p->in_I34);
    Free(main_model_p->in_I35);
    Free(main_model_p->in_I42);
    Free(main_model_p->in_I43);
    Free(main_model_p->in_I44);
    Free(main_model_p->in_I45);
    Free(main_model_p->sum_in_S0);
    Free(main_model_p->rate_move_in);
    Free(main_model_p->rate_move_out);
    interpolate_free(main_model_p->interpolate_c_comm);
    interpolate_free(main_model_p->interpolate_c_noncomm);
    interpolate_free(main_model_p->interpolate_testing_prob);
    interpolate_free(main_model_p->interpolate_ART_prob);
    interpolate_free(main_model_p->interpolate_epsilon);
    interpolate_free(main_model_p->interpolate_zetaa);
    interpolate_free(main_model_p->interpolate_zetab);
    interpolate_free(main_model_p->interpolate_zetac);
    interpolate_free(main_model_p->interpolate_fc_comm);
    interpolate_free(main_model_p->interpolate_fP_comm);
    interpolate_free(main_model_p->interpolate_fc_noncomm);
    interpolate_free(main_model_p->interpolate_fP_noncomm);
    Free(main_model_p);
    R_ClearExternalPtr(main_model_ptr);
  }
}

SEXP main_model_initialise(SEXP main_model_ptr, SEXP t_ptr) {
  main_model_pars *main_model_p = main_model_get_pointer(main_model_ptr, 1);
  SEXP state = PROTECT(allocVector(REALSXP, main_model_p->dim));
  memcpy(REAL(state) + 0, main_model_p->initial_cumuInf, main_model_p->dim_cumuInf * sizeof(double));
  memcpy(REAL(state) + main_model_p->offset_OnPrEP, main_model_p->initial_OnPrEP, main_model_p->dim_OnPrEP * sizeof(double));
  memcpy(REAL(state) + main_model_p->offset_S0, main_model_p->initial_S0, main_model_p->dim_S0 * sizeof(double));
  memcpy(REAL(state) + main_model_p->offset_S1a, main_model_p->initial_S1a, main_model_p->dim_S1a * sizeof(double));
  memcpy(REAL(state) + main_model_p->offset_S1b, main_model_p->initial_S1b, main_model_p->dim_S1b * sizeof(double));
  memcpy(REAL(state) + main_model_p->offset_S1c, main_model_p->initial_S1c, main_model_p->dim_S1c * sizeof(double));
  memcpy(REAL(state) + main_model_p->offset_S1d, main_model_p->initial_S1d, main_model_p->dim_S1d * sizeof(double));
  memcpy(REAL(state) + main_model_p->offset_I01, main_model_p->initial_I01, main_model_p->dim_I01 * sizeof(double));
  memcpy(REAL(state) + main_model_p->offset_I11, main_model_p->initial_I11, main_model_p->dim_I11 * sizeof(double));
  memcpy(REAL(state) + main_model_p->offset_I02, main_model_p->initial_I02, main_model_p->dim_I02 * sizeof(double));
  memcpy(REAL(state) + main_model_p->offset_I03, main_model_p->initial_I03, main_model_p->dim_I03 * sizeof(double));
  memcpy(REAL(state) + main_model_p->offset_I04, main_model_p->initial_I04, main_model_p->dim_I04 * sizeof(double));
  memcpy(REAL(state) + main_model_p->offset_I05, main_model_p->initial_I05, main_model_p->dim_I05 * sizeof(double));
  memcpy(REAL(state) + main_model_p->offset_I22, main_model_p->initial_I22, main_model_p->dim_I22 * sizeof(double));
  memcpy(REAL(state) + main_model_p->offset_I23, main_model_p->initial_I23, main_model_p->dim_I23 * sizeof(double));
  memcpy(REAL(state) + main_model_p->offset_I24, main_model_p->initial_I24, main_model_p->dim_I24 * sizeof(double));
  memcpy(REAL(state) + main_model_p->offset_I25, main_model_p->initial_I25, main_model_p->dim_I25 * sizeof(double));
  memcpy(REAL(state) + main_model_p->offset_I32, main_model_p->initial_I32, main_model_p->dim_I32 * sizeof(double));
  memcpy(REAL(state) + main_model_p->offset_I33, main_model_p->initial_I33, main_model_p->dim_I33 * sizeof(double));
  memcpy(REAL(state) + main_model_p->offset_I34, main_model_p->initial_I34, main_model_p->dim_I34 * sizeof(double));
  memcpy(REAL(state) + main_model_p->offset_I35, main_model_p->initial_I35, main_model_p->dim_I35 * sizeof(double));
  memcpy(REAL(state) + main_model_p->offset_I42, main_model_p->initial_I42, main_model_p->dim_I42 * sizeof(double));
  memcpy(REAL(state) + main_model_p->offset_I43, main_model_p->initial_I43, main_model_p->dim_I43 * sizeof(double));
  memcpy(REAL(state) + main_model_p->offset_I44, main_model_p->initial_I44, main_model_p->dim_I44 * sizeof(double));
  memcpy(REAL(state) + main_model_p->offset_I45, main_model_p->initial_I45, main_model_p->dim_I45 * sizeof(double));
  setAttrib(state, install("output_len"), ScalarInteger(main_model_p->dim_output));
  UNPROTECT(1);
  return state;
}

SEXP main_model_set_initial(SEXP main_model_ptr, SEXP t_ptr, SEXP state_ptr) {
  return R_NilValue;
}

void main_model_deriv(main_model_pars *main_model_p, double t, double *state, double *dstatedt, double *output) {
  double *cumuInf = state;
  double *S0 = state + main_model_p->offset_S0;
  double *S1a = state + main_model_p->offset_S1a;
  double *S1b = state + main_model_p->offset_S1b;
  double *S1c = state + main_model_p->offset_S1c;
  double *S1d = state + main_model_p->offset_S1d;
  double *I01 = state + main_model_p->offset_I01;
  double *I11 = state + main_model_p->offset_I11;
  double *I02 = state + main_model_p->offset_I02;
  double *I03 = state + main_model_p->offset_I03;
  double *I04 = state + main_model_p->offset_I04;
  double *I05 = state + main_model_p->offset_I05;
  double *I22 = state + main_model_p->offset_I22;
  double *I23 = state + main_model_p->offset_I23;
  double *I24 = state + main_model_p->offset_I24;
  double *I25 = state + main_model_p->offset_I25;
  double *I32 = state + main_model_p->offset_I32;
  double *I33 = state + main_model_p->offset_I33;
  double *I34 = state + main_model_p->offset_I34;
  double *I35 = state + main_model_p->offset_I35;
  double *I42 = state + main_model_p->offset_I42;
  double *I43 = state + main_model_p->offset_I43;
  double *I44 = state + main_model_p->offset_I44;
  double *I45 = state + main_model_p->offset_I45;
  double *deriv_cumuInf = dstatedt;
  double *deriv_OnPrEP = dstatedt + main_model_p->offset_OnPrEP;
  double *deriv_S0 = dstatedt + main_model_p->offset_S0;
  double *deriv_S1a = dstatedt + main_model_p->offset_S1a;
  double *deriv_S1b = dstatedt + main_model_p->offset_S1b;
  double *deriv_S1c = dstatedt + main_model_p->offset_S1c;
  double *deriv_S1d = dstatedt + main_model_p->offset_S1d;
  double *deriv_I01 = dstatedt + main_model_p->offset_I01;
  double *deriv_I11 = dstatedt + main_model_p->offset_I11;
  double *deriv_I02 = dstatedt + main_model_p->offset_I02;
  double *deriv_I03 = dstatedt + main_model_p->offset_I03;
  double *deriv_I04 = dstatedt + main_model_p->offset_I04;
  double *deriv_I05 = dstatedt + main_model_p->offset_I05;
  double *deriv_I22 = dstatedt + main_model_p->offset_I22;
  double *deriv_I23 = dstatedt + main_model_p->offset_I23;
  double *deriv_I24 = dstatedt + main_model_p->offset_I24;
  double *deriv_I25 = dstatedt + main_model_p->offset_I25;
  double *deriv_I32 = dstatedt + main_model_p->offset_I32;
  double *deriv_I33 = dstatedt + main_model_p->offset_I33;
  double *deriv_I34 = dstatedt + main_model_p->offset_I34;
  double *deriv_I35 = dstatedt + main_model_p->offset_I35;
  double *deriv_I42 = dstatedt + main_model_p->offset_I42;
  double *deriv_I43 = dstatedt + main_model_p->offset_I43;
  double *deriv_I44 = dstatedt + main_model_p->offset_I44;
  double *deriv_I45 = dstatedt + main_model_p->offset_I45;
  interpolate_linear_run(t, main_model_p->interpolate_c_comm, main_model_p->c_comm);
  interpolate_linear_run(t, main_model_p->interpolate_c_noncomm, main_model_p->c_noncomm);
  interpolate_linear_run(t, main_model_p->interpolate_testing_prob, main_model_p->testing_prob);
  interpolate_linear_run(t, main_model_p->interpolate_ART_prob, main_model_p->ART_prob);
  for (int i = 0; i < main_model_p->dim_tau; ++i) {
    main_model_p->tau[i] = -log(1 - main_model_p->testing_prob[i]);
  }
  for (int i = 0; i < main_model_p->dim_rho; ++i) {
    main_model_p->rho[i] = -log(1 - main_model_p->ART_prob[i]);
  }
  interpolate_constant_run(t, main_model_p->interpolate_epsilon, &(main_model_p->epsilon));
  interpolate_constant_run(t, main_model_p->interpolate_zetaa, main_model_p->zetaa);
  interpolate_constant_run(t, main_model_p->interpolate_zetab, main_model_p->zetab);
  interpolate_constant_run(t, main_model_p->interpolate_zetac, main_model_p->zetac);
  interpolate_linear_run(t, main_model_p->interpolate_fc_comm, main_model_p->fc_comm);
  interpolate_linear_run(t, main_model_p->interpolate_fP_comm, main_model_p->fP_comm);
  interpolate_linear_run(t, main_model_p->interpolate_fc_noncomm, main_model_p->fc_noncomm);
  interpolate_linear_run(t, main_model_p->interpolate_fP_noncomm, main_model_p->fP_noncomm);
  for (int i = 0; i < main_model_p->dim_OnPrEP; ++i) {
    deriv_OnPrEP[i] = main_model_p->zetaa[i] * S0[i] + main_model_p->zetab[i] * S0[i] + main_model_p->zetac[i] * S0[i];
  }
  for (int i = 0; i < main_model_p->dim_N; ++i) {
    main_model_p->N[i] = S0[i] + S1a[i] + S1b[i] + S1c[i] + S1d[i] + I01[i] + I11[i] + I02[i] + I03[i] + I04[i] + I05[i] + I22[i] + I23[i] + I24[i] + I25[i] + I32[i] + I33[i] + I34[i] + I35[i] + I42[i] + I43[i] + I44[i] + I45[i];
  }
  double Ntot_inc_former_FSW_nonCot = odin_sum1(main_model_p->N, 0, main_model_p->dim_N - 1);
  double new_people = main_model_p->epsilon * Ntot_inc_former_FSW_nonCot;
  for (int i = 0; i < main_model_p->dim_E1a; ++i) {
    main_model_p->E1a[i] = main_model_p->zetaa[i] * S0[i] - main_model_p->psia[i] * S1a[i] - main_model_p->kappaa[i] * S1a[i];
  }
  for (int i = 0; i < main_model_p->dim_E1b; ++i) {
    main_model_p->E1b[i] = main_model_p->zetab[i] * S0[i] + main_model_p->psia[i] * S1a[i] - main_model_p->psib[i] * S1b[i] - main_model_p->kappab[i] * S1b[i];
  }
  for (int i = 0; i < main_model_p->dim_E1c; ++i) {
    main_model_p->E1c[i] = main_model_p->zetac[i] * S0[i] + main_model_p->psib[i] * S1b[i] - main_model_p->kappac[i] * S1c[i];
  }
  for (int i = 0; i < main_model_p->dim_E1d; ++i) {
    main_model_p->E1d[i] = main_model_p->kappaa[i] * S1a[i] + main_model_p->kappab[i] * S1b[i] + main_model_p->kappac[i] * S1c[i];
  }
  for (int i = 0; i < main_model_p->dim_alphaItot; ++i) {
    main_model_p->alphaItot[i] = main_model_p->alpha01[i] * I01[i] + main_model_p->alpha11[i] * I11[i] + main_model_p->alpha02[i] * I02[i] + main_model_p->alpha03[i] * I03[i] + main_model_p->alpha04[i] * I04[i] + main_model_p->alpha05[i] * I05[i] + main_model_p->alpha22[i] * I22[i] + main_model_p->alpha23[i] * I23[i] + main_model_p->alpha24[i] * I24[i] + main_model_p->alpha25[i] * I25[i] + main_model_p->alpha32[i] * I32[i] + main_model_p->alpha33[i] * I33[i] + main_model_p->alpha34[i] * I34[i] + main_model_p->alpha35[i] * I35[i] + main_model_p->alpha42[i] * I42[i] + main_model_p->alpha43[i] * I43[i] + main_model_p->alpha44[i] * I44[i] + main_model_p->alpha45[i] * I45[i];
  }
  for (int i = 0; i < main_model_p->dim_E0; ++i) {
    main_model_p->E0[i] = (main_model_p->replaceDeaths == 1 ? main_model_p->mu[i] * main_model_p->N[i] + main_model_p->alphaItot[i] + new_people * main_model_p->omega[i] - S0[i] * (main_model_p->zetaa[i] + main_model_p->zetab[i] + main_model_p->zetac[i]) : new_people * main_model_p->omega[i] - S0[i] * (main_model_p->zetaa[i] + main_model_p->zetab[i] + main_model_p->zetac[i]));
  }
  for (int i = 0; i < main_model_p->dim_c_comm_balanced; ++i) {
    main_model_p->c_comm_balanced[i] = main_model_p->c_comm[i];
  }
  {
    int i = 4;
    main_model_p->c_comm_balanced[i] = (main_model_p->Ncat == 9 && main_model_p->who_believe_comm == 0 ? (main_model_p->c_comm[0] * main_model_p->N[0] + main_model_p->c_comm[1] * main_model_p->N[1]) / main_model_p->N[4] : main_model_p->c_comm_balanced[4]);
  }
  {
    int i = 0;
    main_model_p->c_comm_balanced[i] = (main_model_p->Ncat == 9 && main_model_p->who_believe_comm == 1 ? (main_model_p->c_comm[4] * main_model_p->N[4] - main_model_p->c_comm[1] * main_model_p->N[1]) / main_model_p->N[0] : main_model_p->c_comm_balanced[0]);
  }
  for (int i = 0; i < main_model_p->dim_c_noncomm_balanced; ++i) {
    main_model_p->c_noncomm_balanced[i] = main_model_p->c_noncomm[i];
  }
  {
    int i = 2;
    main_model_p->c_noncomm_balanced[i] = (main_model_p->Ncat == 9 ? (main_model_p->N[4] * main_model_p->c_noncomm[4] + main_model_p->N[5] * main_model_p->c_noncomm[5] - main_model_p->N[0] * main_model_p->c_noncomm[0] - main_model_p->N[1] * main_model_p->c_noncomm[1]) / (main_model_p->N[2] + main_model_p->N[3]) : main_model_p->c_noncomm_balanced[2]);
  }
  {
    int i = 3;
    main_model_p->c_noncomm_balanced[i] = (main_model_p->Ncat == 9 ? main_model_p->c_noncomm_balanced[2] : main_model_p->c_noncomm_balanced[3]);
  }
  for (int i = 0; i < main_model_p->dim_comm_partnerships_requested_1; ++i) {
    for (int j = 0; j < main_model_p->dim_comm_partnerships_requested_2; ++j) {
      main_model_p->comm_partnerships_requested[i + j * main_model_p->dim_comm_partnerships_requested_1] = main_model_p->N[j] * main_model_p->c_comm_balanced[j] * main_model_p->M_comm[i + j * main_model_p->dim_M_comm_1];
    }
  }
  for (int i = 0; i < main_model_p->dim_p_comm_1; ++i) {
    for (int j = 0; j < main_model_p->dim_p_comm_2; ++j) {
      main_model_p->p_comm[i + j * main_model_p->dim_p_comm_1] = (main_model_p->M_comm[i + j * main_model_p->dim_M_comm_1] == 0 ? 0 : main_model_p->M_comm[i + j * main_model_p->dim_M_comm_1] * main_model_p->N[j] * main_model_p->c_comm_balanced[j] / odin_sum2(main_model_p->comm_partnerships_requested, i, i, 0, main_model_p->dim_comm_partnerships_requested_2 - 1, main_model_p->dim_comm_partnerships_requested_1));
    }
  }
  for (int i = 0; i < main_model_p->dim_noncomm_partnerships_requested_1; ++i) {
    for (int j = 0; j < main_model_p->dim_noncomm_partnerships_requested_2; ++j) {
      main_model_p->noncomm_partnerships_requested[i + j * main_model_p->dim_noncomm_partnerships_requested_1] = main_model_p->N[j] * main_model_p->c_noncomm_balanced[j] * main_model_p->M_noncomm[i + j * main_model_p->dim_M_noncomm_1];
    }
  }
  for (int i = 0; i < main_model_p->dim_p_noncomm_1; ++i) {
    for (int j = 0; j < main_model_p->dim_p_noncomm_2; ++j) {
      main_model_p->p_noncomm[i + j * main_model_p->dim_p_noncomm_1] = (main_model_p->M_noncomm[i + j * main_model_p->dim_M_noncomm_1] == 0 ? 0 : main_model_p->M_noncomm[i + j * main_model_p->dim_M_noncomm_1] * main_model_p->N[j] * main_model_p->c_noncomm_balanced[j] / odin_sum2(main_model_p->noncomm_partnerships_requested, i, i, 0, main_model_p->dim_noncomm_partnerships_requested_2 - 1, main_model_p->dim_noncomm_partnerships_requested_1));
    }
  }
  for (int i = 0; i < main_model_p->dim_lambda_0_1; ++i) {
    for (int j = 0; j < main_model_p->dim_lambda_0_2; ++j) {
      main_model_p->lambda_0[i + j * main_model_p->dim_lambda_0_1] = (i == j ? 0 : compute_lambda(main_model_p->c_comm_balanced[i], main_model_p->p_comm[i + j * main_model_p->dim_p_comm_1], S0[j], S1a[j], S1b[j], S1c[j], I01[j], I11[j], I02[j], I03[j], I04[j], I05[j], I22[j], I23[j], I24[j], I25[j], I32[j], I33[j], I34[j], I35[j], I42[j], I43[j], I44[j], I45[j], main_model_p->N[j], main_model_p->beta_comm[i], main_model_p->R, main_model_p->fc_comm[i + j * main_model_p->dim_fc_comm_1], main_model_p->fP_comm[i], main_model_p->n_comm[i + j * main_model_p->dim_n_comm_1], main_model_p->eP0[i], main_model_p->ec[i], main_model_p->fc_noncomm[i + j * main_model_p->dim_fc_noncomm_1], main_model_p->fP_noncomm[i], main_model_p->n_noncomm[i + j * main_model_p->dim_n_noncomm_1], main_model_p->c_noncomm_balanced[i], main_model_p->p_noncomm[i + j * main_model_p->dim_p_noncomm_1], main_model_p->infect_ART, main_model_p->infect_acute, main_model_p->infect_AIDS, main_model_p->beta_noncomm[i]));
    }
  }
  for (int i = 0; i < main_model_p->dim_lambda_1a_1; ++i) {
    for (int j = 0; j < main_model_p->dim_lambda_1a_2; ++j) {
      main_model_p->lambda_1a[i + j * main_model_p->dim_lambda_1a_1] = (i == j ? 0 : compute_lambda(main_model_p->c_comm_balanced[i], main_model_p->p_comm[i + j * main_model_p->dim_p_comm_1], S0[j], S1a[j], S1b[j], S1c[j], I01[j], I11[j], I02[j], I03[j], I04[j], I05[j], I22[j], I23[j], I24[j], I25[j], I32[j], I33[j], I34[j], I35[j], I42[j], I43[j], I44[j], I45[j], main_model_p->N[j], main_model_p->beta_comm[i], main_model_p->R, main_model_p->fc_comm[i + j * main_model_p->dim_fc_comm_1], main_model_p->fP_comm[i], main_model_p->n_comm[i + j * main_model_p->dim_n_comm_1], main_model_p->eP1a[i], main_model_p->ec[i], main_model_p->fc_noncomm[i + j * main_model_p->dim_fc_noncomm_1], main_model_p->fP_noncomm[i], main_model_p->n_noncomm[i + j * main_model_p->dim_n_noncomm_1], main_model_p->c_noncomm_balanced[i], main_model_p->p_noncomm[i + j * main_model_p->dim_p_noncomm_1], main_model_p->infect_ART, main_model_p->infect_acute, main_model_p->infect_AIDS, main_model_p->beta_noncomm[i]));
    }
  }
  for (int i = 0; i < main_model_p->dim_lambda_1b_1; ++i) {
    for (int j = 0; j < main_model_p->dim_lambda_1b_2; ++j) {
      main_model_p->lambda_1b[i + j * main_model_p->dim_lambda_1b_1] = (i == j ? 0 : compute_lambda(main_model_p->c_comm_balanced[i], main_model_p->p_comm[i + j * main_model_p->dim_p_comm_1], S0[j], S1a[j], S1b[j], S1c[j], I01[j], I11[j], I02[j], I03[j], I04[j], I05[j], I22[j], I23[j], I24[j], I25[j], I32[j], I33[j], I34[j], I35[j], I42[j], I43[j], I44[j], I45[j], main_model_p->N[j], main_model_p->beta_comm[i], main_model_p->R, main_model_p->fc_comm[i + j * main_model_p->dim_fc_comm_1], main_model_p->fP_comm[i], main_model_p->n_comm[i + j * main_model_p->dim_n_comm_1], main_model_p->eP1b[i], main_model_p->ec[i], main_model_p->fc_noncomm[i + j * main_model_p->dim_fc_noncomm_1], main_model_p->fP_noncomm[i], main_model_p->n_noncomm[i + j * main_model_p->dim_n_noncomm_1], main_model_p->c_noncomm_balanced[i], main_model_p->p_noncomm[i + j * main_model_p->dim_p_noncomm_1], main_model_p->infect_ART, main_model_p->infect_acute, main_model_p->infect_AIDS, main_model_p->beta_noncomm[i]));
    }
  }
  for (int i = 0; i < main_model_p->dim_lambda_1c_1; ++i) {
    for (int j = 0; j < main_model_p->dim_lambda_1c_2; ++j) {
      main_model_p->lambda_1c[i + j * main_model_p->dim_lambda_1c_1] = (i == j ? 0 : compute_lambda(main_model_p->c_comm_balanced[i], main_model_p->p_comm[i + j * main_model_p->dim_p_comm_1], S0[j], S1a[j], S1b[j], S1c[j], I01[j], I11[j], I02[j], I03[j], I04[j], I05[j], I22[j], I23[j], I24[j], I25[j], I32[j], I33[j], I34[j], I35[j], I42[j], I43[j], I44[j], I45[j], main_model_p->N[j], main_model_p->beta_comm[i], main_model_p->R, main_model_p->fc_comm[i + j * main_model_p->dim_fc_comm_1], main_model_p->fP_comm[i], main_model_p->n_comm[i + j * main_model_p->dim_n_comm_1], main_model_p->eP1c[i], main_model_p->ec[i], main_model_p->fc_noncomm[i + j * main_model_p->dim_fc_noncomm_1], main_model_p->fP_noncomm[i], main_model_p->n_noncomm[i + j * main_model_p->dim_n_noncomm_1], main_model_p->c_noncomm_balanced[i], main_model_p->p_noncomm[i + j * main_model_p->dim_p_noncomm_1], main_model_p->infect_ART, main_model_p->infect_acute, main_model_p->infect_AIDS, main_model_p->beta_noncomm[i]));
    }
  }
  for (int i = 0; i < main_model_p->dim_lambda_1d_1; ++i) {
    for (int j = 0; j < main_model_p->dim_lambda_1d_2; ++j) {
      main_model_p->lambda_1d[i + j * main_model_p->dim_lambda_1d_1] = (i == j ? 0 : compute_lambda(main_model_p->c_comm_balanced[i], main_model_p->p_comm[i + j * main_model_p->dim_p_comm_1], S0[j], S1a[j], S1b[j], S1c[j], I01[j], I11[j], I02[j], I03[j], I04[j], I05[j], I22[j], I23[j], I24[j], I25[j], I32[j], I33[j], I34[j], I35[j], I42[j], I43[j], I44[j], I45[j], main_model_p->N[j], main_model_p->beta_comm[i], main_model_p->R, main_model_p->fc_comm[i + j * main_model_p->dim_fc_comm_1], main_model_p->fP_comm[i], main_model_p->n_comm[i + j * main_model_p->dim_n_comm_1], main_model_p->eP1d[i], main_model_p->ec[i], main_model_p->fc_noncomm[i + j * main_model_p->dim_fc_noncomm_1], main_model_p->fP_noncomm[i], main_model_p->n_noncomm[i + j * main_model_p->dim_n_noncomm_1], main_model_p->c_noncomm_balanced[i], main_model_p->p_noncomm[i + j * main_model_p->dim_p_noncomm_1], main_model_p->infect_ART, main_model_p->infect_acute, main_model_p->infect_AIDS, main_model_p->beta_noncomm[i]));
    }
  }
  for (int i = 0; i < main_model_p->dim_lambda_sum_0; ++i) {
    main_model_p->lambda_sum_0[i] = odin_sum2(main_model_p->lambda_0, i, i, 0, main_model_p->dim_lambda_0_2 - 1, main_model_p->dim_lambda_0_1);
  }
  for (int i = 0; i < main_model_p->dim_lambda_sum_1a; ++i) {
    main_model_p->lambda_sum_1a[i] = odin_sum2(main_model_p->lambda_1a, i, i, 0, main_model_p->dim_lambda_1a_2 - 1, main_model_p->dim_lambda_1a_1);
  }
  for (int i = 0; i < main_model_p->dim_S1a; ++i) {
    deriv_S1a[i] = main_model_p->E1a[i] - S1a[i] * main_model_p->lambda_sum_1a[i] - S1a[i] * main_model_p->mu[i];
  }
  for (int i = 0; i < main_model_p->dim_lambda_sum_1b; ++i) {
    main_model_p->lambda_sum_1b[i] = odin_sum2(main_model_p->lambda_1b, i, i, 0, main_model_p->dim_lambda_1b_2 - 1, main_model_p->dim_lambda_1b_1);
  }
  for (int i = 0; i < main_model_p->dim_S1b; ++i) {
    deriv_S1b[i] = main_model_p->E1b[i] - S1b[i] * main_model_p->lambda_sum_1b[i] - S1b[i] * main_model_p->mu[i];
  }
  for (int i = 0; i < main_model_p->dim_lambda_sum_1c; ++i) {
    main_model_p->lambda_sum_1c[i] = odin_sum2(main_model_p->lambda_1c, i, i, 0, main_model_p->dim_lambda_1c_2 - 1, main_model_p->dim_lambda_1c_1);
  }
  for (int i = 0; i < main_model_p->dim_S1c; ++i) {
    deriv_S1c[i] = main_model_p->E1c[i] - S1c[i] * main_model_p->lambda_sum_1c[i] - S1c[i] * main_model_p->mu[i];
  }
  for (int i = 0; i < main_model_p->dim_lambda_sum_1d; ++i) {
    main_model_p->lambda_sum_1d[i] = odin_sum2(main_model_p->lambda_1d, i, i, 0, main_model_p->dim_lambda_1d_2 - 1, main_model_p->dim_lambda_1d_1);
  }
  for (int i = 0; i < main_model_p->dim_S1d; ++i) {
    deriv_S1d[i] = main_model_p->E1d[i] - S1d[i] * main_model_p->lambda_sum_1d[i] - S1d[i] * main_model_p->mu[i];
  }
  for (int i = 0; i < main_model_p->dim_cumuInf; ++i) {
    deriv_cumuInf[i] = S0[i] * main_model_p->lambda_sum_0[i] + S1a[i] * main_model_p->lambda_sum_1a[i] + S1b[i] * main_model_p->lambda_sum_1b[i] + S1c[i] * main_model_p->lambda_sum_1c[i] + S1d[i] * main_model_p->lambda_sum_1d[i];
  }
  for (int i = 0; i < main_model_p->dim_in_S0_1; ++i) {
    for (int j = 0; j < main_model_p->dim_in_S0_2; ++j) {
      main_model_p->in_S0[i + j * main_model_p->dim_in_S0_1] = (i == j ? 0 : main_model_p->rate_move_in[i + j * main_model_p->dim_rate_move_in_1] * S0[j]);
    }
  }
  for (int i = 0; i < main_model_p->dim_in_I01_1; ++i) {
    for (int j = 0; j < main_model_p->dim_in_I01_2; ++j) {
      main_model_p->in_I01[i + j * main_model_p->dim_in_I01_1] = (i == j ? 0 : main_model_p->rate_move_in[i + j * main_model_p->dim_rate_move_in_1] * I01[j]);
    }
  }
  for (int i = 0; i < main_model_p->dim_in_I11_1; ++i) {
    for (int j = 0; j < main_model_p->dim_in_I11_2; ++j) {
      main_model_p->in_I11[i + j * main_model_p->dim_in_I11_1] = (i == j ? 0 : main_model_p->rate_move_in[i + j * main_model_p->dim_rate_move_in_1] * I11[j]);
    }
  }
  for (int i = 0; i < main_model_p->dim_in_I02_1; ++i) {
    for (int j = 0; j < main_model_p->dim_in_I02_2; ++j) {
      main_model_p->in_I02[i + j * main_model_p->dim_in_I02_1] = (i == j ? 0 : main_model_p->rate_move_in[i + j * main_model_p->dim_rate_move_in_1] * I02[j]);
    }
  }
  for (int i = 0; i < main_model_p->dim_in_I03_1; ++i) {
    for (int j = 0; j < main_model_p->dim_in_I03_2; ++j) {
      main_model_p->in_I03[i + j * main_model_p->dim_in_I03_1] = (i == j ? 0 : main_model_p->rate_move_in[i + j * main_model_p->dim_rate_move_in_1] * I03[j]);
    }
  }
  for (int i = 0; i < main_model_p->dim_in_I04_1; ++i) {
    for (int j = 0; j < main_model_p->dim_in_I04_2; ++j) {
      main_model_p->in_I04[i + j * main_model_p->dim_in_I04_1] = (i == j ? 0 : main_model_p->rate_move_in[i + j * main_model_p->dim_rate_move_in_1] * I04[j]);
    }
  }
  for (int i = 0; i < main_model_p->dim_in_I05_1; ++i) {
    for (int j = 0; j < main_model_p->dim_in_I05_2; ++j) {
      main_model_p->in_I05[i + j * main_model_p->dim_in_I05_1] = (i == j ? 0 : main_model_p->rate_move_in[i + j * main_model_p->dim_rate_move_in_1] * I05[j]);
    }
  }
  for (int i = 0; i < main_model_p->dim_in_I22_1; ++i) {
    for (int j = 0; j < main_model_p->dim_in_I22_2; ++j) {
      main_model_p->in_I22[i + j * main_model_p->dim_in_I22_1] = (i == j ? 0 : main_model_p->rate_move_in[i + j * main_model_p->dim_rate_move_in_1] * I22[j]);
    }
  }
  for (int i = 0; i < main_model_p->dim_in_I23_1; ++i) {
    for (int j = 0; j < main_model_p->dim_in_I23_2; ++j) {
      main_model_p->in_I23[i + j * main_model_p->dim_in_I23_1] = (i == j ? 0 : main_model_p->rate_move_in[i + j * main_model_p->dim_rate_move_in_1] * I23[j]);
    }
  }
  for (int i = 0; i < main_model_p->dim_in_I24_1; ++i) {
    for (int j = 0; j < main_model_p->dim_in_I24_2; ++j) {
      main_model_p->in_I24[i + j * main_model_p->dim_in_I24_1] = (i == j ? 0 : main_model_p->rate_move_in[i + j * main_model_p->dim_rate_move_in_1] * I24[j]);
    }
  }
  for (int i = 0; i < main_model_p->dim_in_I25_1; ++i) {
    for (int j = 0; j < main_model_p->dim_in_I25_2; ++j) {
      main_model_p->in_I25[i + j * main_model_p->dim_in_I25_1] = (i == j ? 0 : main_model_p->rate_move_in[i + j * main_model_p->dim_rate_move_in_1] * I25[j]);
    }
  }
  for (int i = 0; i < main_model_p->dim_in_I32_1; ++i) {
    for (int j = 0; j < main_model_p->dim_in_I32_2; ++j) {
      main_model_p->in_I32[i + j * main_model_p->dim_in_I32_1] = (i == j ? 0 : main_model_p->rate_move_in[i + j * main_model_p->dim_rate_move_in_1] * I32[j]);
    }
  }
  for (int i = 0; i < main_model_p->dim_in_I33_1; ++i) {
    for (int j = 0; j < main_model_p->dim_in_I33_2; ++j) {
      main_model_p->in_I33[i + j * main_model_p->dim_in_I33_1] = (i == j ? 0 : main_model_p->rate_move_in[i + j * main_model_p->dim_rate_move_in_1] * I33[j]);
    }
  }
  for (int i = 0; i < main_model_p->dim_in_I34_1; ++i) {
    for (int j = 0; j < main_model_p->dim_in_I34_2; ++j) {
      main_model_p->in_I34[i + j * main_model_p->dim_in_I34_1] = (i == j ? 0 : main_model_p->rate_move_in[i + j * main_model_p->dim_rate_move_in_1] * I34[j]);
    }
  }
  for (int i = 0; i < main_model_p->dim_in_I35_1; ++i) {
    for (int j = 0; j < main_model_p->dim_in_I35_2; ++j) {
      main_model_p->in_I35[i + j * main_model_p->dim_in_I35_1] = (i == j ? 0 : main_model_p->rate_move_in[i + j * main_model_p->dim_rate_move_in_1] * I35[j]);
    }
  }
  for (int i = 0; i < main_model_p->dim_in_I42_1; ++i) {
    for (int j = 0; j < main_model_p->dim_in_I42_2; ++j) {
      main_model_p->in_I42[i + j * main_model_p->dim_in_I42_1] = (i == j ? 0 : main_model_p->rate_move_in[i + j * main_model_p->dim_rate_move_in_1] * I42[j]);
    }
  }
  for (int i = 0; i < main_model_p->dim_in_I43_1; ++i) {
    for (int j = 0; j < main_model_p->dim_in_I43_2; ++j) {
      main_model_p->in_I43[i + j * main_model_p->dim_in_I43_1] = (i == j ? 0 : main_model_p->rate_move_in[i + j * main_model_p->dim_rate_move_in_1] * I43[j]);
    }
  }
  for (int i = 0; i < main_model_p->dim_in_I44_1; ++i) {
    for (int j = 0; j < main_model_p->dim_in_I44_2; ++j) {
      main_model_p->in_I44[i + j * main_model_p->dim_in_I44_1] = (i == j ? 0 : main_model_p->rate_move_in[i + j * main_model_p->dim_rate_move_in_1] * I44[j]);
    }
  }
  for (int i = 0; i < main_model_p->dim_in_I45_1; ++i) {
    for (int j = 0; j < main_model_p->dim_in_I45_2; ++j) {
      main_model_p->in_I45[i + j * main_model_p->dim_in_I45_1] = (i == j ? 0 : main_model_p->rate_move_in[i + j * main_model_p->dim_rate_move_in_1] * I45[j]);
    }
  }
  for (int i = 0; i < main_model_p->dim_S0; ++i) {
    deriv_S0[i] = main_model_p->E0[i] - S0[i] * main_model_p->lambda_sum_0[i] - S0[i] * main_model_p->mu[i] + main_model_p->rate_move_out[i] * S0[i] + odin_sum2(main_model_p->in_S0, i, i, 0, main_model_p->dim_in_S0_2 - 1, main_model_p->dim_in_S0_1);
  }
  for (int i = 0; i < main_model_p->dim_I01; ++i) {
    deriv_I01[i] = S0[i] * main_model_p->lambda_sum_0[i] - I01[i] * (main_model_p->gamma01[i] + main_model_p->tau[i] + main_model_p->alpha01[i] + main_model_p->mu[i]) + main_model_p->rate_move_out[i] * I01[i] + odin_sum2(main_model_p->in_I01, i, i, 0, main_model_p->dim_in_I01_2 - 1, main_model_p->dim_in_I01_1);
  }
  for (int i = 0; i < main_model_p->dim_I11; ++i) {
    deriv_I11[i] = S1a[i] * main_model_p->lambda_sum_1a[i] + S1b[i] * main_model_p->lambda_sum_1b[i] + S1c[i] * main_model_p->lambda_sum_1c[i] - I11[i] * (main_model_p->gamma11[i] + main_model_p->RR_test_onPrEP * main_model_p->tau[i] + main_model_p->alpha11[i] + main_model_p->mu[i]) + main_model_p->rate_move_out[i] * I11[i] + odin_sum2(main_model_p->in_I11, i, i, 0, main_model_p->dim_in_I11_2 - 1, main_model_p->dim_in_I11_1);
  }
  for (int i = 0; i < main_model_p->dim_I02; ++i) {
    deriv_I02[i] = main_model_p->gamma01[i] * I01[i] + main_model_p->gamma11[i] * I11[i] - I02[i] * (main_model_p->gamma02[i] + main_model_p->tau[i] + main_model_p->alpha02[i] + main_model_p->mu[i]) + main_model_p->rate_move_out[i] * I02[i] + odin_sum2(main_model_p->in_I02, i, i, 0, main_model_p->dim_in_I02_2 - 1, main_model_p->dim_in_I02_1);
  }
  for (int i = 0; i < main_model_p->dim_I03; ++i) {
    deriv_I03[i] = main_model_p->gamma02[i] * I02[i] - I03[i] * (main_model_p->gamma03[i] + main_model_p->tau[i] + main_model_p->alpha03[i] + main_model_p->mu[i]) + main_model_p->rate_move_out[i] * I03[i] + odin_sum2(main_model_p->in_I03, i, i, 0, main_model_p->dim_in_I03_2 - 1, main_model_p->dim_in_I03_1);
  }
  for (int i = 0; i < main_model_p->dim_I04; ++i) {
    deriv_I04[i] = main_model_p->gamma03[i] * I03[i] - I04[i] * (main_model_p->gamma04[i] + main_model_p->tau[i] + main_model_p->alpha04[i] + main_model_p->mu[i]) + main_model_p->rate_move_out[i] * I04[i] + odin_sum2(main_model_p->in_I04, i, i, 0, main_model_p->dim_in_I04_2 - 1, main_model_p->dim_in_I04_1);
  }
  for (int i = 0; i < main_model_p->dim_I05; ++i) {
    deriv_I05[i] = main_model_p->gamma04[i] * I04[i] - I05[i] * (main_model_p->RR_test_CD4200 * main_model_p->tau[i] + main_model_p->alpha05[i] + main_model_p->mu[i]) + main_model_p->rate_move_out[i] * I05[i] + odin_sum2(main_model_p->in_I05, i, i, 0, main_model_p->dim_in_I05_2 - 1, main_model_p->dim_in_I05_1);
  }
  for (int i = 0; i < main_model_p->dim_I22; ++i) {
    deriv_I22[i] = main_model_p->tau[i] * I01[i] + main_model_p->RR_test_onPrEP * main_model_p->tau[i] * I11[i] + main_model_p->tau[i] * I02[i] - I22[i] * (main_model_p->gamma22[i] + main_model_p->rho[i] + main_model_p->alpha22[i] + main_model_p->mu[i]) + main_model_p->rate_move_out[i] * I22[i] + odin_sum2(main_model_p->in_I22, i, i, 0, main_model_p->dim_in_I22_2 - 1, main_model_p->dim_in_I22_1);
  }
  for (int i = 0; i < main_model_p->dim_I23; ++i) {
    deriv_I23[i] = main_model_p->gamma22[i] * I22[i] + main_model_p->tau[i] * I03[i] - I23[i] * (main_model_p->gamma23[i] + main_model_p->rho[i] + main_model_p->alpha23[i] + main_model_p->mu[i]) + main_model_p->rate_move_out[i] * I23[i] + odin_sum2(main_model_p->in_I23, i, i, 0, main_model_p->dim_in_I23_2 - 1, main_model_p->dim_in_I23_1);
  }
  for (int i = 0; i < main_model_p->dim_I24; ++i) {
    deriv_I24[i] = main_model_p->gamma23[i] * I23[i] + main_model_p->tau[i] * I04[i] - I24[i] * (main_model_p->gamma24[i] + main_model_p->rho[i] + main_model_p->alpha24[i] + main_model_p->mu[i]) + main_model_p->rate_move_out[i] * I24[i] + odin_sum2(main_model_p->in_I24, i, i, 0, main_model_p->dim_in_I24_2 - 1, main_model_p->dim_in_I24_1);
  }
  for (int i = 0; i < main_model_p->dim_I25; ++i) {
    deriv_I25[i] = main_model_p->gamma24[i] * I24[i] + main_model_p->RR_test_CD4200 * main_model_p->tau[i] * I05[i] - I25[i] * (main_model_p->RR_ART_CD4200 * main_model_p->rho[i] + main_model_p->alpha25[i] + main_model_p->mu[i]) + main_model_p->rate_move_out[i] * I25[i] + odin_sum2(main_model_p->in_I25, i, i, 0, main_model_p->dim_in_I25_2 - 1, main_model_p->dim_in_I25_1);
  }
  for (int i = 0; i < main_model_p->dim_I32; ++i) {
    deriv_I32[i] = main_model_p->rho[i] * (I22[i] + I42[i]) - I32[i] * (main_model_p->gamma32[i] + main_model_p->phi2[i] + main_model_p->alpha32[i] + main_model_p->mu[i]) + main_model_p->rate_move_out[i] * I32[i] + odin_sum2(main_model_p->in_I32, i, i, 0, main_model_p->dim_in_I32_2 - 1, main_model_p->dim_in_I32_1);
  }
  for (int i = 0; i < main_model_p->dim_I33; ++i) {
    deriv_I33[i] = main_model_p->gamma32[i] * I32[i] + main_model_p->rho[i] * (I23[i] + I43[i]) - I33[i] * (main_model_p->gamma33[i] + main_model_p->phi3[i] + main_model_p->alpha33[i] + main_model_p->mu[i]) + main_model_p->rate_move_out[i] * I33[i] + odin_sum2(main_model_p->in_I33, i, i, 0, main_model_p->dim_in_I33_2 - 1, main_model_p->dim_in_I33_1);
  }
  for (int i = 0; i < main_model_p->dim_I34; ++i) {
    deriv_I34[i] = main_model_p->gamma33[i] * I33[i] + main_model_p->rho[i] * (I24[i] + I44[i]) - I34[i] * (main_model_p->gamma34[i] + main_model_p->phi4[i] + main_model_p->alpha34[i] + main_model_p->mu[i]) + main_model_p->rate_move_out[i] * I34[i] + odin_sum2(main_model_p->in_I34, i, i, 0, main_model_p->dim_in_I34_2 - 1, main_model_p->dim_in_I34_1);
  }
  for (int i = 0; i < main_model_p->dim_I35; ++i) {
    deriv_I35[i] = main_model_p->gamma34[i] * I34[i] + main_model_p->RR_ART_CD4200 * main_model_p->rho[i] * (I25[i] + I45[i]) - I35[i] * (main_model_p->phi5[i] + main_model_p->alpha35[i] + main_model_p->mu[i]) + main_model_p->rate_move_out[i] * I35[i] + odin_sum2(main_model_p->in_I35, i, i, 0, main_model_p->dim_in_I35_2 - 1, main_model_p->dim_in_I35_1);
  }
  for (int i = 0; i < main_model_p->dim_I42; ++i) {
    deriv_I42[i] = main_model_p->phi2[i] * I32[i] - I42[i] * (main_model_p->gamma42[i] + main_model_p->rho[i] + main_model_p->alpha42[i] + main_model_p->mu[i]) + main_model_p->rate_move_out[i] * I42[i] + odin_sum2(main_model_p->in_I42, i, i, 0, main_model_p->dim_in_I42_2 - 1, main_model_p->dim_in_I42_1);
  }
  for (int i = 0; i < main_model_p->dim_I43; ++i) {
    deriv_I43[i] = main_model_p->gamma42[i] * I42[i] + main_model_p->phi3[i] * I33[i] - I43[i] * (main_model_p->gamma43[i] + main_model_p->rho[i] + main_model_p->alpha43[i] + main_model_p->mu[i]) + main_model_p->rate_move_out[i] * I43[i] + odin_sum2(main_model_p->in_I43, i, i, 0, main_model_p->dim_in_I43_2 - 1, main_model_p->dim_in_I43_1);
  }
  for (int i = 0; i < main_model_p->dim_I44; ++i) {
    deriv_I44[i] = main_model_p->gamma43[i] * I43[i] + main_model_p->phi4[i] * I34[i] - I44[i] * (main_model_p->gamma44[i] + main_model_p->rho[i] + main_model_p->alpha44[i] + main_model_p->mu[i]) + main_model_p->rate_move_out[i] * I44[i] + odin_sum2(main_model_p->in_I44, i, i, 0, main_model_p->dim_in_I44_2 - 1, main_model_p->dim_in_I44_1);
  }
  for (int i = 0; i < main_model_p->dim_I45; ++i) {
    deriv_I45[i] = main_model_p->gamma44[i] * I44[i] + main_model_p->phi5[i] * I35[i] - I45[i] * (main_model_p->RR_ART_CD4200 * main_model_p->rho[i] + main_model_p->alpha45[i] + main_model_p->mu[i]) + main_model_p->rate_move_out[i] * I45[i] + odin_sum2(main_model_p->in_I45, i, i, 0, main_model_p->dim_in_I45_2 - 1, main_model_p->dim_in_I45_1);
  }
  if (output != NULL) {
    double *output_c_comm = output + 21;
    double *output_c_noncomm = output + main_model_p->offset_output_c_noncomm;
    double *output_new_people_in_group = output + main_model_p->offset_output_new_people_in_group;
    double *output_testing_prob = output + main_model_p->offset_output_testing_prob;
    double *output_ART_prob = output + main_model_p->offset_output_ART_prob;
    double *output_tau = output + main_model_p->offset_output_tau;
    double *output_rho = output + main_model_p->offset_output_rho;
    double *output_frac_F = output + main_model_p->offset_output_frac_F;
    double *output_frac_N_sexualpop = output + main_model_p->offset_output_frac_N_sexualpop;
    double *output_zetaa = output + main_model_p->offset_output_zetaa;
    double *output_zetab = output + main_model_p->offset_output_zetab;
    double *output_zetac = output + main_model_p->offset_output_zetac;
    double *output_omega = output + main_model_p->offset_output_omega;
    double *output_frac_N = output + main_model_p->offset_output_frac_N;
    double *output_mu = output + main_model_p->offset_output_mu;
    double *output_gamma01 = output + main_model_p->offset_output_gamma01;
    double *output_kappaa = output + main_model_p->offset_output_kappaa;
    double *output_kappab = output + main_model_p->offset_output_kappab;
    double *output_kappac = output + main_model_p->offset_output_kappac;
    double *output_alpha05 = output + main_model_p->offset_output_alpha05;
    double *output_alpha35 = output + main_model_p->offset_output_alpha35;
    double *output_beta_comm = output + main_model_p->offset_output_beta_comm;
    double *output_beta_noncomm = output + main_model_p->offset_output_beta_noncomm;
    double *output_p_comm = output + main_model_p->offset_output_p_comm;
    double *output_p_noncomm = output + main_model_p->offset_output_p_noncomm;
    double *output_fc_comm = output + main_model_p->offset_output_fc_comm;
    double *output_fP_comm = output + main_model_p->offset_output_fP_comm;
    double *output_fc_noncomm = output + main_model_p->offset_output_fc_noncomm;
    double *output_fP_noncomm = output + main_model_p->offset_output_fP_noncomm;
    double *output_n_comm = output + main_model_p->offset_output_n_comm;
    double *output_n_noncomm = output + main_model_p->offset_output_n_noncomm;
    double *output_N = output + main_model_p->offset_output_N;
    double *output_E0 = output + main_model_p->offset_output_E0;
    double *output_E1a = output + main_model_p->offset_output_E1a;
    double *output_E1b = output + main_model_p->offset_output_E1b;
    double *output_E1c = output + main_model_p->offset_output_E1c;
    double *output_E1d = output + main_model_p->offset_output_E1d;
    double *output_alphaItot = output + main_model_p->offset_output_alphaItot;
    double *output_prev = output + main_model_p->offset_output_prev;
    double *output_lambda = output + main_model_p->offset_output_lambda;
    double *output_lambda_0 = output + main_model_p->offset_output_lambda_0;
    double *output_lambda_1a = output + main_model_p->offset_output_lambda_1a;
    double *output_lambda_1b = output + main_model_p->offset_output_lambda_1b;
    double *output_lambda_1c = output + main_model_p->offset_output_lambda_1c;
    double *output_lambda_1d = output + main_model_p->offset_output_lambda_1d;
    double *output_lambda_sum_0 = output + main_model_p->offset_output_lambda_sum_0;
    double *output_lambda_sum_1a = output + main_model_p->offset_output_lambda_sum_1a;
    double *output_lambda_sum_1b = output + main_model_p->offset_output_lambda_sum_1b;
    double *output_lambda_sum_1c = output + main_model_p->offset_output_lambda_sum_1c;
    double *output_lambda_sum_1d = output + main_model_p->offset_output_lambda_sum_1d;
    double *output_c_comm_balanced = output + main_model_p->offset_output_c_comm_balanced;
    double *output_c_noncomm_balanced = output + main_model_p->offset_output_c_noncomm_balanced;
    double *output_theta = output + main_model_p->offset_output_theta;
    double *output_M_comm = output + main_model_p->offset_output_M_comm;
    double *output_M_noncomm = output + main_model_p->offset_output_M_noncomm;
    double *output_sum_in_S0 = output + main_model_p->offset_output_sum_in_S0;
    double *output_rate_move_in = output + main_model_p->offset_output_rate_move_in;
    double *output_rate_move_out = output + main_model_p->offset_output_rate_move_out;
    output[0] = main_model_p->who_believe_comm;
    memcpy(output_testing_prob, main_model_p->testing_prob, main_model_p->dim_testing_prob * sizeof(double));
    memcpy(output_ART_prob, main_model_p->ART_prob, main_model_p->dim_ART_prob * sizeof(double));
    memcpy(output_tau, main_model_p->tau, main_model_p->dim_tau * sizeof(double));
    memcpy(output_rho, main_model_p->rho, main_model_p->dim_rho * sizeof(double));
    double cumuInftot = odin_sum1(cumuInf, 0, main_model_p->dim_cumuInf - 1);
    output[1] = cumuInftot;
    double ART_coverage_men = (I32[4] + I33[4] + I34[4] + I35[4] + I32[5] + I33[5] + I34[5] + I35[5]) / (I01[4] + I11[4] + I02[4] + I03[4] + I04[4] + I05[4] + I22[4] + I23[4] + I24[4] + I25[4] + I32[4] + I33[4] + I34[4] + I35[4] + I42[4] + I43[4] + I44[4] + I45[4] + I01[5] + I11[5] + I02[5] + I03[5] + I04[5] + I05[5] + I22[5] + I23[5] + I24[5] + I25[5] + I32[5] + I33[5] + I34[5] + I35[5] + I42[5] + I43[5] + I44[5] + I45[5]);
    double ART_coverage_women = (I32[0] + I33[0] + I34[0] + I35[0] + I32[1] + I33[1] + I34[1] + I35[1] + I32[2] + I33[2] + I34[2] + I35[2] + I32[3] + I33[3] + I34[3] + I35[3]) / (I01[0] + I11[0] + I02[0] + I03[0] + I04[0] + I05[0] + I22[0] + I23[0] + I24[0] + I25[0] + I32[0] + I33[0] + I34[0] + I35[0] + I42[0] + I43[0] + I44[0] + I45[0] + I01[1] + I11[1] + I02[1] + I03[1] + I04[1] + I05[1] + I22[1] + I23[1] + I24[1] + I25[1] + I32[1] + I33[1] + I34[1] + I35[1] + I42[1] + I43[1] + I44[1] + I45[1] + I01[2] + I11[2] + I02[2] + I03[2] + I04[2] + I05[2] + I22[2] + I23[2] + I24[2] + I25[2] + I32[2] + I33[2] + I34[2] + I35[2] + I42[2] + I43[2] + I44[2] + I45[2] + I01[3] + I11[3] + I02[3] + I03[3] + I04[3] + I05[3] + I22[3] + I23[3] + I24[3] + I25[3] + I32[3] + I33[3] + I34[3] + I35[3] + I42[3] + I43[3] + I44[3] + I45[3]);
    double ART_coverage_FSW = (I32[0] + I33[0] + I34[0] + I35[0]) / (I01[0] + I11[0] + I02[0] + I03[0] + I04[0] + I05[0] + I22[0] + I23[0] + I24[0] + I25[0] + I32[0] + I33[0] + I34[0] + I35[0] + I42[0] + I43[0] + I44[0] + I45[0]);
    double ART_coverage_all = (I32[0] + I33[0] + I34[0] + I35[0] + I32[1] + I33[1] + I34[1] + I35[1] + I32[2] + I33[2] + I34[2] + I35[2] + I32[3] + I33[3] + I34[3] + I35[3] + I32[4] + I33[4] + I34[4] + I35[4] + I32[5] + I33[5] + I34[5] + I35[5]) / (I01[0] + I11[0] + I02[0] + I03[0] + I04[0] + I05[0] + I22[0] + I23[0] + I24[0] + I25[0] + I32[0] + I33[0] + I34[0] + I35[0] + I42[0] + I43[0] + I44[0] + I45[0] + I01[1] + I11[1] + I02[1] + I03[1] + I04[1] + I05[1] + I22[1] + I23[1] + I24[1] + I25[1] + I32[1] + I33[1] + I34[1] + I35[1] + I42[1] + I43[1] + I44[1] + I45[1] + I01[2] + I11[2] + I02[2] + I03[2] + I04[2] + I05[2] + I22[2] + I23[2] + I24[2] + I25[2] + I32[2] + I33[2] + I34[2] + I35[2] + I42[2] + I43[2] + I44[2] + I45[2] + I01[3] + I11[3] + I02[3] + I03[3] + I04[3] + I05[3] + I22[3] + I23[3] + I24[3] + I25[3] + I32[3] + I33[3] + I34[3] + I35[3] + I42[3] + I43[3] + I44[3] + I45[3] + I01[4] + I11[4] + I02[4] + I03[4] + I04[4] + I05[4] + I22[4] + I23[4] + I24[4] + I25[4] + I32[4] + I33[4] + I34[4] + I35[4] + I42[4] + I43[4] + I44[4] + I45[4] + I01[5] + I11[5] + I02[5] + I03[5] + I04[5] + I05[5] + I22[5] + I23[5] + I24[5] + I25[5] + I32[5] + I33[5] + I34[5] + I35[5] + I42[5] + I43[5] + I44[5] + I45[5]);
    output[2] = ART_coverage_men;
    output[3] = ART_coverage_women;
    output[4] = ART_coverage_FSW;
    output[5] = ART_coverage_all;
    output[6] = main_model_p->Ncat;
    memcpy(output_c_comm, main_model_p->c_comm, main_model_p->dim_c_comm * sizeof(double));
    memcpy(output_c_noncomm, main_model_p->c_noncomm, main_model_p->dim_c_noncomm * sizeof(double));
    output[7] = main_model_p->Nage;
    output[8] = main_model_p->dur_FSW;
    output[9] = main_model_p->epsilon;
    memcpy(output_zetaa, main_model_p->zetaa, main_model_p->dim_zetaa * sizeof(double));
    memcpy(output_zetab, main_model_p->zetab, main_model_p->dim_zetab * sizeof(double));
    memcpy(output_zetac, main_model_p->zetac, main_model_p->dim_zetac * sizeof(double));
    memcpy(output_omega, main_model_p->omega, main_model_p->dim_omega * sizeof(double));
    memcpy(output_mu, main_model_p->mu, main_model_p->dim_mu * sizeof(double));
    memcpy(output_gamma01, main_model_p->gamma01, main_model_p->dim_gamma01 * sizeof(double));
    memcpy(output_kappaa, main_model_p->kappaa, main_model_p->dim_kappaa * sizeof(double));
    memcpy(output_kappab, main_model_p->kappab, main_model_p->dim_kappab * sizeof(double));
    memcpy(output_kappac, main_model_p->kappac, main_model_p->dim_kappac * sizeof(double));
    memcpy(output_alpha05, main_model_p->alpha05, main_model_p->dim_alpha05 * sizeof(double));
    memcpy(output_alpha35, main_model_p->alpha35, main_model_p->dim_alpha35 * sizeof(double));
    memcpy(output_beta_comm, main_model_p->beta_comm, main_model_p->dim_beta_comm * sizeof(double));
    memcpy(output_beta_noncomm, main_model_p->beta_noncomm, main_model_p->dim_beta_noncomm * sizeof(double));
    memcpy(output_fc_comm, main_model_p->fc_comm, main_model_p->dim_fc_comm * sizeof(double));
    memcpy(output_fP_comm, main_model_p->fP_comm, main_model_p->dim_fP_comm * sizeof(double));
    memcpy(output_fc_noncomm, main_model_p->fc_noncomm, main_model_p->dim_fc_noncomm * sizeof(double));
    memcpy(output_fP_noncomm, main_model_p->fP_noncomm, main_model_p->dim_fP_noncomm * sizeof(double));
    memcpy(output_n_comm, main_model_p->n_comm, main_model_p->dim_n_comm * sizeof(double));
    memcpy(output_n_noncomm, main_model_p->n_noncomm, main_model_p->dim_n_noncomm * sizeof(double));
    double Ntot = (main_model_p->Ncat == 9 ? (main_model_p->N[0] + main_model_p->N[1] + main_model_p->N[2] + main_model_p->N[3] + main_model_p->N[4] + main_model_p->N[5] + main_model_p->N[6] + main_model_p->N[7]) : odin_sum1(main_model_p->N, 0, main_model_p->dim_N - 1));
    output[10] = Ntot_inc_former_FSW_nonCot;
    for (int i = 0; i < main_model_p->dim_new_people_in_group; ++i) {
      main_model_p->new_people_in_group[i] = new_people * main_model_p->omega[i];
    }
    memcpy(output_new_people_in_group, main_model_p->new_people_in_group, main_model_p->dim_new_people_in_group * sizeof(double));
    for (int i = 0; i < main_model_p->dim_frac_N; ++i) {
      main_model_p->frac_N[i] = main_model_p->N[i] / Ntot_inc_former_FSW_nonCot;
    }
    for (int i = 0; i < main_model_p->dim_frac_F; ++i) {
      main_model_p->frac_F[i] = (main_model_p->Ncat == 9 ? (main_model_p->N[0] + main_model_p->N[1] + main_model_p->N[2] + main_model_p->N[3] + main_model_p->N[6] + main_model_p->N[8]) / Ntot_inc_former_FSW_nonCot : 0);
    }
    for (int i = 0; i < main_model_p->dim_frac_N_sexualpop; ++i) {
      main_model_p->frac_N_sexualpop[i] = (main_model_p->Ncat == 9 ? main_model_p->N[i] / (main_model_p->N[0] + main_model_p->N[1] + main_model_p->N[2] + main_model_p->N[3] + main_model_p->N[4] + main_model_p->N[5]) : 0);
    }
    double frac_virgin = (main_model_p->Ncat == 9 ? (main_model_p->N[6] + main_model_p->N[7]) / (main_model_p->N[0] + main_model_p->N[1] + main_model_p->N[2] + main_model_p->N[3] + main_model_p->N[4] + main_model_p->N[5] + main_model_p->N[6] + main_model_p->N[7]) : 0);
    output[11] = frac_virgin;
    memcpy(output_frac_F, main_model_p->frac_F, main_model_p->dim_frac_F * sizeof(double));
    memcpy(output_frac_N_sexualpop, main_model_p->frac_N_sexualpop, main_model_p->dim_frac_N_sexualpop * sizeof(double));
    double prev_FSW = 100 * (I01[0] + I11[0] + I02[0] + I03[0] + I04[0] + I05[0] + I22[0] + I23[0] + I24[0] + I25[0] + I32[0] + I33[0] + I34[0] + I35[0] + I42[0] + I43[0] + I44[0] + I45[0]) / main_model_p->N[0];
    double prev_LowFSW = 100 * (I01[1] + I11[1] + I02[1] + I03[1] + I04[1] + I05[1] + I22[1] + I23[1] + I24[1] + I25[1] + I32[1] + I33[1] + I34[1] + I35[1] + I42[1] + I43[1] + I44[1] + I45[1]) / main_model_p->N[1];
    output[12] = prev_LowFSW;
    double prev_client = 100 * (I01[4] + I11[4] + I02[4] + I03[4] + I04[4] + I05[4] + I22[4] + I23[4] + I24[4] + I25[4] + I32[4] + I33[4] + I34[4] + I35[4] + I42[4] + I43[4] + I44[4] + I45[4]) / main_model_p->N[4];
    double prev_men = 100 * (I01[4] + I11[4] + I02[4] + I03[4] + I04[4] + I05[4] + I22[4] + I23[4] + I24[4] + I25[4] + I32[4] + I33[4] + I34[4] + I35[4] + I42[4] + I43[4] + I44[4] + I45[4] + I01[5] + I11[5] + I02[5] + I03[5] + I04[5] + I05[5] + I22[5] + I23[5] + I24[5] + I25[5] + I32[5] + I33[5] + I34[5] + I35[5] + I42[5] + I43[5] + I44[5] + I45[5] + I01[7] + I11[7] + I02[7] + I03[7] + I04[7] + I05[7] + I22[7] + I23[7] + I24[7] + I25[7] + I32[7] + I33[7] + I34[7] + I35[7] + I42[7] + I43[7] + I44[7] + I45[7]) / (main_model_p->N[4] + main_model_p->N[5] + main_model_p->N[7]);
    double prev_women = 100 * (I01[0] + I11[0] + I02[0] + I03[0] + I04[0] + I05[0] + I22[0] + I23[0] + I24[0] + I25[0] + I32[0] + I33[0] + I34[0] + I35[0] + I42[0] + I43[0] + I44[0] + I45[0] + I01[1] + I11[1] + I02[1] + I03[1] + I04[1] + I05[1] + I22[1] + I23[1] + I24[1] + I25[1] + I32[1] + I33[1] + I34[1] + I35[1] + I42[1] + I43[1] + I44[1] + I45[1] + I01[2] + I11[2] + I02[2] + I03[2] + I04[2] + I05[2] + I22[2] + I23[2] + I24[2] + I25[2] + I32[2] + I33[2] + I34[2] + I35[2] + I42[2] + I43[2] + I44[2] + I45[2] + I01[3] + I11[3] + I02[3] + I03[3] + I04[3] + I05[3] + I22[3] + I23[3] + I24[3] + I25[3] + I32[3] + I33[3] + I34[3] + I35[3] + I42[3] + I43[3] + I44[3] + I45[3] + I01[6] + I11[6] + I02[6] + I03[6] + I04[6] + I05[6] + I22[6] + I23[6] + I24[6] + I25[6] + I32[6] + I33[6] + I34[6] + I35[6] + I42[6] + I43[6] + I44[6] + I45[6]) / (main_model_p->N[0] + main_model_p->N[1] + main_model_p->N[2] + main_model_p->N[3] + main_model_p->N[6]);
    output[13] = prev_men;
    output[14] = prev_women;
    output[15] = Ntot;
    output[16] = new_people;
    memcpy(output_N, main_model_p->N, main_model_p->dim_N * sizeof(double));
    output[17] = prev_FSW;
    output[18] = prev_client;
    memcpy(output_frac_N, main_model_p->frac_N, main_model_p->dim_frac_N * sizeof(double));
    memcpy(output_E1a, main_model_p->E1a, main_model_p->dim_E1a * sizeof(double));
    memcpy(output_E1b, main_model_p->E1b, main_model_p->dim_E1b * sizeof(double));
    memcpy(output_E1c, main_model_p->E1c, main_model_p->dim_E1c * sizeof(double));
    memcpy(output_E1d, main_model_p->E1d, main_model_p->dim_E1d * sizeof(double));
    memcpy(output_E0, main_model_p->E0, main_model_p->dim_E0 * sizeof(double));
    memcpy(output_alphaItot, main_model_p->alphaItot, main_model_p->dim_alphaItot * sizeof(double));
    for (int i = 0; i < main_model_p->dim_prev; ++i) {
      main_model_p->prev[i] = 100 * (I01[i] + I11[i] + I02[i] + I03[i] + I04[i] + I05[i] + I22[i] + I23[i] + I24[i] + I25[i] + I32[i] + I33[i] + I34[i] + I35[i] + I42[i] + I43[i] + I44[i] + I45[i]) / main_model_p->N[i];
    }
    memcpy(output_prev, main_model_p->prev, main_model_p->dim_prev * sizeof(double));
    double B_check_comm = (main_model_p->Ncat == 9 ? main_model_p->c_comm_balanced[0] * main_model_p->N[0] + main_model_p->c_comm_balanced[1] * main_model_p->N[1] + main_model_p->c_comm_balanced[2] * main_model_p->N[2] + main_model_p->c_comm_balanced[3] * main_model_p->N[3] - main_model_p->c_comm_balanced[4] * main_model_p->N[4] - main_model_p->c_comm_balanced[5] * main_model_p->N[5] : 1);
    output[19] = B_check_comm;
    memcpy(output_c_comm_balanced, main_model_p->c_comm_balanced, main_model_p->dim_c_comm_balanced * sizeof(double));
    double B_check_noncomm = (main_model_p->Ncat == 9 ? main_model_p->c_noncomm_balanced[0] * main_model_p->N[0] + main_model_p->c_noncomm_balanced[1] * main_model_p->N[1] + main_model_p->c_noncomm_balanced[2] * main_model_p->N[2] + main_model_p->c_noncomm_balanced[3] * main_model_p->N[3] - main_model_p->c_noncomm_balanced[4] * main_model_p->N[4] - main_model_p->c_noncomm_balanced[5] * main_model_p->N[5] : 1);
    output[20] = B_check_noncomm;
    memcpy(output_c_noncomm_balanced, main_model_p->c_noncomm_balanced, main_model_p->dim_c_noncomm_balanced * sizeof(double));
    memcpy(output_theta, main_model_p->theta, main_model_p->dim_theta * sizeof(double));
    memcpy(output_p_comm, main_model_p->p_comm, main_model_p->dim_p_comm * sizeof(double));
    memcpy(output_M_comm, main_model_p->M_comm, main_model_p->dim_M_comm * sizeof(double));
    for (int i = 0; i < main_model_p->dim_lambda_1; ++i) {
      for (int j = 0; j < main_model_p->dim_lambda_2; ++j) {
        main_model_p->lambda[i + j * main_model_p->dim_lambda_1] = (i == j ? 0 : compute_lambda(main_model_p->c_comm_balanced[i], main_model_p->p_comm[i + j * main_model_p->dim_p_comm_1], S0[j], S1a[j], S1b[j], S1c[j], I01[j], I11[j], I02[j], I03[j], I04[j], I05[j], I22[j], I23[j], I24[j], I25[j], I32[j], I33[j], I34[j], I35[j], I42[j], I43[j], I44[j], I45[j], main_model_p->N[j], main_model_p->beta_comm[i], main_model_p->R, main_model_p->fc_comm[i + j * main_model_p->dim_fc_comm_1], main_model_p->fP_comm[i], main_model_p->n_comm[i + j * main_model_p->dim_n_comm_1], main_model_p->eP[i], main_model_p->ec[i], main_model_p->fc_noncomm[i + j * main_model_p->dim_fc_noncomm_1], main_model_p->fP_noncomm[i], main_model_p->n_noncomm[i + j * main_model_p->dim_n_noncomm_1], main_model_p->c_noncomm_balanced[i], main_model_p->p_noncomm[i + j * main_model_p->dim_p_noncomm_1], main_model_p->infect_ART, main_model_p->infect_acute, main_model_p->infect_AIDS, main_model_p->beta_noncomm[i]));
      }
    }
    memcpy(output_lambda, main_model_p->lambda, main_model_p->dim_lambda * sizeof(double));
    memcpy(output_lambda_0, main_model_p->lambda_0, main_model_p->dim_lambda_0 * sizeof(double));
    memcpy(output_lambda_1a, main_model_p->lambda_1a, main_model_p->dim_lambda_1a * sizeof(double));
    memcpy(output_lambda_1b, main_model_p->lambda_1b, main_model_p->dim_lambda_1b * sizeof(double));
    memcpy(output_lambda_1c, main_model_p->lambda_1c, main_model_p->dim_lambda_1c * sizeof(double));
    memcpy(output_lambda_1d, main_model_p->lambda_1d, main_model_p->dim_lambda_1d * sizeof(double));
    memcpy(output_lambda_sum_0, main_model_p->lambda_sum_0, main_model_p->dim_lambda_sum_0 * sizeof(double));
    memcpy(output_lambda_sum_1a, main_model_p->lambda_sum_1a, main_model_p->dim_lambda_sum_1a * sizeof(double));
    memcpy(output_lambda_sum_1b, main_model_p->lambda_sum_1b, main_model_p->dim_lambda_sum_1b * sizeof(double));
    memcpy(output_lambda_sum_1c, main_model_p->lambda_sum_1c, main_model_p->dim_lambda_sum_1c * sizeof(double));
    memcpy(output_lambda_sum_1d, main_model_p->lambda_sum_1d, main_model_p->dim_lambda_sum_1d * sizeof(double));
    memcpy(output_p_noncomm, main_model_p->p_noncomm, main_model_p->dim_p_noncomm * sizeof(double));
    memcpy(output_M_noncomm, main_model_p->M_noncomm, main_model_p->dim_M_noncomm * sizeof(double));
    for (int i = 0; i < main_model_p->dim_sum_in_S0; ++i) {
      main_model_p->sum_in_S0[i] = odin_sum2(main_model_p->in_S0, i, i, 0, main_model_p->dim_in_S0_2 - 1, main_model_p->dim_in_S0_1);
    }
    memcpy(output_sum_in_S0, main_model_p->sum_in_S0, main_model_p->dim_sum_in_S0 * sizeof(double));
    memcpy(output_rate_move_in, main_model_p->rate_move_in, main_model_p->dim_rate_move_in * sizeof(double));
    memcpy(output_rate_move_out, main_model_p->rate_move_out, main_model_p->dim_rate_move_out * sizeof(double));
  }
}

void main_model_output(main_model_pars *main_model_p, double t, double *state, double *output) {
  double *cumuInf = state;
  double *S0 = state + main_model_p->offset_S0;
  double *S1a = state + main_model_p->offset_S1a;
  double *S1b = state + main_model_p->offset_S1b;
  double *S1c = state + main_model_p->offset_S1c;
  double *S1d = state + main_model_p->offset_S1d;
  double *I01 = state + main_model_p->offset_I01;
  double *I11 = state + main_model_p->offset_I11;
  double *I02 = state + main_model_p->offset_I02;
  double *I03 = state + main_model_p->offset_I03;
  double *I04 = state + main_model_p->offset_I04;
  double *I05 = state + main_model_p->offset_I05;
  double *I22 = state + main_model_p->offset_I22;
  double *I23 = state + main_model_p->offset_I23;
  double *I24 = state + main_model_p->offset_I24;
  double *I25 = state + main_model_p->offset_I25;
  double *I32 = state + main_model_p->offset_I32;
  double *I33 = state + main_model_p->offset_I33;
  double *I34 = state + main_model_p->offset_I34;
  double *I35 = state + main_model_p->offset_I35;
  double *I42 = state + main_model_p->offset_I42;
  double *I43 = state + main_model_p->offset_I43;
  double *I44 = state + main_model_p->offset_I44;
  double *I45 = state + main_model_p->offset_I45;
  double *output_c_comm = output + 21;
  double *output_c_noncomm = output + main_model_p->offset_output_c_noncomm;
  double *output_new_people_in_group = output + main_model_p->offset_output_new_people_in_group;
  double *output_testing_prob = output + main_model_p->offset_output_testing_prob;
  double *output_ART_prob = output + main_model_p->offset_output_ART_prob;
  double *output_tau = output + main_model_p->offset_output_tau;
  double *output_rho = output + main_model_p->offset_output_rho;
  double *output_frac_F = output + main_model_p->offset_output_frac_F;
  double *output_frac_N_sexualpop = output + main_model_p->offset_output_frac_N_sexualpop;
  double *output_zetaa = output + main_model_p->offset_output_zetaa;
  double *output_zetab = output + main_model_p->offset_output_zetab;
  double *output_zetac = output + main_model_p->offset_output_zetac;
  double *output_omega = output + main_model_p->offset_output_omega;
  double *output_frac_N = output + main_model_p->offset_output_frac_N;
  double *output_mu = output + main_model_p->offset_output_mu;
  double *output_gamma01 = output + main_model_p->offset_output_gamma01;
  double *output_kappaa = output + main_model_p->offset_output_kappaa;
  double *output_kappab = output + main_model_p->offset_output_kappab;
  double *output_kappac = output + main_model_p->offset_output_kappac;
  double *output_alpha05 = output + main_model_p->offset_output_alpha05;
  double *output_alpha35 = output + main_model_p->offset_output_alpha35;
  double *output_beta_comm = output + main_model_p->offset_output_beta_comm;
  double *output_beta_noncomm = output + main_model_p->offset_output_beta_noncomm;
  double *output_p_comm = output + main_model_p->offset_output_p_comm;
  double *output_p_noncomm = output + main_model_p->offset_output_p_noncomm;
  double *output_fc_comm = output + main_model_p->offset_output_fc_comm;
  double *output_fP_comm = output + main_model_p->offset_output_fP_comm;
  double *output_fc_noncomm = output + main_model_p->offset_output_fc_noncomm;
  double *output_fP_noncomm = output + main_model_p->offset_output_fP_noncomm;
  double *output_n_comm = output + main_model_p->offset_output_n_comm;
  double *output_n_noncomm = output + main_model_p->offset_output_n_noncomm;
  double *output_N = output + main_model_p->offset_output_N;
  double *output_E0 = output + main_model_p->offset_output_E0;
  double *output_E1a = output + main_model_p->offset_output_E1a;
  double *output_E1b = output + main_model_p->offset_output_E1b;
  double *output_E1c = output + main_model_p->offset_output_E1c;
  double *output_E1d = output + main_model_p->offset_output_E1d;
  double *output_alphaItot = output + main_model_p->offset_output_alphaItot;
  double *output_prev = output + main_model_p->offset_output_prev;
  double *output_lambda = output + main_model_p->offset_output_lambda;
  double *output_lambda_0 = output + main_model_p->offset_output_lambda_0;
  double *output_lambda_1a = output + main_model_p->offset_output_lambda_1a;
  double *output_lambda_1b = output + main_model_p->offset_output_lambda_1b;
  double *output_lambda_1c = output + main_model_p->offset_output_lambda_1c;
  double *output_lambda_1d = output + main_model_p->offset_output_lambda_1d;
  double *output_lambda_sum_0 = output + main_model_p->offset_output_lambda_sum_0;
  double *output_lambda_sum_1a = output + main_model_p->offset_output_lambda_sum_1a;
  double *output_lambda_sum_1b = output + main_model_p->offset_output_lambda_sum_1b;
  double *output_lambda_sum_1c = output + main_model_p->offset_output_lambda_sum_1c;
  double *output_lambda_sum_1d = output + main_model_p->offset_output_lambda_sum_1d;
  double *output_c_comm_balanced = output + main_model_p->offset_output_c_comm_balanced;
  double *output_c_noncomm_balanced = output + main_model_p->offset_output_c_noncomm_balanced;
  double *output_theta = output + main_model_p->offset_output_theta;
  double *output_M_comm = output + main_model_p->offset_output_M_comm;
  double *output_M_noncomm = output + main_model_p->offset_output_M_noncomm;
  double *output_sum_in_S0 = output + main_model_p->offset_output_sum_in_S0;
  double *output_rate_move_in = output + main_model_p->offset_output_rate_move_in;
  double *output_rate_move_out = output + main_model_p->offset_output_rate_move_out;
  interpolate_linear_run(t, main_model_p->interpolate_c_comm, main_model_p->c_comm);
  interpolate_linear_run(t, main_model_p->interpolate_c_noncomm, main_model_p->c_noncomm);
  output[0] = main_model_p->who_believe_comm;
  interpolate_linear_run(t, main_model_p->interpolate_testing_prob, main_model_p->testing_prob);
  memcpy(output_testing_prob, main_model_p->testing_prob, main_model_p->dim_testing_prob * sizeof(double));
  interpolate_linear_run(t, main_model_p->interpolate_ART_prob, main_model_p->ART_prob);
  memcpy(output_ART_prob, main_model_p->ART_prob, main_model_p->dim_ART_prob * sizeof(double));
  for (int i = 0; i < main_model_p->dim_tau; ++i) {
    main_model_p->tau[i] = -log(1 - main_model_p->testing_prob[i]);
  }
  memcpy(output_tau, main_model_p->tau, main_model_p->dim_tau * sizeof(double));
  for (int i = 0; i < main_model_p->dim_rho; ++i) {
    main_model_p->rho[i] = -log(1 - main_model_p->ART_prob[i]);
  }
  memcpy(output_rho, main_model_p->rho, main_model_p->dim_rho * sizeof(double));
  double cumuInftot = odin_sum1(cumuInf, 0, main_model_p->dim_cumuInf - 1);
  output[1] = cumuInftot;
  double ART_coverage_men = (I32[4] + I33[4] + I34[4] + I35[4] + I32[5] + I33[5] + I34[5] + I35[5]) / (I01[4] + I11[4] + I02[4] + I03[4] + I04[4] + I05[4] + I22[4] + I23[4] + I24[4] + I25[4] + I32[4] + I33[4] + I34[4] + I35[4] + I42[4] + I43[4] + I44[4] + I45[4] + I01[5] + I11[5] + I02[5] + I03[5] + I04[5] + I05[5] + I22[5] + I23[5] + I24[5] + I25[5] + I32[5] + I33[5] + I34[5] + I35[5] + I42[5] + I43[5] + I44[5] + I45[5]);
  double ART_coverage_women = (I32[0] + I33[0] + I34[0] + I35[0] + I32[1] + I33[1] + I34[1] + I35[1] + I32[2] + I33[2] + I34[2] + I35[2] + I32[3] + I33[3] + I34[3] + I35[3]) / (I01[0] + I11[0] + I02[0] + I03[0] + I04[0] + I05[0] + I22[0] + I23[0] + I24[0] + I25[0] + I32[0] + I33[0] + I34[0] + I35[0] + I42[0] + I43[0] + I44[0] + I45[0] + I01[1] + I11[1] + I02[1] + I03[1] + I04[1] + I05[1] + I22[1] + I23[1] + I24[1] + I25[1] + I32[1] + I33[1] + I34[1] + I35[1] + I42[1] + I43[1] + I44[1] + I45[1] + I01[2] + I11[2] + I02[2] + I03[2] + I04[2] + I05[2] + I22[2] + I23[2] + I24[2] + I25[2] + I32[2] + I33[2] + I34[2] + I35[2] + I42[2] + I43[2] + I44[2] + I45[2] + I01[3] + I11[3] + I02[3] + I03[3] + I04[3] + I05[3] + I22[3] + I23[3] + I24[3] + I25[3] + I32[3] + I33[3] + I34[3] + I35[3] + I42[3] + I43[3] + I44[3] + I45[3]);
  double ART_coverage_FSW = (I32[0] + I33[0] + I34[0] + I35[0]) / (I01[0] + I11[0] + I02[0] + I03[0] + I04[0] + I05[0] + I22[0] + I23[0] + I24[0] + I25[0] + I32[0] + I33[0] + I34[0] + I35[0] + I42[0] + I43[0] + I44[0] + I45[0]);
  double ART_coverage_all = (I32[0] + I33[0] + I34[0] + I35[0] + I32[1] + I33[1] + I34[1] + I35[1] + I32[2] + I33[2] + I34[2] + I35[2] + I32[3] + I33[3] + I34[3] + I35[3] + I32[4] + I33[4] + I34[4] + I35[4] + I32[5] + I33[5] + I34[5] + I35[5]) / (I01[0] + I11[0] + I02[0] + I03[0] + I04[0] + I05[0] + I22[0] + I23[0] + I24[0] + I25[0] + I32[0] + I33[0] + I34[0] + I35[0] + I42[0] + I43[0] + I44[0] + I45[0] + I01[1] + I11[1] + I02[1] + I03[1] + I04[1] + I05[1] + I22[1] + I23[1] + I24[1] + I25[1] + I32[1] + I33[1] + I34[1] + I35[1] + I42[1] + I43[1] + I44[1] + I45[1] + I01[2] + I11[2] + I02[2] + I03[2] + I04[2] + I05[2] + I22[2] + I23[2] + I24[2] + I25[2] + I32[2] + I33[2] + I34[2] + I35[2] + I42[2] + I43[2] + I44[2] + I45[2] + I01[3] + I11[3] + I02[3] + I03[3] + I04[3] + I05[3] + I22[3] + I23[3] + I24[3] + I25[3] + I32[3] + I33[3] + I34[3] + I35[3] + I42[3] + I43[3] + I44[3] + I45[3] + I01[4] + I11[4] + I02[4] + I03[4] + I04[4] + I05[4] + I22[4] + I23[4] + I24[4] + I25[4] + I32[4] + I33[4] + I34[4] + I35[4] + I42[4] + I43[4] + I44[4] + I45[4] + I01[5] + I11[5] + I02[5] + I03[5] + I04[5] + I05[5] + I22[5] + I23[5] + I24[5] + I25[5] + I32[5] + I33[5] + I34[5] + I35[5] + I42[5] + I43[5] + I44[5] + I45[5]);
  output[2] = ART_coverage_men;
  output[3] = ART_coverage_women;
  output[4] = ART_coverage_FSW;
  output[5] = ART_coverage_all;
  output[6] = main_model_p->Ncat;
  memcpy(output_c_comm, main_model_p->c_comm, main_model_p->dim_c_comm * sizeof(double));
  memcpy(output_c_noncomm, main_model_p->c_noncomm, main_model_p->dim_c_noncomm * sizeof(double));
  output[7] = main_model_p->Nage;
  output[8] = main_model_p->dur_FSW;
  interpolate_constant_run(t, main_model_p->interpolate_epsilon, &(main_model_p->epsilon));
  output[9] = main_model_p->epsilon;
  interpolate_constant_run(t, main_model_p->interpolate_zetaa, main_model_p->zetaa);
  memcpy(output_zetaa, main_model_p->zetaa, main_model_p->dim_zetaa * sizeof(double));
  interpolate_constant_run(t, main_model_p->interpolate_zetab, main_model_p->zetab);
  memcpy(output_zetab, main_model_p->zetab, main_model_p->dim_zetab * sizeof(double));
  interpolate_constant_run(t, main_model_p->interpolate_zetac, main_model_p->zetac);
  memcpy(output_zetac, main_model_p->zetac, main_model_p->dim_zetac * sizeof(double));
  memcpy(output_omega, main_model_p->omega, main_model_p->dim_omega * sizeof(double));
  memcpy(output_mu, main_model_p->mu, main_model_p->dim_mu * sizeof(double));
  memcpy(output_gamma01, main_model_p->gamma01, main_model_p->dim_gamma01 * sizeof(double));
  memcpy(output_kappaa, main_model_p->kappaa, main_model_p->dim_kappaa * sizeof(double));
  memcpy(output_kappab, main_model_p->kappab, main_model_p->dim_kappab * sizeof(double));
  memcpy(output_kappac, main_model_p->kappac, main_model_p->dim_kappac * sizeof(double));
  memcpy(output_alpha05, main_model_p->alpha05, main_model_p->dim_alpha05 * sizeof(double));
  memcpy(output_alpha35, main_model_p->alpha35, main_model_p->dim_alpha35 * sizeof(double));
  memcpy(output_beta_comm, main_model_p->beta_comm, main_model_p->dim_beta_comm * sizeof(double));
  memcpy(output_beta_noncomm, main_model_p->beta_noncomm, main_model_p->dim_beta_noncomm * sizeof(double));
  interpolate_linear_run(t, main_model_p->interpolate_fc_comm, main_model_p->fc_comm);
  memcpy(output_fc_comm, main_model_p->fc_comm, main_model_p->dim_fc_comm * sizeof(double));
  interpolate_linear_run(t, main_model_p->interpolate_fP_comm, main_model_p->fP_comm);
  memcpy(output_fP_comm, main_model_p->fP_comm, main_model_p->dim_fP_comm * sizeof(double));
  interpolate_linear_run(t, main_model_p->interpolate_fc_noncomm, main_model_p->fc_noncomm);
  memcpy(output_fc_noncomm, main_model_p->fc_noncomm, main_model_p->dim_fc_noncomm * sizeof(double));
  interpolate_linear_run(t, main_model_p->interpolate_fP_noncomm, main_model_p->fP_noncomm);
  memcpy(output_fP_noncomm, main_model_p->fP_noncomm, main_model_p->dim_fP_noncomm * sizeof(double));
  memcpy(output_n_comm, main_model_p->n_comm, main_model_p->dim_n_comm * sizeof(double));
  memcpy(output_n_noncomm, main_model_p->n_noncomm, main_model_p->dim_n_noncomm * sizeof(double));
  for (int i = 0; i < main_model_p->dim_N; ++i) {
    main_model_p->N[i] = S0[i] + S1a[i] + S1b[i] + S1c[i] + S1d[i] + I01[i] + I11[i] + I02[i] + I03[i] + I04[i] + I05[i] + I22[i] + I23[i] + I24[i] + I25[i] + I32[i] + I33[i] + I34[i] + I35[i] + I42[i] + I43[i] + I44[i] + I45[i];
  }
  double Ntot = (main_model_p->Ncat == 9 ? (main_model_p->N[0] + main_model_p->N[1] + main_model_p->N[2] + main_model_p->N[3] + main_model_p->N[4] + main_model_p->N[5] + main_model_p->N[6] + main_model_p->N[7]) : odin_sum1(main_model_p->N, 0, main_model_p->dim_N - 1));
  double Ntot_inc_former_FSW_nonCot = odin_sum1(main_model_p->N, 0, main_model_p->dim_N - 1);
  output[10] = Ntot_inc_former_FSW_nonCot;
  double new_people = main_model_p->epsilon * Ntot_inc_former_FSW_nonCot;
  for (int i = 0; i < main_model_p->dim_new_people_in_group; ++i) {
    main_model_p->new_people_in_group[i] = new_people * main_model_p->omega[i];
  }
  memcpy(output_new_people_in_group, main_model_p->new_people_in_group, main_model_p->dim_new_people_in_group * sizeof(double));
  for (int i = 0; i < main_model_p->dim_frac_N; ++i) {
    main_model_p->frac_N[i] = main_model_p->N[i] / Ntot_inc_former_FSW_nonCot;
  }
  for (int i = 0; i < main_model_p->dim_frac_F; ++i) {
    main_model_p->frac_F[i] = (main_model_p->Ncat == 9 ? (main_model_p->N[0] + main_model_p->N[1] + main_model_p->N[2] + main_model_p->N[3] + main_model_p->N[6] + main_model_p->N[8]) / Ntot_inc_former_FSW_nonCot : 0);
  }
  for (int i = 0; i < main_model_p->dim_frac_N_sexualpop; ++i) {
    main_model_p->frac_N_sexualpop[i] = (main_model_p->Ncat == 9 ? main_model_p->N[i] / (main_model_p->N[0] + main_model_p->N[1] + main_model_p->N[2] + main_model_p->N[3] + main_model_p->N[4] + main_model_p->N[5]) : 0);
  }
  double frac_virgin = (main_model_p->Ncat == 9 ? (main_model_p->N[6] + main_model_p->N[7]) / (main_model_p->N[0] + main_model_p->N[1] + main_model_p->N[2] + main_model_p->N[3] + main_model_p->N[4] + main_model_p->N[5] + main_model_p->N[6] + main_model_p->N[7]) : 0);
  output[11] = frac_virgin;
  memcpy(output_frac_F, main_model_p->frac_F, main_model_p->dim_frac_F * sizeof(double));
  memcpy(output_frac_N_sexualpop, main_model_p->frac_N_sexualpop, main_model_p->dim_frac_N_sexualpop * sizeof(double));
  double prev_FSW = 100 * (I01[0] + I11[0] + I02[0] + I03[0] + I04[0] + I05[0] + I22[0] + I23[0] + I24[0] + I25[0] + I32[0] + I33[0] + I34[0] + I35[0] + I42[0] + I43[0] + I44[0] + I45[0]) / main_model_p->N[0];
  double prev_LowFSW = 100 * (I01[1] + I11[1] + I02[1] + I03[1] + I04[1] + I05[1] + I22[1] + I23[1] + I24[1] + I25[1] + I32[1] + I33[1] + I34[1] + I35[1] + I42[1] + I43[1] + I44[1] + I45[1]) / main_model_p->N[1];
  output[12] = prev_LowFSW;
  double prev_client = 100 * (I01[4] + I11[4] + I02[4] + I03[4] + I04[4] + I05[4] + I22[4] + I23[4] + I24[4] + I25[4] + I32[4] + I33[4] + I34[4] + I35[4] + I42[4] + I43[4] + I44[4] + I45[4]) / main_model_p->N[4];
  double prev_men = 100 * (I01[4] + I11[4] + I02[4] + I03[4] + I04[4] + I05[4] + I22[4] + I23[4] + I24[4] + I25[4] + I32[4] + I33[4] + I34[4] + I35[4] + I42[4] + I43[4] + I44[4] + I45[4] + I01[5] + I11[5] + I02[5] + I03[5] + I04[5] + I05[5] + I22[5] + I23[5] + I24[5] + I25[5] + I32[5] + I33[5] + I34[5] + I35[5] + I42[5] + I43[5] + I44[5] + I45[5] + I01[7] + I11[7] + I02[7] + I03[7] + I04[7] + I05[7] + I22[7] + I23[7] + I24[7] + I25[7] + I32[7] + I33[7] + I34[7] + I35[7] + I42[7] + I43[7] + I44[7] + I45[7]) / (main_model_p->N[4] + main_model_p->N[5] + main_model_p->N[7]);
  double prev_women = 100 * (I01[0] + I11[0] + I02[0] + I03[0] + I04[0] + I05[0] + I22[0] + I23[0] + I24[0] + I25[0] + I32[0] + I33[0] + I34[0] + I35[0] + I42[0] + I43[0] + I44[0] + I45[0] + I01[1] + I11[1] + I02[1] + I03[1] + I04[1] + I05[1] + I22[1] + I23[1] + I24[1] + I25[1] + I32[1] + I33[1] + I34[1] + I35[1] + I42[1] + I43[1] + I44[1] + I45[1] + I01[2] + I11[2] + I02[2] + I03[2] + I04[2] + I05[2] + I22[2] + I23[2] + I24[2] + I25[2] + I32[2] + I33[2] + I34[2] + I35[2] + I42[2] + I43[2] + I44[2] + I45[2] + I01[3] + I11[3] + I02[3] + I03[3] + I04[3] + I05[3] + I22[3] + I23[3] + I24[3] + I25[3] + I32[3] + I33[3] + I34[3] + I35[3] + I42[3] + I43[3] + I44[3] + I45[3] + I01[6] + I11[6] + I02[6] + I03[6] + I04[6] + I05[6] + I22[6] + I23[6] + I24[6] + I25[6] + I32[6] + I33[6] + I34[6] + I35[6] + I42[6] + I43[6] + I44[6] + I45[6]) / (main_model_p->N[0] + main_model_p->N[1] + main_model_p->N[2] + main_model_p->N[3] + main_model_p->N[6]);
  output[13] = prev_men;
  output[14] = prev_women;
  output[15] = Ntot;
  output[16] = new_people;
  memcpy(output_N, main_model_p->N, main_model_p->dim_N * sizeof(double));
  output[17] = prev_FSW;
  output[18] = prev_client;
  memcpy(output_frac_N, main_model_p->frac_N, main_model_p->dim_frac_N * sizeof(double));
  for (int i = 0; i < main_model_p->dim_E1a; ++i) {
    main_model_p->E1a[i] = main_model_p->zetaa[i] * S0[i] - main_model_p->psia[i] * S1a[i] - main_model_p->kappaa[i] * S1a[i];
  }
  memcpy(output_E1a, main_model_p->E1a, main_model_p->dim_E1a * sizeof(double));
  for (int i = 0; i < main_model_p->dim_E1b; ++i) {
    main_model_p->E1b[i] = main_model_p->zetab[i] * S0[i] + main_model_p->psia[i] * S1a[i] - main_model_p->psib[i] * S1b[i] - main_model_p->kappab[i] * S1b[i];
  }
  memcpy(output_E1b, main_model_p->E1b, main_model_p->dim_E1b * sizeof(double));
  for (int i = 0; i < main_model_p->dim_E1c; ++i) {
    main_model_p->E1c[i] = main_model_p->zetac[i] * S0[i] + main_model_p->psib[i] * S1b[i] - main_model_p->kappac[i] * S1c[i];
  }
  memcpy(output_E1c, main_model_p->E1c, main_model_p->dim_E1c * sizeof(double));
  for (int i = 0; i < main_model_p->dim_E1d; ++i) {
    main_model_p->E1d[i] = main_model_p->kappaa[i] * S1a[i] + main_model_p->kappab[i] * S1b[i] + main_model_p->kappac[i] * S1c[i];
  }
  memcpy(output_E1d, main_model_p->E1d, main_model_p->dim_E1d * sizeof(double));
  for (int i = 0; i < main_model_p->dim_alphaItot; ++i) {
    main_model_p->alphaItot[i] = main_model_p->alpha01[i] * I01[i] + main_model_p->alpha11[i] * I11[i] + main_model_p->alpha02[i] * I02[i] + main_model_p->alpha03[i] * I03[i] + main_model_p->alpha04[i] * I04[i] + main_model_p->alpha05[i] * I05[i] + main_model_p->alpha22[i] * I22[i] + main_model_p->alpha23[i] * I23[i] + main_model_p->alpha24[i] * I24[i] + main_model_p->alpha25[i] * I25[i] + main_model_p->alpha32[i] * I32[i] + main_model_p->alpha33[i] * I33[i] + main_model_p->alpha34[i] * I34[i] + main_model_p->alpha35[i] * I35[i] + main_model_p->alpha42[i] * I42[i] + main_model_p->alpha43[i] * I43[i] + main_model_p->alpha44[i] * I44[i] + main_model_p->alpha45[i] * I45[i];
  }
  for (int i = 0; i < main_model_p->dim_E0; ++i) {
    main_model_p->E0[i] = (main_model_p->replaceDeaths == 1 ? main_model_p->mu[i] * main_model_p->N[i] + main_model_p->alphaItot[i] + new_people * main_model_p->omega[i] - S0[i] * (main_model_p->zetaa[i] + main_model_p->zetab[i] + main_model_p->zetac[i]) : new_people * main_model_p->omega[i] - S0[i] * (main_model_p->zetaa[i] + main_model_p->zetab[i] + main_model_p->zetac[i]));
  }
  memcpy(output_E0, main_model_p->E0, main_model_p->dim_E0 * sizeof(double));
  memcpy(output_alphaItot, main_model_p->alphaItot, main_model_p->dim_alphaItot * sizeof(double));
  for (int i = 0; i < main_model_p->dim_prev; ++i) {
    main_model_p->prev[i] = 100 * (I01[i] + I11[i] + I02[i] + I03[i] + I04[i] + I05[i] + I22[i] + I23[i] + I24[i] + I25[i] + I32[i] + I33[i] + I34[i] + I35[i] + I42[i] + I43[i] + I44[i] + I45[i]) / main_model_p->N[i];
  }
  memcpy(output_prev, main_model_p->prev, main_model_p->dim_prev * sizeof(double));
  for (int i = 0; i < main_model_p->dim_c_comm_balanced; ++i) {
    main_model_p->c_comm_balanced[i] = main_model_p->c_comm[i];
  }
  {
    int i = 4;
    main_model_p->c_comm_balanced[i] = (main_model_p->Ncat == 9 && main_model_p->who_believe_comm == 0 ? (main_model_p->c_comm[0] * main_model_p->N[0] + main_model_p->c_comm[1] * main_model_p->N[1]) / main_model_p->N[4] : main_model_p->c_comm_balanced[4]);
  }
  {
    int i = 0;
    main_model_p->c_comm_balanced[i] = (main_model_p->Ncat == 9 && main_model_p->who_believe_comm == 1 ? (main_model_p->c_comm[4] * main_model_p->N[4] - main_model_p->c_comm[1] * main_model_p->N[1]) / main_model_p->N[0] : main_model_p->c_comm_balanced[0]);
  }
  double B_check_comm = (main_model_p->Ncat == 9 ? main_model_p->c_comm_balanced[0] * main_model_p->N[0] + main_model_p->c_comm_balanced[1] * main_model_p->N[1] + main_model_p->c_comm_balanced[2] * main_model_p->N[2] + main_model_p->c_comm_balanced[3] * main_model_p->N[3] - main_model_p->c_comm_balanced[4] * main_model_p->N[4] - main_model_p->c_comm_balanced[5] * main_model_p->N[5] : 1);
  output[19] = B_check_comm;
  memcpy(output_c_comm_balanced, main_model_p->c_comm_balanced, main_model_p->dim_c_comm_balanced * sizeof(double));
  for (int i = 0; i < main_model_p->dim_c_noncomm_balanced; ++i) {
    main_model_p->c_noncomm_balanced[i] = main_model_p->c_noncomm[i];
  }
  {
    int i = 2;
    main_model_p->c_noncomm_balanced[i] = (main_model_p->Ncat == 9 ? (main_model_p->N[4] * main_model_p->c_noncomm[4] + main_model_p->N[5] * main_model_p->c_noncomm[5] - main_model_p->N[0] * main_model_p->c_noncomm[0] - main_model_p->N[1] * main_model_p->c_noncomm[1]) / (main_model_p->N[2] + main_model_p->N[3]) : main_model_p->c_noncomm_balanced[2]);
  }
  {
    int i = 3;
    main_model_p->c_noncomm_balanced[i] = (main_model_p->Ncat == 9 ? main_model_p->c_noncomm_balanced[2] : main_model_p->c_noncomm_balanced[3]);
  }
  double B_check_noncomm = (main_model_p->Ncat == 9 ? main_model_p->c_noncomm_balanced[0] * main_model_p->N[0] + main_model_p->c_noncomm_balanced[1] * main_model_p->N[1] + main_model_p->c_noncomm_balanced[2] * main_model_p->N[2] + main_model_p->c_noncomm_balanced[3] * main_model_p->N[3] - main_model_p->c_noncomm_balanced[4] * main_model_p->N[4] - main_model_p->c_noncomm_balanced[5] * main_model_p->N[5] : 1);
  output[20] = B_check_noncomm;
  memcpy(output_c_noncomm_balanced, main_model_p->c_noncomm_balanced, main_model_p->dim_c_noncomm_balanced * sizeof(double));
  memcpy(output_theta, main_model_p->theta, main_model_p->dim_theta * sizeof(double));
  for (int i = 0; i < main_model_p->dim_comm_partnerships_requested_1; ++i) {
    for (int j = 0; j < main_model_p->dim_comm_partnerships_requested_2; ++j) {
      main_model_p->comm_partnerships_requested[i + j * main_model_p->dim_comm_partnerships_requested_1] = main_model_p->N[j] * main_model_p->c_comm_balanced[j] * main_model_p->M_comm[i + j * main_model_p->dim_M_comm_1];
    }
  }
  for (int i = 0; i < main_model_p->dim_p_comm_1; ++i) {
    for (int j = 0; j < main_model_p->dim_p_comm_2; ++j) {
      main_model_p->p_comm[i + j * main_model_p->dim_p_comm_1] = (main_model_p->M_comm[i + j * main_model_p->dim_M_comm_1] == 0 ? 0 : main_model_p->M_comm[i + j * main_model_p->dim_M_comm_1] * main_model_p->N[j] * main_model_p->c_comm_balanced[j] / odin_sum2(main_model_p->comm_partnerships_requested, i, i, 0, main_model_p->dim_comm_partnerships_requested_2 - 1, main_model_p->dim_comm_partnerships_requested_1));
    }
  }
  memcpy(output_p_comm, main_model_p->p_comm, main_model_p->dim_p_comm * sizeof(double));
  memcpy(output_M_comm, main_model_p->M_comm, main_model_p->dim_M_comm * sizeof(double));
  for (int i = 0; i < main_model_p->dim_noncomm_partnerships_requested_1; ++i) {
    for (int j = 0; j < main_model_p->dim_noncomm_partnerships_requested_2; ++j) {
      main_model_p->noncomm_partnerships_requested[i + j * main_model_p->dim_noncomm_partnerships_requested_1] = main_model_p->N[j] * main_model_p->c_noncomm_balanced[j] * main_model_p->M_noncomm[i + j * main_model_p->dim_M_noncomm_1];
    }
  }
  for (int i = 0; i < main_model_p->dim_p_noncomm_1; ++i) {
    for (int j = 0; j < main_model_p->dim_p_noncomm_2; ++j) {
      main_model_p->p_noncomm[i + j * main_model_p->dim_p_noncomm_1] = (main_model_p->M_noncomm[i + j * main_model_p->dim_M_noncomm_1] == 0 ? 0 : main_model_p->M_noncomm[i + j * main_model_p->dim_M_noncomm_1] * main_model_p->N[j] * main_model_p->c_noncomm_balanced[j] / odin_sum2(main_model_p->noncomm_partnerships_requested, i, i, 0, main_model_p->dim_noncomm_partnerships_requested_2 - 1, main_model_p->dim_noncomm_partnerships_requested_1));
    }
  }
  for (int i = 0; i < main_model_p->dim_lambda_1; ++i) {
    for (int j = 0; j < main_model_p->dim_lambda_2; ++j) {
      main_model_p->lambda[i + j * main_model_p->dim_lambda_1] = (i == j ? 0 : compute_lambda(main_model_p->c_comm_balanced[i], main_model_p->p_comm[i + j * main_model_p->dim_p_comm_1], S0[j], S1a[j], S1b[j], S1c[j], I01[j], I11[j], I02[j], I03[j], I04[j], I05[j], I22[j], I23[j], I24[j], I25[j], I32[j], I33[j], I34[j], I35[j], I42[j], I43[j], I44[j], I45[j], main_model_p->N[j], main_model_p->beta_comm[i], main_model_p->R, main_model_p->fc_comm[i + j * main_model_p->dim_fc_comm_1], main_model_p->fP_comm[i], main_model_p->n_comm[i + j * main_model_p->dim_n_comm_1], main_model_p->eP[i], main_model_p->ec[i], main_model_p->fc_noncomm[i + j * main_model_p->dim_fc_noncomm_1], main_model_p->fP_noncomm[i], main_model_p->n_noncomm[i + j * main_model_p->dim_n_noncomm_1], main_model_p->c_noncomm_balanced[i], main_model_p->p_noncomm[i + j * main_model_p->dim_p_noncomm_1], main_model_p->infect_ART, main_model_p->infect_acute, main_model_p->infect_AIDS, main_model_p->beta_noncomm[i]));
    }
  }
  for (int i = 0; i < main_model_p->dim_lambda_0_1; ++i) {
    for (int j = 0; j < main_model_p->dim_lambda_0_2; ++j) {
      main_model_p->lambda_0[i + j * main_model_p->dim_lambda_0_1] = (i == j ? 0 : compute_lambda(main_model_p->c_comm_balanced[i], main_model_p->p_comm[i + j * main_model_p->dim_p_comm_1], S0[j], S1a[j], S1b[j], S1c[j], I01[j], I11[j], I02[j], I03[j], I04[j], I05[j], I22[j], I23[j], I24[j], I25[j], I32[j], I33[j], I34[j], I35[j], I42[j], I43[j], I44[j], I45[j], main_model_p->N[j], main_model_p->beta_comm[i], main_model_p->R, main_model_p->fc_comm[i + j * main_model_p->dim_fc_comm_1], main_model_p->fP_comm[i], main_model_p->n_comm[i + j * main_model_p->dim_n_comm_1], main_model_p->eP0[i], main_model_p->ec[i], main_model_p->fc_noncomm[i + j * main_model_p->dim_fc_noncomm_1], main_model_p->fP_noncomm[i], main_model_p->n_noncomm[i + j * main_model_p->dim_n_noncomm_1], main_model_p->c_noncomm_balanced[i], main_model_p->p_noncomm[i + j * main_model_p->dim_p_noncomm_1], main_model_p->infect_ART, main_model_p->infect_acute, main_model_p->infect_AIDS, main_model_p->beta_noncomm[i]));
    }
  }
  for (int i = 0; i < main_model_p->dim_lambda_1a_1; ++i) {
    for (int j = 0; j < main_model_p->dim_lambda_1a_2; ++j) {
      main_model_p->lambda_1a[i + j * main_model_p->dim_lambda_1a_1] = (i == j ? 0 : compute_lambda(main_model_p->c_comm_balanced[i], main_model_p->p_comm[i + j * main_model_p->dim_p_comm_1], S0[j], S1a[j], S1b[j], S1c[j], I01[j], I11[j], I02[j], I03[j], I04[j], I05[j], I22[j], I23[j], I24[j], I25[j], I32[j], I33[j], I34[j], I35[j], I42[j], I43[j], I44[j], I45[j], main_model_p->N[j], main_model_p->beta_comm[i], main_model_p->R, main_model_p->fc_comm[i + j * main_model_p->dim_fc_comm_1], main_model_p->fP_comm[i], main_model_p->n_comm[i + j * main_model_p->dim_n_comm_1], main_model_p->eP1a[i], main_model_p->ec[i], main_model_p->fc_noncomm[i + j * main_model_p->dim_fc_noncomm_1], main_model_p->fP_noncomm[i], main_model_p->n_noncomm[i + j * main_model_p->dim_n_noncomm_1], main_model_p->c_noncomm_balanced[i], main_model_p->p_noncomm[i + j * main_model_p->dim_p_noncomm_1], main_model_p->infect_ART, main_model_p->infect_acute, main_model_p->infect_AIDS, main_model_p->beta_noncomm[i]));
    }
  }
  for (int i = 0; i < main_model_p->dim_lambda_1b_1; ++i) {
    for (int j = 0; j < main_model_p->dim_lambda_1b_2; ++j) {
      main_model_p->lambda_1b[i + j * main_model_p->dim_lambda_1b_1] = (i == j ? 0 : compute_lambda(main_model_p->c_comm_balanced[i], main_model_p->p_comm[i + j * main_model_p->dim_p_comm_1], S0[j], S1a[j], S1b[j], S1c[j], I01[j], I11[j], I02[j], I03[j], I04[j], I05[j], I22[j], I23[j], I24[j], I25[j], I32[j], I33[j], I34[j], I35[j], I42[j], I43[j], I44[j], I45[j], main_model_p->N[j], main_model_p->beta_comm[i], main_model_p->R, main_model_p->fc_comm[i + j * main_model_p->dim_fc_comm_1], main_model_p->fP_comm[i], main_model_p->n_comm[i + j * main_model_p->dim_n_comm_1], main_model_p->eP1b[i], main_model_p->ec[i], main_model_p->fc_noncomm[i + j * main_model_p->dim_fc_noncomm_1], main_model_p->fP_noncomm[i], main_model_p->n_noncomm[i + j * main_model_p->dim_n_noncomm_1], main_model_p->c_noncomm_balanced[i], main_model_p->p_noncomm[i + j * main_model_p->dim_p_noncomm_1], main_model_p->infect_ART, main_model_p->infect_acute, main_model_p->infect_AIDS, main_model_p->beta_noncomm[i]));
    }
  }
  for (int i = 0; i < main_model_p->dim_lambda_1c_1; ++i) {
    for (int j = 0; j < main_model_p->dim_lambda_1c_2; ++j) {
      main_model_p->lambda_1c[i + j * main_model_p->dim_lambda_1c_1] = (i == j ? 0 : compute_lambda(main_model_p->c_comm_balanced[i], main_model_p->p_comm[i + j * main_model_p->dim_p_comm_1], S0[j], S1a[j], S1b[j], S1c[j], I01[j], I11[j], I02[j], I03[j], I04[j], I05[j], I22[j], I23[j], I24[j], I25[j], I32[j], I33[j], I34[j], I35[j], I42[j], I43[j], I44[j], I45[j], main_model_p->N[j], main_model_p->beta_comm[i], main_model_p->R, main_model_p->fc_comm[i + j * main_model_p->dim_fc_comm_1], main_model_p->fP_comm[i], main_model_p->n_comm[i + j * main_model_p->dim_n_comm_1], main_model_p->eP1c[i], main_model_p->ec[i], main_model_p->fc_noncomm[i + j * main_model_p->dim_fc_noncomm_1], main_model_p->fP_noncomm[i], main_model_p->n_noncomm[i + j * main_model_p->dim_n_noncomm_1], main_model_p->c_noncomm_balanced[i], main_model_p->p_noncomm[i + j * main_model_p->dim_p_noncomm_1], main_model_p->infect_ART, main_model_p->infect_acute, main_model_p->infect_AIDS, main_model_p->beta_noncomm[i]));
    }
  }
  for (int i = 0; i < main_model_p->dim_lambda_1d_1; ++i) {
    for (int j = 0; j < main_model_p->dim_lambda_1d_2; ++j) {
      main_model_p->lambda_1d[i + j * main_model_p->dim_lambda_1d_1] = (i == j ? 0 : compute_lambda(main_model_p->c_comm_balanced[i], main_model_p->p_comm[i + j * main_model_p->dim_p_comm_1], S0[j], S1a[j], S1b[j], S1c[j], I01[j], I11[j], I02[j], I03[j], I04[j], I05[j], I22[j], I23[j], I24[j], I25[j], I32[j], I33[j], I34[j], I35[j], I42[j], I43[j], I44[j], I45[j], main_model_p->N[j], main_model_p->beta_comm[i], main_model_p->R, main_model_p->fc_comm[i + j * main_model_p->dim_fc_comm_1], main_model_p->fP_comm[i], main_model_p->n_comm[i + j * main_model_p->dim_n_comm_1], main_model_p->eP1d[i], main_model_p->ec[i], main_model_p->fc_noncomm[i + j * main_model_p->dim_fc_noncomm_1], main_model_p->fP_noncomm[i], main_model_p->n_noncomm[i + j * main_model_p->dim_n_noncomm_1], main_model_p->c_noncomm_balanced[i], main_model_p->p_noncomm[i + j * main_model_p->dim_p_noncomm_1], main_model_p->infect_ART, main_model_p->infect_acute, main_model_p->infect_AIDS, main_model_p->beta_noncomm[i]));
    }
  }
  for (int i = 0; i < main_model_p->dim_lambda_sum_0; ++i) {
    main_model_p->lambda_sum_0[i] = odin_sum2(main_model_p->lambda_0, i, i, 0, main_model_p->dim_lambda_0_2 - 1, main_model_p->dim_lambda_0_1);
  }
  for (int i = 0; i < main_model_p->dim_lambda_sum_1a; ++i) {
    main_model_p->lambda_sum_1a[i] = odin_sum2(main_model_p->lambda_1a, i, i, 0, main_model_p->dim_lambda_1a_2 - 1, main_model_p->dim_lambda_1a_1);
  }
  for (int i = 0; i < main_model_p->dim_lambda_sum_1b; ++i) {
    main_model_p->lambda_sum_1b[i] = odin_sum2(main_model_p->lambda_1b, i, i, 0, main_model_p->dim_lambda_1b_2 - 1, main_model_p->dim_lambda_1b_1);
  }
  for (int i = 0; i < main_model_p->dim_lambda_sum_1c; ++i) {
    main_model_p->lambda_sum_1c[i] = odin_sum2(main_model_p->lambda_1c, i, i, 0, main_model_p->dim_lambda_1c_2 - 1, main_model_p->dim_lambda_1c_1);
  }
  for (int i = 0; i < main_model_p->dim_lambda_sum_1d; ++i) {
    main_model_p->lambda_sum_1d[i] = odin_sum2(main_model_p->lambda_1d, i, i, 0, main_model_p->dim_lambda_1d_2 - 1, main_model_p->dim_lambda_1d_1);
  }
  memcpy(output_lambda, main_model_p->lambda, main_model_p->dim_lambda * sizeof(double));
  memcpy(output_lambda_0, main_model_p->lambda_0, main_model_p->dim_lambda_0 * sizeof(double));
  memcpy(output_lambda_1a, main_model_p->lambda_1a, main_model_p->dim_lambda_1a * sizeof(double));
  memcpy(output_lambda_1b, main_model_p->lambda_1b, main_model_p->dim_lambda_1b * sizeof(double));
  memcpy(output_lambda_1c, main_model_p->lambda_1c, main_model_p->dim_lambda_1c * sizeof(double));
  memcpy(output_lambda_1d, main_model_p->lambda_1d, main_model_p->dim_lambda_1d * sizeof(double));
  memcpy(output_lambda_sum_0, main_model_p->lambda_sum_0, main_model_p->dim_lambda_sum_0 * sizeof(double));
  memcpy(output_lambda_sum_1a, main_model_p->lambda_sum_1a, main_model_p->dim_lambda_sum_1a * sizeof(double));
  memcpy(output_lambda_sum_1b, main_model_p->lambda_sum_1b, main_model_p->dim_lambda_sum_1b * sizeof(double));
  memcpy(output_lambda_sum_1c, main_model_p->lambda_sum_1c, main_model_p->dim_lambda_sum_1c * sizeof(double));
  memcpy(output_lambda_sum_1d, main_model_p->lambda_sum_1d, main_model_p->dim_lambda_sum_1d * sizeof(double));
  memcpy(output_p_noncomm, main_model_p->p_noncomm, main_model_p->dim_p_noncomm * sizeof(double));
  memcpy(output_M_noncomm, main_model_p->M_noncomm, main_model_p->dim_M_noncomm * sizeof(double));
  for (int i = 0; i < main_model_p->dim_in_S0_1; ++i) {
    for (int j = 0; j < main_model_p->dim_in_S0_2; ++j) {
      main_model_p->in_S0[i + j * main_model_p->dim_in_S0_1] = (i == j ? 0 : main_model_p->rate_move_in[i + j * main_model_p->dim_rate_move_in_1] * S0[j]);
    }
  }
  for (int i = 0; i < main_model_p->dim_sum_in_S0; ++i) {
    main_model_p->sum_in_S0[i] = odin_sum2(main_model_p->in_S0, i, i, 0, main_model_p->dim_in_S0_2 - 1, main_model_p->dim_in_S0_1);
  }
  memcpy(output_sum_in_S0, main_model_p->sum_in_S0, main_model_p->dim_sum_in_S0 * sizeof(double));
  memcpy(output_rate_move_in, main_model_p->rate_move_in, main_model_p->dim_rate_move_in * sizeof(double));
  memcpy(output_rate_move_out, main_model_p->rate_move_out, main_model_p->dim_rate_move_out * sizeof(double));
}

// deSolve interface
// Global variable set on initmod, as per deSolve design
static main_model_pars *main_model_p;
void main_model_initmod_ds(void(* odeparms) (int *, double *)) {
  DL_FUNC get_deSolve_gparms = R_GetCCallable("deSolve", "get_deSolve_gparms");
  main_model_p = main_model_get_pointer(get_deSolve_gparms(), 1);
}
void main_model_deriv_ds(int *neq, double *t, double *state,
                         double *dstatedt, double *output, int *np) {
  main_model_deriv(main_model_p, *t, state, dstatedt, output);
}

// dde interface
void main_model_deriv_dde(size_t n_eq, double t, double *state,
                           double *dstatedt, void *main_model_p) {
  main_model_deriv((main_model_pars*)main_model_p, t, state, dstatedt, NULL);
}

void main_model_output_dde(size_t n_eq, double t, double *state,
                           size_t dim_output, double *output, void *main_model_p) {
  main_model_output((main_model_pars*)main_model_p, t, state, output);
}

SEXP main_model_deriv_r(SEXP main_model_ptr, SEXP t, SEXP state) {
  SEXP dstatedt = PROTECT(allocVector(REALSXP, LENGTH(state)));
  main_model_pars *main_model_p = main_model_get_pointer(main_model_ptr, 1);
  SEXP output_ptr = PROTECT(allocVector(REALSXP, main_model_p->dim_output));
  setAttrib(dstatedt, install("output"), output_ptr);
  double *output = REAL(output_ptr);
  main_model_deriv(main_model_p, REAL(t)[0], REAL(state), REAL(dstatedt), output);
  UNPROTECT(2);
  return dstatedt;
}

// Translate all elements in the struct back to R
// This will mostly be useful for debugging.
SEXP main_model_contents(SEXP main_model_ptr) {
  main_model_pars *main_model_p = main_model_get_pointer(main_model_ptr, 1);
  SEXP state = PROTECT(allocVector(VECSXP, 617));
  SET_VECTOR_ELT(state, 0, ScalarInteger(main_model_p->odin_use_dde));
  SET_VECTOR_ELT(state, 1, ScalarReal(main_model_p->replaceDeaths));
  SET_VECTOR_ELT(state, 2, ScalarInteger(main_model_p->dim_c_t_comm));
  SET_VECTOR_ELT(state, 3, allocVector(REALSXP, main_model_p->dim_c_t_comm));
  memcpy(REAL(VECTOR_ELT(state, 3)), main_model_p->c_t_comm, main_model_p->dim_c_t_comm * sizeof(double));
  SET_VECTOR_ELT(state, 4, ScalarInteger(main_model_p->dim_c_t_noncomm));
  SET_VECTOR_ELT(state, 5, allocVector(REALSXP, main_model_p->dim_c_t_noncomm));
  memcpy(REAL(VECTOR_ELT(state, 5)), main_model_p->c_t_noncomm, main_model_p->dim_c_t_noncomm * sizeof(double));
  SET_VECTOR_ELT(state, 6, ScalarInteger(main_model_p->dim_c_y_comm));
  SET_VECTOR_ELT(state, 7, ScalarInteger(main_model_p->dim_c_y_comm_1));
  SET_VECTOR_ELT(state, 8, ScalarInteger(main_model_p->dim_c_y_comm_2));
  SET_VECTOR_ELT(state, 9, allocVector(REALSXP, main_model_p->dim_c_y_comm));
  memcpy(REAL(VECTOR_ELT(state, 9)), main_model_p->c_y_comm, main_model_p->dim_c_y_comm * sizeof(double));
  odin_set_dim(VECTOR_ELT(state, 9), 2, main_model_p->dim_c_y_comm_1, main_model_p->dim_c_y_comm_2);
  SET_VECTOR_ELT(state, 10, ScalarInteger(main_model_p->dim_c_y_noncomm));
  SET_VECTOR_ELT(state, 11, ScalarInteger(main_model_p->dim_c_y_noncomm_1));
  SET_VECTOR_ELT(state, 12, ScalarInteger(main_model_p->dim_c_y_noncomm_2));
  SET_VECTOR_ELT(state, 13, allocVector(REALSXP, main_model_p->dim_c_y_noncomm));
  memcpy(REAL(VECTOR_ELT(state, 13)), main_model_p->c_y_noncomm, main_model_p->dim_c_y_noncomm * sizeof(double));
  odin_set_dim(VECTOR_ELT(state, 13), 2, main_model_p->dim_c_y_noncomm_1, main_model_p->dim_c_y_noncomm_2);
  SET_VECTOR_ELT(state, 14, ScalarReal(main_model_p->who_believe_comm));
  SET_VECTOR_ELT(state, 15, ScalarInteger(main_model_p->dim_testing_prob_t));
  SET_VECTOR_ELT(state, 16, allocVector(REALSXP, main_model_p->dim_testing_prob_t));
  memcpy(REAL(VECTOR_ELT(state, 16)), main_model_p->testing_prob_t, main_model_p->dim_testing_prob_t * sizeof(double));
  SET_VECTOR_ELT(state, 17, ScalarInteger(main_model_p->dim_testing_prob_y));
  SET_VECTOR_ELT(state, 18, ScalarInteger(main_model_p->dim_testing_prob_y_1));
  SET_VECTOR_ELT(state, 19, ScalarInteger(main_model_p->dim_testing_prob_y_2));
  SET_VECTOR_ELT(state, 20, allocVector(REALSXP, main_model_p->dim_testing_prob_y));
  memcpy(REAL(VECTOR_ELT(state, 20)), main_model_p->testing_prob_y, main_model_p->dim_testing_prob_y * sizeof(double));
  odin_set_dim(VECTOR_ELT(state, 20), 2, main_model_p->dim_testing_prob_y_1, main_model_p->dim_testing_prob_y_2);
  SET_VECTOR_ELT(state, 21, ScalarInteger(main_model_p->dim_ART_prob_t));
  SET_VECTOR_ELT(state, 22, allocVector(REALSXP, main_model_p->dim_ART_prob_t));
  memcpy(REAL(VECTOR_ELT(state, 22)), main_model_p->ART_prob_t, main_model_p->dim_ART_prob_t * sizeof(double));
  SET_VECTOR_ELT(state, 23, ScalarInteger(main_model_p->dim_ART_prob_y));
  SET_VECTOR_ELT(state, 24, ScalarInteger(main_model_p->dim_ART_prob_y_1));
  SET_VECTOR_ELT(state, 25, ScalarInteger(main_model_p->dim_ART_prob_y_2));
  SET_VECTOR_ELT(state, 26, allocVector(REALSXP, main_model_p->dim_ART_prob_y));
  memcpy(REAL(VECTOR_ELT(state, 26)), main_model_p->ART_prob_y, main_model_p->dim_ART_prob_y * sizeof(double));
  odin_set_dim(VECTOR_ELT(state, 26), 2, main_model_p->dim_ART_prob_y_1, main_model_p->dim_ART_prob_y_2);
  SET_VECTOR_ELT(state, 27, ScalarReal(main_model_p->RR_test_onPrEP));
  SET_VECTOR_ELT(state, 28, ScalarReal(main_model_p->RR_test_CD4200));
  SET_VECTOR_ELT(state, 29, ScalarReal(main_model_p->RR_ART_CD4200));
  SET_VECTOR_ELT(state, 30, ScalarInteger(main_model_p->Ncat));
  SET_VECTOR_ELT(state, 31, ScalarReal(main_model_p->Nage));
  SET_VECTOR_ELT(state, 32, ScalarReal(main_model_p->infect_ART));
  SET_VECTOR_ELT(state, 33, ScalarReal(main_model_p->infect_acute));
  SET_VECTOR_ELT(state, 34, ScalarReal(main_model_p->infect_AIDS));
  SET_VECTOR_ELT(state, 35, ScalarReal(main_model_p->R));
  SET_VECTOR_ELT(state, 36, ScalarInteger(main_model_p->dim_epsilon_t));
  SET_VECTOR_ELT(state, 37, allocVector(REALSXP, main_model_p->dim_epsilon_t));
  memcpy(REAL(VECTOR_ELT(state, 37)), main_model_p->epsilon_t, main_model_p->dim_epsilon_t * sizeof(double));
  SET_VECTOR_ELT(state, 38, ScalarInteger(main_model_p->dim_epsilon_y));
  SET_VECTOR_ELT(state, 39, allocVector(REALSXP, main_model_p->dim_epsilon_y));
  memcpy(REAL(VECTOR_ELT(state, 39)), main_model_p->epsilon_y, main_model_p->dim_epsilon_y * sizeof(double));
  SET_VECTOR_ELT(state, 40, ScalarInteger(main_model_p->dim_fc_t_comm));
  SET_VECTOR_ELT(state, 41, allocVector(REALSXP, main_model_p->dim_fc_t_comm));
  memcpy(REAL(VECTOR_ELT(state, 41)), main_model_p->fc_t_comm, main_model_p->dim_fc_t_comm * sizeof(double));
  SET_VECTOR_ELT(state, 42, ScalarInteger(main_model_p->dim_fc_y_comm));
  SET_VECTOR_ELT(state, 43, ScalarInteger(main_model_p->dim_fc_y_comm_1));
  SET_VECTOR_ELT(state, 44, ScalarInteger(main_model_p->dim_fc_y_comm_2));
  SET_VECTOR_ELT(state, 45, ScalarInteger(main_model_p->dim_fc_y_comm_3));
  SET_VECTOR_ELT(state, 46, ScalarInteger(main_model_p->dim_fc_y_comm_12));
  SET_VECTOR_ELT(state, 47, allocVector(REALSXP, main_model_p->dim_fc_y_comm));
  memcpy(REAL(VECTOR_ELT(state, 47)), main_model_p->fc_y_comm, main_model_p->dim_fc_y_comm * sizeof(double));
  odin_set_dim(VECTOR_ELT(state, 47), 3, main_model_p->dim_fc_y_comm_1, main_model_p->dim_fc_y_comm_2, main_model_p->dim_fc_y_comm_3);
  SET_VECTOR_ELT(state, 48, ScalarInteger(main_model_p->dim_fP_t_comm));
  SET_VECTOR_ELT(state, 49, allocVector(REALSXP, main_model_p->dim_fP_t_comm));
  memcpy(REAL(VECTOR_ELT(state, 49)), main_model_p->fP_t_comm, main_model_p->dim_fP_t_comm * sizeof(double));
  SET_VECTOR_ELT(state, 50, ScalarInteger(main_model_p->dim_fP_y_comm));
  SET_VECTOR_ELT(state, 51, ScalarInteger(main_model_p->dim_fP_y_comm_1));
  SET_VECTOR_ELT(state, 52, ScalarInteger(main_model_p->dim_fP_y_comm_2));
  SET_VECTOR_ELT(state, 53, allocVector(REALSXP, main_model_p->dim_fP_y_comm));
  memcpy(REAL(VECTOR_ELT(state, 53)), main_model_p->fP_y_comm, main_model_p->dim_fP_y_comm * sizeof(double));
  odin_set_dim(VECTOR_ELT(state, 53), 2, main_model_p->dim_fP_y_comm_1, main_model_p->dim_fP_y_comm_2);
  SET_VECTOR_ELT(state, 54, ScalarInteger(main_model_p->dim_fc_t_noncomm));
  SET_VECTOR_ELT(state, 55, allocVector(REALSXP, main_model_p->dim_fc_t_noncomm));
  memcpy(REAL(VECTOR_ELT(state, 55)), main_model_p->fc_t_noncomm, main_model_p->dim_fc_t_noncomm * sizeof(double));
  SET_VECTOR_ELT(state, 56, ScalarInteger(main_model_p->dim_fc_y_noncomm));
  SET_VECTOR_ELT(state, 57, ScalarInteger(main_model_p->dim_fc_y_noncomm_1));
  SET_VECTOR_ELT(state, 58, ScalarInteger(main_model_p->dim_fc_y_noncomm_2));
  SET_VECTOR_ELT(state, 59, ScalarInteger(main_model_p->dim_fc_y_noncomm_3));
  SET_VECTOR_ELT(state, 60, ScalarInteger(main_model_p->dim_fc_y_noncomm_12));
  SET_VECTOR_ELT(state, 61, allocVector(REALSXP, main_model_p->dim_fc_y_noncomm));
  memcpy(REAL(VECTOR_ELT(state, 61)), main_model_p->fc_y_noncomm, main_model_p->dim_fc_y_noncomm * sizeof(double));
  odin_set_dim(VECTOR_ELT(state, 61), 3, main_model_p->dim_fc_y_noncomm_1, main_model_p->dim_fc_y_noncomm_2, main_model_p->dim_fc_y_noncomm_3);
  SET_VECTOR_ELT(state, 62, ScalarInteger(main_model_p->dim_fP_t_noncomm));
  SET_VECTOR_ELT(state, 63, allocVector(REALSXP, main_model_p->dim_fP_t_noncomm));
  memcpy(REAL(VECTOR_ELT(state, 63)), main_model_p->fP_t_noncomm, main_model_p->dim_fP_t_noncomm * sizeof(double));
  SET_VECTOR_ELT(state, 64, ScalarInteger(main_model_p->dim_fP_y_noncomm));
  SET_VECTOR_ELT(state, 65, ScalarInteger(main_model_p->dim_fP_y_noncomm_1));
  SET_VECTOR_ELT(state, 66, ScalarInteger(main_model_p->dim_fP_y_noncomm_2));
  SET_VECTOR_ELT(state, 67, allocVector(REALSXP, main_model_p->dim_fP_y_noncomm));
  memcpy(REAL(VECTOR_ELT(state, 67)), main_model_p->fP_y_noncomm, main_model_p->dim_fP_y_noncomm * sizeof(double));
  odin_set_dim(VECTOR_ELT(state, 67), 2, main_model_p->dim_fP_y_noncomm_1, main_model_p->dim_fP_y_noncomm_2);
  SET_VECTOR_ELT(state, 68, ScalarReal(main_model_p->dur_FSW));
  SET_VECTOR_ELT(state, 69, ScalarInteger(main_model_p->dim_zetaa_t));
  SET_VECTOR_ELT(state, 70, allocVector(REALSXP, main_model_p->dim_zetaa_t));
  memcpy(REAL(VECTOR_ELT(state, 70)), main_model_p->zetaa_t, main_model_p->dim_zetaa_t * sizeof(double));
  SET_VECTOR_ELT(state, 71, ScalarInteger(main_model_p->dim_zetab_t));
  SET_VECTOR_ELT(state, 72, allocVector(REALSXP, main_model_p->dim_zetab_t));
  memcpy(REAL(VECTOR_ELT(state, 72)), main_model_p->zetab_t, main_model_p->dim_zetab_t * sizeof(double));
  SET_VECTOR_ELT(state, 73, ScalarInteger(main_model_p->dim_zetac_t));
  SET_VECTOR_ELT(state, 74, allocVector(REALSXP, main_model_p->dim_zetac_t));
  memcpy(REAL(VECTOR_ELT(state, 74)), main_model_p->zetac_t, main_model_p->dim_zetac_t * sizeof(double));
  SET_VECTOR_ELT(state, 75, ScalarInteger(main_model_p->dim_zetaa_y));
  SET_VECTOR_ELT(state, 76, ScalarInteger(main_model_p->dim_zetaa_y_1));
  SET_VECTOR_ELT(state, 77, ScalarInteger(main_model_p->dim_zetaa_y_2));
  SET_VECTOR_ELT(state, 78, allocVector(REALSXP, main_model_p->dim_zetaa_y));
  memcpy(REAL(VECTOR_ELT(state, 78)), main_model_p->zetaa_y, main_model_p->dim_zetaa_y * sizeof(double));
  odin_set_dim(VECTOR_ELT(state, 78), 2, main_model_p->dim_zetaa_y_1, main_model_p->dim_zetaa_y_2);
  SET_VECTOR_ELT(state, 79, ScalarInteger(main_model_p->dim_zetab_y));
  SET_VECTOR_ELT(state, 80, ScalarInteger(main_model_p->dim_zetab_y_1));
  SET_VECTOR_ELT(state, 81, ScalarInteger(main_model_p->dim_zetab_y_2));
  SET_VECTOR_ELT(state, 82, allocVector(REALSXP, main_model_p->dim_zetab_y));
  memcpy(REAL(VECTOR_ELT(state, 82)), main_model_p->zetab_y, main_model_p->dim_zetab_y * sizeof(double));
  odin_set_dim(VECTOR_ELT(state, 82), 2, main_model_p->dim_zetab_y_1, main_model_p->dim_zetab_y_2);
  SET_VECTOR_ELT(state, 83, ScalarInteger(main_model_p->dim_zetac_y));
  SET_VECTOR_ELT(state, 84, ScalarInteger(main_model_p->dim_zetac_y_1));
  SET_VECTOR_ELT(state, 85, ScalarInteger(main_model_p->dim_zetac_y_2));
  SET_VECTOR_ELT(state, 86, allocVector(REALSXP, main_model_p->dim_zetac_y));
  memcpy(REAL(VECTOR_ELT(state, 86)), main_model_p->zetac_y, main_model_p->dim_zetac_y * sizeof(double));
  odin_set_dim(VECTOR_ELT(state, 86), 2, main_model_p->dim_zetac_y_1, main_model_p->dim_zetac_y_2);
  SET_VECTOR_ELT(state, 87, ScalarInteger(main_model_p->dim_c_comm));
  SET_VECTOR_ELT(state, 88, allocVector(REALSXP, main_model_p->dim_c_comm));
  memcpy(REAL(VECTOR_ELT(state, 88)), main_model_p->c_comm, main_model_p->dim_c_comm * sizeof(double));
  SET_VECTOR_ELT(state, 89, ScalarInteger(main_model_p->offset_output_c_comm));
  SET_VECTOR_ELT(state, 90, ScalarInteger(main_model_p->dim_c_noncomm));
  SET_VECTOR_ELT(state, 91, allocVector(REALSXP, main_model_p->dim_c_noncomm));
  memcpy(REAL(VECTOR_ELT(state, 91)), main_model_p->c_noncomm, main_model_p->dim_c_noncomm * sizeof(double));
  SET_VECTOR_ELT(state, 92, ScalarInteger(main_model_p->offset_output_c_noncomm));
  SET_VECTOR_ELT(state, 93, ScalarInteger(main_model_p->dim_new_people_in_group));
  SET_VECTOR_ELT(state, 94, allocVector(REALSXP, main_model_p->dim_new_people_in_group));
  memcpy(REAL(VECTOR_ELT(state, 94)), main_model_p->new_people_in_group, main_model_p->dim_new_people_in_group * sizeof(double));
  SET_VECTOR_ELT(state, 95, ScalarInteger(main_model_p->offset_output_new_people_in_group));
  SET_VECTOR_ELT(state, 96, ScalarInteger(main_model_p->dim_comm_partnerships_requested));
  SET_VECTOR_ELT(state, 97, ScalarInteger(main_model_p->dim_comm_partnerships_requested_1));
  SET_VECTOR_ELT(state, 98, ScalarInteger(main_model_p->dim_comm_partnerships_requested_2));
  SET_VECTOR_ELT(state, 99, allocVector(REALSXP, main_model_p->dim_comm_partnerships_requested));
  memcpy(REAL(VECTOR_ELT(state, 99)), main_model_p->comm_partnerships_requested, main_model_p->dim_comm_partnerships_requested * sizeof(double));
  odin_set_dim(VECTOR_ELT(state, 99), 2, main_model_p->dim_comm_partnerships_requested_1, main_model_p->dim_comm_partnerships_requested_2);
  SET_VECTOR_ELT(state, 100, ScalarInteger(main_model_p->dim_noncomm_partnerships_requested));
  SET_VECTOR_ELT(state, 101, ScalarInteger(main_model_p->dim_noncomm_partnerships_requested_1));
  SET_VECTOR_ELT(state, 102, ScalarInteger(main_model_p->dim_noncomm_partnerships_requested_2));
  SET_VECTOR_ELT(state, 103, allocVector(REALSXP, main_model_p->dim_noncomm_partnerships_requested));
  memcpy(REAL(VECTOR_ELT(state, 103)), main_model_p->noncomm_partnerships_requested, main_model_p->dim_noncomm_partnerships_requested * sizeof(double));
  odin_set_dim(VECTOR_ELT(state, 103), 2, main_model_p->dim_noncomm_partnerships_requested_1, main_model_p->dim_noncomm_partnerships_requested_2);
  SET_VECTOR_ELT(state, 104, ScalarInteger(main_model_p->dim_testing_prob));
  SET_VECTOR_ELT(state, 105, allocVector(REALSXP, main_model_p->dim_testing_prob));
  memcpy(REAL(VECTOR_ELT(state, 105)), main_model_p->testing_prob, main_model_p->dim_testing_prob * sizeof(double));
  SET_VECTOR_ELT(state, 106, ScalarInteger(main_model_p->offset_output_testing_prob));
  SET_VECTOR_ELT(state, 107, ScalarInteger(main_model_p->dim_ART_prob));
  SET_VECTOR_ELT(state, 108, allocVector(REALSXP, main_model_p->dim_ART_prob));
  memcpy(REAL(VECTOR_ELT(state, 108)), main_model_p->ART_prob, main_model_p->dim_ART_prob * sizeof(double));
  SET_VECTOR_ELT(state, 109, ScalarInteger(main_model_p->offset_output_ART_prob));
  SET_VECTOR_ELT(state, 110, ScalarInteger(main_model_p->dim_tau));
  SET_VECTOR_ELT(state, 111, allocVector(REALSXP, main_model_p->dim_tau));
  memcpy(REAL(VECTOR_ELT(state, 111)), main_model_p->tau, main_model_p->dim_tau * sizeof(double));
  SET_VECTOR_ELT(state, 112, ScalarInteger(main_model_p->offset_output_tau));
  SET_VECTOR_ELT(state, 113, ScalarInteger(main_model_p->dim_rho));
  SET_VECTOR_ELT(state, 114, allocVector(REALSXP, main_model_p->dim_rho));
  memcpy(REAL(VECTOR_ELT(state, 114)), main_model_p->rho, main_model_p->dim_rho * sizeof(double));
  SET_VECTOR_ELT(state, 115, ScalarInteger(main_model_p->offset_output_rho));
  SET_VECTOR_ELT(state, 116, ScalarInteger(main_model_p->dim_frac_F));
  SET_VECTOR_ELT(state, 117, allocVector(REALSXP, main_model_p->dim_frac_F));
  memcpy(REAL(VECTOR_ELT(state, 117)), main_model_p->frac_F, main_model_p->dim_frac_F * sizeof(double));
  SET_VECTOR_ELT(state, 118, ScalarInteger(main_model_p->offset_output_frac_F));
  SET_VECTOR_ELT(state, 119, ScalarInteger(main_model_p->dim_frac_N_sexualpop));
  SET_VECTOR_ELT(state, 120, allocVector(REALSXP, main_model_p->dim_frac_N_sexualpop));
  memcpy(REAL(VECTOR_ELT(state, 120)), main_model_p->frac_N_sexualpop, main_model_p->dim_frac_N_sexualpop * sizeof(double));
  SET_VECTOR_ELT(state, 121, ScalarInteger(main_model_p->offset_output_frac_N_sexualpop));
  SET_VECTOR_ELT(state, 122, ScalarInteger(main_model_p->dim_zetaa));
  SET_VECTOR_ELT(state, 123, allocVector(REALSXP, main_model_p->dim_zetaa));
  memcpy(REAL(VECTOR_ELT(state, 123)), main_model_p->zetaa, main_model_p->dim_zetaa * sizeof(double));
  SET_VECTOR_ELT(state, 124, ScalarInteger(main_model_p->offset_output_zetaa));
  SET_VECTOR_ELT(state, 125, ScalarInteger(main_model_p->dim_zetab));
  SET_VECTOR_ELT(state, 126, allocVector(REALSXP, main_model_p->dim_zetab));
  memcpy(REAL(VECTOR_ELT(state, 126)), main_model_p->zetab, main_model_p->dim_zetab * sizeof(double));
  SET_VECTOR_ELT(state, 127, ScalarInteger(main_model_p->offset_output_zetab));
  SET_VECTOR_ELT(state, 128, ScalarInteger(main_model_p->dim_zetac));
  SET_VECTOR_ELT(state, 129, allocVector(REALSXP, main_model_p->dim_zetac));
  memcpy(REAL(VECTOR_ELT(state, 129)), main_model_p->zetac, main_model_p->dim_zetac * sizeof(double));
  SET_VECTOR_ELT(state, 130, ScalarInteger(main_model_p->offset_output_zetac));
  SET_VECTOR_ELT(state, 131, ScalarInteger(main_model_p->dim_omega));
  SET_VECTOR_ELT(state, 132, allocVector(REALSXP, main_model_p->dim_omega));
  memcpy(REAL(VECTOR_ELT(state, 132)), main_model_p->omega, main_model_p->dim_omega * sizeof(double));
  SET_VECTOR_ELT(state, 133, ScalarInteger(main_model_p->offset_output_omega));
  SET_VECTOR_ELT(state, 134, ScalarInteger(main_model_p->dim_frac_N));
  SET_VECTOR_ELT(state, 135, allocVector(REALSXP, main_model_p->dim_frac_N));
  memcpy(REAL(VECTOR_ELT(state, 135)), main_model_p->frac_N, main_model_p->dim_frac_N * sizeof(double));
  SET_VECTOR_ELT(state, 136, ScalarInteger(main_model_p->offset_output_frac_N));
  SET_VECTOR_ELT(state, 137, ScalarInteger(main_model_p->dim_mu));
  SET_VECTOR_ELT(state, 138, allocVector(REALSXP, main_model_p->dim_mu));
  memcpy(REAL(VECTOR_ELT(state, 138)), main_model_p->mu, main_model_p->dim_mu * sizeof(double));
  SET_VECTOR_ELT(state, 139, ScalarInteger(main_model_p->offset_output_mu));
  SET_VECTOR_ELT(state, 140, ScalarInteger(main_model_p->dim_gamma01));
  SET_VECTOR_ELT(state, 141, allocVector(REALSXP, main_model_p->dim_gamma01));
  memcpy(REAL(VECTOR_ELT(state, 141)), main_model_p->gamma01, main_model_p->dim_gamma01 * sizeof(double));
  SET_VECTOR_ELT(state, 142, ScalarInteger(main_model_p->offset_output_gamma01));
  SET_VECTOR_ELT(state, 143, ScalarInteger(main_model_p->dim_gamma02));
  SET_VECTOR_ELT(state, 144, allocVector(REALSXP, main_model_p->dim_gamma02));
  memcpy(REAL(VECTOR_ELT(state, 144)), main_model_p->gamma02, main_model_p->dim_gamma02 * sizeof(double));
  SET_VECTOR_ELT(state, 145, ScalarInteger(main_model_p->dim_gamma03));
  SET_VECTOR_ELT(state, 146, allocVector(REALSXP, main_model_p->dim_gamma03));
  memcpy(REAL(VECTOR_ELT(state, 146)), main_model_p->gamma03, main_model_p->dim_gamma03 * sizeof(double));
  SET_VECTOR_ELT(state, 147, ScalarInteger(main_model_p->dim_gamma04));
  SET_VECTOR_ELT(state, 148, allocVector(REALSXP, main_model_p->dim_gamma04));
  memcpy(REAL(VECTOR_ELT(state, 148)), main_model_p->gamma04, main_model_p->dim_gamma04 * sizeof(double));
  SET_VECTOR_ELT(state, 149, ScalarInteger(main_model_p->dim_gamma11));
  SET_VECTOR_ELT(state, 150, allocVector(REALSXP, main_model_p->dim_gamma11));
  memcpy(REAL(VECTOR_ELT(state, 150)), main_model_p->gamma11, main_model_p->dim_gamma11 * sizeof(double));
  SET_VECTOR_ELT(state, 151, ScalarInteger(main_model_p->dim_gamma22));
  SET_VECTOR_ELT(state, 152, allocVector(REALSXP, main_model_p->dim_gamma22));
  memcpy(REAL(VECTOR_ELT(state, 152)), main_model_p->gamma22, main_model_p->dim_gamma22 * sizeof(double));
  SET_VECTOR_ELT(state, 153, ScalarInteger(main_model_p->dim_gamma23));
  SET_VECTOR_ELT(state, 154, allocVector(REALSXP, main_model_p->dim_gamma23));
  memcpy(REAL(VECTOR_ELT(state, 154)), main_model_p->gamma23, main_model_p->dim_gamma23 * sizeof(double));
  SET_VECTOR_ELT(state, 155, ScalarInteger(main_model_p->dim_gamma24));
  SET_VECTOR_ELT(state, 156, allocVector(REALSXP, main_model_p->dim_gamma24));
  memcpy(REAL(VECTOR_ELT(state, 156)), main_model_p->gamma24, main_model_p->dim_gamma24 * sizeof(double));
  SET_VECTOR_ELT(state, 157, ScalarInteger(main_model_p->dim_gamma32));
  SET_VECTOR_ELT(state, 158, allocVector(REALSXP, main_model_p->dim_gamma32));
  memcpy(REAL(VECTOR_ELT(state, 158)), main_model_p->gamma32, main_model_p->dim_gamma32 * sizeof(double));
  SET_VECTOR_ELT(state, 159, ScalarInteger(main_model_p->dim_gamma33));
  SET_VECTOR_ELT(state, 160, allocVector(REALSXP, main_model_p->dim_gamma33));
  memcpy(REAL(VECTOR_ELT(state, 160)), main_model_p->gamma33, main_model_p->dim_gamma33 * sizeof(double));
  SET_VECTOR_ELT(state, 161, ScalarInteger(main_model_p->dim_gamma34));
  SET_VECTOR_ELT(state, 162, allocVector(REALSXP, main_model_p->dim_gamma34));
  memcpy(REAL(VECTOR_ELT(state, 162)), main_model_p->gamma34, main_model_p->dim_gamma34 * sizeof(double));
  SET_VECTOR_ELT(state, 163, ScalarInteger(main_model_p->dim_gamma42));
  SET_VECTOR_ELT(state, 164, allocVector(REALSXP, main_model_p->dim_gamma42));
  memcpy(REAL(VECTOR_ELT(state, 164)), main_model_p->gamma42, main_model_p->dim_gamma42 * sizeof(double));
  SET_VECTOR_ELT(state, 165, ScalarInteger(main_model_p->dim_gamma43));
  SET_VECTOR_ELT(state, 166, allocVector(REALSXP, main_model_p->dim_gamma43));
  memcpy(REAL(VECTOR_ELT(state, 166)), main_model_p->gamma43, main_model_p->dim_gamma43 * sizeof(double));
  SET_VECTOR_ELT(state, 167, ScalarInteger(main_model_p->dim_gamma44));
  SET_VECTOR_ELT(state, 168, allocVector(REALSXP, main_model_p->dim_gamma44));
  memcpy(REAL(VECTOR_ELT(state, 168)), main_model_p->gamma44, main_model_p->dim_gamma44 * sizeof(double));
  SET_VECTOR_ELT(state, 169, ScalarInteger(main_model_p->dim_phi2));
  SET_VECTOR_ELT(state, 170, allocVector(REALSXP, main_model_p->dim_phi2));
  memcpy(REAL(VECTOR_ELT(state, 170)), main_model_p->phi2, main_model_p->dim_phi2 * sizeof(double));
  SET_VECTOR_ELT(state, 171, ScalarInteger(main_model_p->dim_phi3));
  SET_VECTOR_ELT(state, 172, allocVector(REALSXP, main_model_p->dim_phi3));
  memcpy(REAL(VECTOR_ELT(state, 172)), main_model_p->phi3, main_model_p->dim_phi3 * sizeof(double));
  SET_VECTOR_ELT(state, 173, ScalarInteger(main_model_p->dim_phi4));
  SET_VECTOR_ELT(state, 174, allocVector(REALSXP, main_model_p->dim_phi4));
  memcpy(REAL(VECTOR_ELT(state, 174)), main_model_p->phi4, main_model_p->dim_phi4 * sizeof(double));
  SET_VECTOR_ELT(state, 175, ScalarInteger(main_model_p->dim_phi5));
  SET_VECTOR_ELT(state, 176, allocVector(REALSXP, main_model_p->dim_phi5));
  memcpy(REAL(VECTOR_ELT(state, 176)), main_model_p->phi5, main_model_p->dim_phi5 * sizeof(double));
  SET_VECTOR_ELT(state, 177, ScalarInteger(main_model_p->dim_psia));
  SET_VECTOR_ELT(state, 178, allocVector(REALSXP, main_model_p->dim_psia));
  memcpy(REAL(VECTOR_ELT(state, 178)), main_model_p->psia, main_model_p->dim_psia * sizeof(double));
  SET_VECTOR_ELT(state, 179, ScalarInteger(main_model_p->dim_psib));
  SET_VECTOR_ELT(state, 180, allocVector(REALSXP, main_model_p->dim_psib));
  memcpy(REAL(VECTOR_ELT(state, 180)), main_model_p->psib, main_model_p->dim_psib * sizeof(double));
  SET_VECTOR_ELT(state, 181, ScalarInteger(main_model_p->dim_kappaa));
  SET_VECTOR_ELT(state, 182, allocVector(REALSXP, main_model_p->dim_kappaa));
  memcpy(REAL(VECTOR_ELT(state, 182)), main_model_p->kappaa, main_model_p->dim_kappaa * sizeof(double));
  SET_VECTOR_ELT(state, 183, ScalarInteger(main_model_p->offset_output_kappaa));
  SET_VECTOR_ELT(state, 184, ScalarInteger(main_model_p->dim_kappab));
  SET_VECTOR_ELT(state, 185, allocVector(REALSXP, main_model_p->dim_kappab));
  memcpy(REAL(VECTOR_ELT(state, 185)), main_model_p->kappab, main_model_p->dim_kappab * sizeof(double));
  SET_VECTOR_ELT(state, 186, ScalarInteger(main_model_p->offset_output_kappab));
  SET_VECTOR_ELT(state, 187, ScalarInteger(main_model_p->dim_kappac));
  SET_VECTOR_ELT(state, 188, allocVector(REALSXP, main_model_p->dim_kappac));
  memcpy(REAL(VECTOR_ELT(state, 188)), main_model_p->kappac, main_model_p->dim_kappac * sizeof(double));
  SET_VECTOR_ELT(state, 189, ScalarInteger(main_model_p->offset_output_kappac));
  SET_VECTOR_ELT(state, 190, ScalarInteger(main_model_p->dim_alpha01));
  SET_VECTOR_ELT(state, 191, allocVector(REALSXP, main_model_p->dim_alpha01));
  memcpy(REAL(VECTOR_ELT(state, 191)), main_model_p->alpha01, main_model_p->dim_alpha01 * sizeof(double));
  SET_VECTOR_ELT(state, 192, ScalarInteger(main_model_p->dim_alpha02));
  SET_VECTOR_ELT(state, 193, allocVector(REALSXP, main_model_p->dim_alpha02));
  memcpy(REAL(VECTOR_ELT(state, 193)), main_model_p->alpha02, main_model_p->dim_alpha02 * sizeof(double));
  SET_VECTOR_ELT(state, 194, ScalarInteger(main_model_p->dim_alpha03));
  SET_VECTOR_ELT(state, 195, allocVector(REALSXP, main_model_p->dim_alpha03));
  memcpy(REAL(VECTOR_ELT(state, 195)), main_model_p->alpha03, main_model_p->dim_alpha03 * sizeof(double));
  SET_VECTOR_ELT(state, 196, ScalarInteger(main_model_p->dim_alpha04));
  SET_VECTOR_ELT(state, 197, allocVector(REALSXP, main_model_p->dim_alpha04));
  memcpy(REAL(VECTOR_ELT(state, 197)), main_model_p->alpha04, main_model_p->dim_alpha04 * sizeof(double));
  SET_VECTOR_ELT(state, 198, ScalarInteger(main_model_p->dim_alpha05));
  SET_VECTOR_ELT(state, 199, allocVector(REALSXP, main_model_p->dim_alpha05));
  memcpy(REAL(VECTOR_ELT(state, 199)), main_model_p->alpha05, main_model_p->dim_alpha05 * sizeof(double));
  SET_VECTOR_ELT(state, 200, ScalarInteger(main_model_p->offset_output_alpha05));
  SET_VECTOR_ELT(state, 201, ScalarInteger(main_model_p->dim_alpha11));
  SET_VECTOR_ELT(state, 202, allocVector(REALSXP, main_model_p->dim_alpha11));
  memcpy(REAL(VECTOR_ELT(state, 202)), main_model_p->alpha11, main_model_p->dim_alpha11 * sizeof(double));
  SET_VECTOR_ELT(state, 203, ScalarInteger(main_model_p->dim_alpha22));
  SET_VECTOR_ELT(state, 204, allocVector(REALSXP, main_model_p->dim_alpha22));
  memcpy(REAL(VECTOR_ELT(state, 204)), main_model_p->alpha22, main_model_p->dim_alpha22 * sizeof(double));
  SET_VECTOR_ELT(state, 205, ScalarInteger(main_model_p->dim_alpha23));
  SET_VECTOR_ELT(state, 206, allocVector(REALSXP, main_model_p->dim_alpha23));
  memcpy(REAL(VECTOR_ELT(state, 206)), main_model_p->alpha23, main_model_p->dim_alpha23 * sizeof(double));
  SET_VECTOR_ELT(state, 207, ScalarInteger(main_model_p->dim_alpha24));
  SET_VECTOR_ELT(state, 208, allocVector(REALSXP, main_model_p->dim_alpha24));
  memcpy(REAL(VECTOR_ELT(state, 208)), main_model_p->alpha24, main_model_p->dim_alpha24 * sizeof(double));
  SET_VECTOR_ELT(state, 209, ScalarInteger(main_model_p->dim_alpha25));
  SET_VECTOR_ELT(state, 210, allocVector(REALSXP, main_model_p->dim_alpha25));
  memcpy(REAL(VECTOR_ELT(state, 210)), main_model_p->alpha25, main_model_p->dim_alpha25 * sizeof(double));
  SET_VECTOR_ELT(state, 211, ScalarInteger(main_model_p->dim_alpha32));
  SET_VECTOR_ELT(state, 212, allocVector(REALSXP, main_model_p->dim_alpha32));
  memcpy(REAL(VECTOR_ELT(state, 212)), main_model_p->alpha32, main_model_p->dim_alpha32 * sizeof(double));
  SET_VECTOR_ELT(state, 213, ScalarInteger(main_model_p->dim_alpha33));
  SET_VECTOR_ELT(state, 214, allocVector(REALSXP, main_model_p->dim_alpha33));
  memcpy(REAL(VECTOR_ELT(state, 214)), main_model_p->alpha33, main_model_p->dim_alpha33 * sizeof(double));
  SET_VECTOR_ELT(state, 215, ScalarInteger(main_model_p->dim_alpha34));
  SET_VECTOR_ELT(state, 216, allocVector(REALSXP, main_model_p->dim_alpha34));
  memcpy(REAL(VECTOR_ELT(state, 216)), main_model_p->alpha34, main_model_p->dim_alpha34 * sizeof(double));
  SET_VECTOR_ELT(state, 217, ScalarInteger(main_model_p->dim_alpha35));
  SET_VECTOR_ELT(state, 218, allocVector(REALSXP, main_model_p->dim_alpha35));
  memcpy(REAL(VECTOR_ELT(state, 218)), main_model_p->alpha35, main_model_p->dim_alpha35 * sizeof(double));
  SET_VECTOR_ELT(state, 219, ScalarInteger(main_model_p->offset_output_alpha35));
  SET_VECTOR_ELT(state, 220, ScalarInteger(main_model_p->dim_alpha42));
  SET_VECTOR_ELT(state, 221, allocVector(REALSXP, main_model_p->dim_alpha42));
  memcpy(REAL(VECTOR_ELT(state, 221)), main_model_p->alpha42, main_model_p->dim_alpha42 * sizeof(double));
  SET_VECTOR_ELT(state, 222, ScalarInteger(main_model_p->dim_alpha43));
  SET_VECTOR_ELT(state, 223, allocVector(REALSXP, main_model_p->dim_alpha43));
  memcpy(REAL(VECTOR_ELT(state, 223)), main_model_p->alpha43, main_model_p->dim_alpha43 * sizeof(double));
  SET_VECTOR_ELT(state, 224, ScalarInteger(main_model_p->dim_alpha44));
  SET_VECTOR_ELT(state, 225, allocVector(REALSXP, main_model_p->dim_alpha44));
  memcpy(REAL(VECTOR_ELT(state, 225)), main_model_p->alpha44, main_model_p->dim_alpha44 * sizeof(double));
  SET_VECTOR_ELT(state, 226, ScalarInteger(main_model_p->dim_alpha45));
  SET_VECTOR_ELT(state, 227, allocVector(REALSXP, main_model_p->dim_alpha45));
  memcpy(REAL(VECTOR_ELT(state, 227)), main_model_p->alpha45, main_model_p->dim_alpha45 * sizeof(double));
  SET_VECTOR_ELT(state, 228, ScalarInteger(main_model_p->dim_beta_comm));
  SET_VECTOR_ELT(state, 229, allocVector(REALSXP, main_model_p->dim_beta_comm));
  memcpy(REAL(VECTOR_ELT(state, 229)), main_model_p->beta_comm, main_model_p->dim_beta_comm * sizeof(double));
  SET_VECTOR_ELT(state, 230, ScalarInteger(main_model_p->offset_output_beta_comm));
  SET_VECTOR_ELT(state, 231, ScalarInteger(main_model_p->dim_beta_noncomm));
  SET_VECTOR_ELT(state, 232, allocVector(REALSXP, main_model_p->dim_beta_noncomm));
  memcpy(REAL(VECTOR_ELT(state, 232)), main_model_p->beta_noncomm, main_model_p->dim_beta_noncomm * sizeof(double));
  SET_VECTOR_ELT(state, 233, ScalarInteger(main_model_p->offset_output_beta_noncomm));
  SET_VECTOR_ELT(state, 234, ScalarInteger(main_model_p->dim_p_comm));
  SET_VECTOR_ELT(state, 235, ScalarInteger(main_model_p->dim_p_comm_1));
  SET_VECTOR_ELT(state, 236, ScalarInteger(main_model_p->dim_p_comm_2));
  SET_VECTOR_ELT(state, 237, allocVector(REALSXP, main_model_p->dim_p_comm));
  memcpy(REAL(VECTOR_ELT(state, 237)), main_model_p->p_comm, main_model_p->dim_p_comm * sizeof(double));
  odin_set_dim(VECTOR_ELT(state, 237), 2, main_model_p->dim_p_comm_1, main_model_p->dim_p_comm_2);
  SET_VECTOR_ELT(state, 238, ScalarInteger(main_model_p->offset_output_p_comm));
  SET_VECTOR_ELT(state, 239, ScalarInteger(main_model_p->dim_p_noncomm));
  SET_VECTOR_ELT(state, 240, ScalarInteger(main_model_p->dim_p_noncomm_1));
  SET_VECTOR_ELT(state, 241, ScalarInteger(main_model_p->dim_p_noncomm_2));
  SET_VECTOR_ELT(state, 242, allocVector(REALSXP, main_model_p->dim_p_noncomm));
  memcpy(REAL(VECTOR_ELT(state, 242)), main_model_p->p_noncomm, main_model_p->dim_p_noncomm * sizeof(double));
  odin_set_dim(VECTOR_ELT(state, 242), 2, main_model_p->dim_p_noncomm_1, main_model_p->dim_p_noncomm_2);
  SET_VECTOR_ELT(state, 243, ScalarInteger(main_model_p->offset_output_p_noncomm));
  SET_VECTOR_ELT(state, 244, ScalarInteger(main_model_p->dim_ec));
  SET_VECTOR_ELT(state, 245, allocVector(REALSXP, main_model_p->dim_ec));
  memcpy(REAL(VECTOR_ELT(state, 245)), main_model_p->ec, main_model_p->dim_ec * sizeof(double));
  SET_VECTOR_ELT(state, 246, ScalarInteger(main_model_p->dim_eP));
  SET_VECTOR_ELT(state, 247, allocVector(REALSXP, main_model_p->dim_eP));
  memcpy(REAL(VECTOR_ELT(state, 247)), main_model_p->eP, main_model_p->dim_eP * sizeof(double));
  SET_VECTOR_ELT(state, 248, ScalarInteger(main_model_p->dim_eP0));
  SET_VECTOR_ELT(state, 249, allocVector(REALSXP, main_model_p->dim_eP0));
  memcpy(REAL(VECTOR_ELT(state, 249)), main_model_p->eP0, main_model_p->dim_eP0 * sizeof(double));
  SET_VECTOR_ELT(state, 250, ScalarInteger(main_model_p->dim_eP1a));
  SET_VECTOR_ELT(state, 251, allocVector(REALSXP, main_model_p->dim_eP1a));
  memcpy(REAL(VECTOR_ELT(state, 251)), main_model_p->eP1a, main_model_p->dim_eP1a * sizeof(double));
  SET_VECTOR_ELT(state, 252, ScalarInteger(main_model_p->dim_eP1b));
  SET_VECTOR_ELT(state, 253, allocVector(REALSXP, main_model_p->dim_eP1b));
  memcpy(REAL(VECTOR_ELT(state, 253)), main_model_p->eP1b, main_model_p->dim_eP1b * sizeof(double));
  SET_VECTOR_ELT(state, 254, ScalarInteger(main_model_p->dim_eP1c));
  SET_VECTOR_ELT(state, 255, allocVector(REALSXP, main_model_p->dim_eP1c));
  memcpy(REAL(VECTOR_ELT(state, 255)), main_model_p->eP1c, main_model_p->dim_eP1c * sizeof(double));
  SET_VECTOR_ELT(state, 256, ScalarInteger(main_model_p->dim_eP1d));
  SET_VECTOR_ELT(state, 257, allocVector(REALSXP, main_model_p->dim_eP1d));
  memcpy(REAL(VECTOR_ELT(state, 257)), main_model_p->eP1d, main_model_p->dim_eP1d * sizeof(double));
  SET_VECTOR_ELT(state, 258, ScalarInteger(main_model_p->dim_fc_comm));
  SET_VECTOR_ELT(state, 259, ScalarInteger(main_model_p->dim_fc_comm_1));
  SET_VECTOR_ELT(state, 260, ScalarInteger(main_model_p->dim_fc_comm_2));
  SET_VECTOR_ELT(state, 261, allocVector(REALSXP, main_model_p->dim_fc_comm));
  memcpy(REAL(VECTOR_ELT(state, 261)), main_model_p->fc_comm, main_model_p->dim_fc_comm * sizeof(double));
  odin_set_dim(VECTOR_ELT(state, 261), 2, main_model_p->dim_fc_comm_1, main_model_p->dim_fc_comm_2);
  SET_VECTOR_ELT(state, 262, ScalarInteger(main_model_p->offset_output_fc_comm));
  SET_VECTOR_ELT(state, 263, ScalarInteger(main_model_p->dim_fP_comm));
  SET_VECTOR_ELT(state, 264, allocVector(REALSXP, main_model_p->dim_fP_comm));
  memcpy(REAL(VECTOR_ELT(state, 264)), main_model_p->fP_comm, main_model_p->dim_fP_comm * sizeof(double));
  SET_VECTOR_ELT(state, 265, ScalarInteger(main_model_p->offset_output_fP_comm));
  SET_VECTOR_ELT(state, 266, ScalarInteger(main_model_p->dim_fc_noncomm));
  SET_VECTOR_ELT(state, 267, ScalarInteger(main_model_p->dim_fc_noncomm_1));
  SET_VECTOR_ELT(state, 268, ScalarInteger(main_model_p->dim_fc_noncomm_2));
  SET_VECTOR_ELT(state, 269, allocVector(REALSXP, main_model_p->dim_fc_noncomm));
  memcpy(REAL(VECTOR_ELT(state, 269)), main_model_p->fc_noncomm, main_model_p->dim_fc_noncomm * sizeof(double));
  odin_set_dim(VECTOR_ELT(state, 269), 2, main_model_p->dim_fc_noncomm_1, main_model_p->dim_fc_noncomm_2);
  SET_VECTOR_ELT(state, 270, ScalarInteger(main_model_p->offset_output_fc_noncomm));
  SET_VECTOR_ELT(state, 271, ScalarInteger(main_model_p->dim_fP_noncomm));
  SET_VECTOR_ELT(state, 272, allocVector(REALSXP, main_model_p->dim_fP_noncomm));
  memcpy(REAL(VECTOR_ELT(state, 272)), main_model_p->fP_noncomm, main_model_p->dim_fP_noncomm * sizeof(double));
  SET_VECTOR_ELT(state, 273, ScalarInteger(main_model_p->offset_output_fP_noncomm));
  SET_VECTOR_ELT(state, 274, ScalarInteger(main_model_p->dim_n_comm));
  SET_VECTOR_ELT(state, 275, ScalarInteger(main_model_p->dim_n_comm_1));
  SET_VECTOR_ELT(state, 276, ScalarInteger(main_model_p->dim_n_comm_2));
  SET_VECTOR_ELT(state, 277, allocVector(REALSXP, main_model_p->dim_n_comm));
  memcpy(REAL(VECTOR_ELT(state, 277)), main_model_p->n_comm, main_model_p->dim_n_comm * sizeof(double));
  odin_set_dim(VECTOR_ELT(state, 277), 2, main_model_p->dim_n_comm_1, main_model_p->dim_n_comm_2);
  SET_VECTOR_ELT(state, 278, ScalarInteger(main_model_p->offset_output_n_comm));
  SET_VECTOR_ELT(state, 279, ScalarInteger(main_model_p->dim_n_noncomm));
  SET_VECTOR_ELT(state, 280, ScalarInteger(main_model_p->dim_n_noncomm_1));
  SET_VECTOR_ELT(state, 281, ScalarInteger(main_model_p->dim_n_noncomm_2));
  SET_VECTOR_ELT(state, 282, allocVector(REALSXP, main_model_p->dim_n_noncomm));
  memcpy(REAL(VECTOR_ELT(state, 282)), main_model_p->n_noncomm, main_model_p->dim_n_noncomm * sizeof(double));
  odin_set_dim(VECTOR_ELT(state, 282), 2, main_model_p->dim_n_noncomm_1, main_model_p->dim_n_noncomm_2);
  SET_VECTOR_ELT(state, 283, ScalarInteger(main_model_p->offset_output_n_noncomm));
  SET_VECTOR_ELT(state, 284, ScalarInteger(main_model_p->dim_cumuInf));
  SET_VECTOR_ELT(state, 285, allocVector(REALSXP, main_model_p->dim_cumuInf));
  memcpy(REAL(VECTOR_ELT(state, 285)), main_model_p->initial_cumuInf, main_model_p->dim_cumuInf * sizeof(double));
  SET_VECTOR_ELT(state, 286, ScalarInteger(main_model_p->offset_cumuInf));
  SET_VECTOR_ELT(state, 287, ScalarInteger(main_model_p->dim_OnPrEP));
  SET_VECTOR_ELT(state, 288, allocVector(REALSXP, main_model_p->dim_OnPrEP));
  memcpy(REAL(VECTOR_ELT(state, 288)), main_model_p->initial_OnPrEP, main_model_p->dim_OnPrEP * sizeof(double));
  SET_VECTOR_ELT(state, 289, ScalarInteger(main_model_p->offset_OnPrEP));
  SET_VECTOR_ELT(state, 290, ScalarInteger(main_model_p->dim_S0));
  SET_VECTOR_ELT(state, 291, allocVector(REALSXP, main_model_p->dim_S0));
  memcpy(REAL(VECTOR_ELT(state, 291)), main_model_p->initial_S0, main_model_p->dim_S0 * sizeof(double));
  SET_VECTOR_ELT(state, 292, ScalarInteger(main_model_p->offset_S0));
  SET_VECTOR_ELT(state, 293, ScalarInteger(main_model_p->dim_S1a));
  SET_VECTOR_ELT(state, 294, allocVector(REALSXP, main_model_p->dim_S1a));
  memcpy(REAL(VECTOR_ELT(state, 294)), main_model_p->initial_S1a, main_model_p->dim_S1a * sizeof(double));
  SET_VECTOR_ELT(state, 295, ScalarInteger(main_model_p->offset_S1a));
  SET_VECTOR_ELT(state, 296, ScalarInteger(main_model_p->dim_S1b));
  SET_VECTOR_ELT(state, 297, allocVector(REALSXP, main_model_p->dim_S1b));
  memcpy(REAL(VECTOR_ELT(state, 297)), main_model_p->initial_S1b, main_model_p->dim_S1b * sizeof(double));
  SET_VECTOR_ELT(state, 298, ScalarInteger(main_model_p->offset_S1b));
  SET_VECTOR_ELT(state, 299, ScalarInteger(main_model_p->dim_S1c));
  SET_VECTOR_ELT(state, 300, allocVector(REALSXP, main_model_p->dim_S1c));
  memcpy(REAL(VECTOR_ELT(state, 300)), main_model_p->initial_S1c, main_model_p->dim_S1c * sizeof(double));
  SET_VECTOR_ELT(state, 301, ScalarInteger(main_model_p->offset_S1c));
  SET_VECTOR_ELT(state, 302, ScalarInteger(main_model_p->dim_S1d));
  SET_VECTOR_ELT(state, 303, allocVector(REALSXP, main_model_p->dim_S1d));
  memcpy(REAL(VECTOR_ELT(state, 303)), main_model_p->initial_S1d, main_model_p->dim_S1d * sizeof(double));
  SET_VECTOR_ELT(state, 304, ScalarInteger(main_model_p->offset_S1d));
  SET_VECTOR_ELT(state, 305, ScalarInteger(main_model_p->dim_I01));
  SET_VECTOR_ELT(state, 306, allocVector(REALSXP, main_model_p->dim_I01));
  memcpy(REAL(VECTOR_ELT(state, 306)), main_model_p->initial_I01, main_model_p->dim_I01 * sizeof(double));
  SET_VECTOR_ELT(state, 307, ScalarInteger(main_model_p->offset_I01));
  SET_VECTOR_ELT(state, 308, ScalarInteger(main_model_p->dim_I11));
  SET_VECTOR_ELT(state, 309, allocVector(REALSXP, main_model_p->dim_I11));
  memcpy(REAL(VECTOR_ELT(state, 309)), main_model_p->initial_I11, main_model_p->dim_I11 * sizeof(double));
  SET_VECTOR_ELT(state, 310, ScalarInteger(main_model_p->offset_I11));
  SET_VECTOR_ELT(state, 311, ScalarInteger(main_model_p->dim_I02));
  SET_VECTOR_ELT(state, 312, allocVector(REALSXP, main_model_p->dim_I02));
  memcpy(REAL(VECTOR_ELT(state, 312)), main_model_p->initial_I02, main_model_p->dim_I02 * sizeof(double));
  SET_VECTOR_ELT(state, 313, ScalarInteger(main_model_p->offset_I02));
  SET_VECTOR_ELT(state, 314, ScalarInteger(main_model_p->dim_I03));
  SET_VECTOR_ELT(state, 315, allocVector(REALSXP, main_model_p->dim_I03));
  memcpy(REAL(VECTOR_ELT(state, 315)), main_model_p->initial_I03, main_model_p->dim_I03 * sizeof(double));
  SET_VECTOR_ELT(state, 316, ScalarInteger(main_model_p->offset_I03));
  SET_VECTOR_ELT(state, 317, ScalarInteger(main_model_p->dim_I04));
  SET_VECTOR_ELT(state, 318, allocVector(REALSXP, main_model_p->dim_I04));
  memcpy(REAL(VECTOR_ELT(state, 318)), main_model_p->initial_I04, main_model_p->dim_I04 * sizeof(double));
  SET_VECTOR_ELT(state, 319, ScalarInteger(main_model_p->offset_I04));
  SET_VECTOR_ELT(state, 320, ScalarInteger(main_model_p->dim_I05));
  SET_VECTOR_ELT(state, 321, allocVector(REALSXP, main_model_p->dim_I05));
  memcpy(REAL(VECTOR_ELT(state, 321)), main_model_p->initial_I05, main_model_p->dim_I05 * sizeof(double));
  SET_VECTOR_ELT(state, 322, ScalarInteger(main_model_p->offset_I05));
  SET_VECTOR_ELT(state, 323, ScalarInteger(main_model_p->dim_I22));
  SET_VECTOR_ELT(state, 324, allocVector(REALSXP, main_model_p->dim_I22));
  memcpy(REAL(VECTOR_ELT(state, 324)), main_model_p->initial_I22, main_model_p->dim_I22 * sizeof(double));
  SET_VECTOR_ELT(state, 325, ScalarInteger(main_model_p->offset_I22));
  SET_VECTOR_ELT(state, 326, ScalarInteger(main_model_p->dim_I23));
  SET_VECTOR_ELT(state, 327, allocVector(REALSXP, main_model_p->dim_I23));
  memcpy(REAL(VECTOR_ELT(state, 327)), main_model_p->initial_I23, main_model_p->dim_I23 * sizeof(double));
  SET_VECTOR_ELT(state, 328, ScalarInteger(main_model_p->offset_I23));
  SET_VECTOR_ELT(state, 329, ScalarInteger(main_model_p->dim_I24));
  SET_VECTOR_ELT(state, 330, allocVector(REALSXP, main_model_p->dim_I24));
  memcpy(REAL(VECTOR_ELT(state, 330)), main_model_p->initial_I24, main_model_p->dim_I24 * sizeof(double));
  SET_VECTOR_ELT(state, 331, ScalarInteger(main_model_p->offset_I24));
  SET_VECTOR_ELT(state, 332, ScalarInteger(main_model_p->dim_I25));
  SET_VECTOR_ELT(state, 333, allocVector(REALSXP, main_model_p->dim_I25));
  memcpy(REAL(VECTOR_ELT(state, 333)), main_model_p->initial_I25, main_model_p->dim_I25 * sizeof(double));
  SET_VECTOR_ELT(state, 334, ScalarInteger(main_model_p->offset_I25));
  SET_VECTOR_ELT(state, 335, ScalarInteger(main_model_p->dim_I32));
  SET_VECTOR_ELT(state, 336, allocVector(REALSXP, main_model_p->dim_I32));
  memcpy(REAL(VECTOR_ELT(state, 336)), main_model_p->initial_I32, main_model_p->dim_I32 * sizeof(double));
  SET_VECTOR_ELT(state, 337, ScalarInteger(main_model_p->offset_I32));
  SET_VECTOR_ELT(state, 338, ScalarInteger(main_model_p->dim_I33));
  SET_VECTOR_ELT(state, 339, allocVector(REALSXP, main_model_p->dim_I33));
  memcpy(REAL(VECTOR_ELT(state, 339)), main_model_p->initial_I33, main_model_p->dim_I33 * sizeof(double));
  SET_VECTOR_ELT(state, 340, ScalarInteger(main_model_p->offset_I33));
  SET_VECTOR_ELT(state, 341, ScalarInteger(main_model_p->dim_I34));
  SET_VECTOR_ELT(state, 342, allocVector(REALSXP, main_model_p->dim_I34));
  memcpy(REAL(VECTOR_ELT(state, 342)), main_model_p->initial_I34, main_model_p->dim_I34 * sizeof(double));
  SET_VECTOR_ELT(state, 343, ScalarInteger(main_model_p->offset_I34));
  SET_VECTOR_ELT(state, 344, ScalarInteger(main_model_p->dim_I35));
  SET_VECTOR_ELT(state, 345, allocVector(REALSXP, main_model_p->dim_I35));
  memcpy(REAL(VECTOR_ELT(state, 345)), main_model_p->initial_I35, main_model_p->dim_I35 * sizeof(double));
  SET_VECTOR_ELT(state, 346, ScalarInteger(main_model_p->offset_I35));
  SET_VECTOR_ELT(state, 347, ScalarInteger(main_model_p->dim_I42));
  SET_VECTOR_ELT(state, 348, allocVector(REALSXP, main_model_p->dim_I42));
  memcpy(REAL(VECTOR_ELT(state, 348)), main_model_p->initial_I42, main_model_p->dim_I42 * sizeof(double));
  SET_VECTOR_ELT(state, 349, ScalarInteger(main_model_p->offset_I42));
  SET_VECTOR_ELT(state, 350, ScalarInteger(main_model_p->dim_I43));
  SET_VECTOR_ELT(state, 351, allocVector(REALSXP, main_model_p->dim_I43));
  memcpy(REAL(VECTOR_ELT(state, 351)), main_model_p->initial_I43, main_model_p->dim_I43 * sizeof(double));
  SET_VECTOR_ELT(state, 352, ScalarInteger(main_model_p->offset_I43));
  SET_VECTOR_ELT(state, 353, ScalarInteger(main_model_p->dim_I44));
  SET_VECTOR_ELT(state, 354, allocVector(REALSXP, main_model_p->dim_I44));
  memcpy(REAL(VECTOR_ELT(state, 354)), main_model_p->initial_I44, main_model_p->dim_I44 * sizeof(double));
  SET_VECTOR_ELT(state, 355, ScalarInteger(main_model_p->offset_I44));
  SET_VECTOR_ELT(state, 356, ScalarInteger(main_model_p->dim_I45));
  SET_VECTOR_ELT(state, 357, allocVector(REALSXP, main_model_p->dim_I45));
  memcpy(REAL(VECTOR_ELT(state, 357)), main_model_p->initial_I45, main_model_p->dim_I45 * sizeof(double));
  SET_VECTOR_ELT(state, 358, ScalarInteger(main_model_p->offset_I45));
  SET_VECTOR_ELT(state, 359, ScalarInteger(main_model_p->dim_S0_init));
  SET_VECTOR_ELT(state, 360, allocVector(REALSXP, main_model_p->dim_S0_init));
  memcpy(REAL(VECTOR_ELT(state, 360)), main_model_p->S0_init, main_model_p->dim_S0_init * sizeof(double));
  SET_VECTOR_ELT(state, 361, ScalarInteger(main_model_p->dim_S1a_init));
  SET_VECTOR_ELT(state, 362, allocVector(REALSXP, main_model_p->dim_S1a_init));
  memcpy(REAL(VECTOR_ELT(state, 362)), main_model_p->S1a_init, main_model_p->dim_S1a_init * sizeof(double));
  SET_VECTOR_ELT(state, 363, ScalarInteger(main_model_p->dim_S1b_init));
  SET_VECTOR_ELT(state, 364, allocVector(REALSXP, main_model_p->dim_S1b_init));
  memcpy(REAL(VECTOR_ELT(state, 364)), main_model_p->S1b_init, main_model_p->dim_S1b_init * sizeof(double));
  SET_VECTOR_ELT(state, 365, ScalarInteger(main_model_p->dim_S1c_init));
  SET_VECTOR_ELT(state, 366, allocVector(REALSXP, main_model_p->dim_S1c_init));
  memcpy(REAL(VECTOR_ELT(state, 366)), main_model_p->S1c_init, main_model_p->dim_S1c_init * sizeof(double));
  SET_VECTOR_ELT(state, 367, ScalarInteger(main_model_p->dim_S1d_init));
  SET_VECTOR_ELT(state, 368, allocVector(REALSXP, main_model_p->dim_S1d_init));
  memcpy(REAL(VECTOR_ELT(state, 368)), main_model_p->S1d_init, main_model_p->dim_S1d_init * sizeof(double));
  SET_VECTOR_ELT(state, 369, ScalarInteger(main_model_p->dim_I01_init));
  SET_VECTOR_ELT(state, 370, allocVector(REALSXP, main_model_p->dim_I01_init));
  memcpy(REAL(VECTOR_ELT(state, 370)), main_model_p->I01_init, main_model_p->dim_I01_init * sizeof(double));
  SET_VECTOR_ELT(state, 371, ScalarInteger(main_model_p->dim_I11_init));
  SET_VECTOR_ELT(state, 372, allocVector(REALSXP, main_model_p->dim_I11_init));
  memcpy(REAL(VECTOR_ELT(state, 372)), main_model_p->I11_init, main_model_p->dim_I11_init * sizeof(double));
  SET_VECTOR_ELT(state, 373, ScalarInteger(main_model_p->dim_I02_init));
  SET_VECTOR_ELT(state, 374, allocVector(REALSXP, main_model_p->dim_I02_init));
  memcpy(REAL(VECTOR_ELT(state, 374)), main_model_p->I02_init, main_model_p->dim_I02_init * sizeof(double));
  SET_VECTOR_ELT(state, 375, ScalarInteger(main_model_p->dim_I03_init));
  SET_VECTOR_ELT(state, 376, allocVector(REALSXP, main_model_p->dim_I03_init));
  memcpy(REAL(VECTOR_ELT(state, 376)), main_model_p->I03_init, main_model_p->dim_I03_init * sizeof(double));
  SET_VECTOR_ELT(state, 377, ScalarInteger(main_model_p->dim_I04_init));
  SET_VECTOR_ELT(state, 378, allocVector(REALSXP, main_model_p->dim_I04_init));
  memcpy(REAL(VECTOR_ELT(state, 378)), main_model_p->I04_init, main_model_p->dim_I04_init * sizeof(double));
  SET_VECTOR_ELT(state, 379, ScalarInteger(main_model_p->dim_I05_init));
  SET_VECTOR_ELT(state, 380, allocVector(REALSXP, main_model_p->dim_I05_init));
  memcpy(REAL(VECTOR_ELT(state, 380)), main_model_p->I05_init, main_model_p->dim_I05_init * sizeof(double));
  SET_VECTOR_ELT(state, 381, ScalarInteger(main_model_p->dim_I22_init));
  SET_VECTOR_ELT(state, 382, allocVector(REALSXP, main_model_p->dim_I22_init));
  memcpy(REAL(VECTOR_ELT(state, 382)), main_model_p->I22_init, main_model_p->dim_I22_init * sizeof(double));
  SET_VECTOR_ELT(state, 383, ScalarInteger(main_model_p->dim_I23_init));
  SET_VECTOR_ELT(state, 384, allocVector(REALSXP, main_model_p->dim_I23_init));
  memcpy(REAL(VECTOR_ELT(state, 384)), main_model_p->I23_init, main_model_p->dim_I23_init * sizeof(double));
  SET_VECTOR_ELT(state, 385, ScalarInteger(main_model_p->dim_I24_init));
  SET_VECTOR_ELT(state, 386, allocVector(REALSXP, main_model_p->dim_I24_init));
  memcpy(REAL(VECTOR_ELT(state, 386)), main_model_p->I24_init, main_model_p->dim_I24_init * sizeof(double));
  SET_VECTOR_ELT(state, 387, ScalarInteger(main_model_p->dim_I25_init));
  SET_VECTOR_ELT(state, 388, allocVector(REALSXP, main_model_p->dim_I25_init));
  memcpy(REAL(VECTOR_ELT(state, 388)), main_model_p->I25_init, main_model_p->dim_I25_init * sizeof(double));
  SET_VECTOR_ELT(state, 389, ScalarInteger(main_model_p->dim_I32_init));
  SET_VECTOR_ELT(state, 390, allocVector(REALSXP, main_model_p->dim_I32_init));
  memcpy(REAL(VECTOR_ELT(state, 390)), main_model_p->I32_init, main_model_p->dim_I32_init * sizeof(double));
  SET_VECTOR_ELT(state, 391, ScalarInteger(main_model_p->dim_I33_init));
  SET_VECTOR_ELT(state, 392, allocVector(REALSXP, main_model_p->dim_I33_init));
  memcpy(REAL(VECTOR_ELT(state, 392)), main_model_p->I33_init, main_model_p->dim_I33_init * sizeof(double));
  SET_VECTOR_ELT(state, 393, ScalarInteger(main_model_p->dim_I34_init));
  SET_VECTOR_ELT(state, 394, allocVector(REALSXP, main_model_p->dim_I34_init));
  memcpy(REAL(VECTOR_ELT(state, 394)), main_model_p->I34_init, main_model_p->dim_I34_init * sizeof(double));
  SET_VECTOR_ELT(state, 395, ScalarInteger(main_model_p->dim_I35_init));
  SET_VECTOR_ELT(state, 396, allocVector(REALSXP, main_model_p->dim_I35_init));
  memcpy(REAL(VECTOR_ELT(state, 396)), main_model_p->I35_init, main_model_p->dim_I35_init * sizeof(double));
  SET_VECTOR_ELT(state, 397, ScalarInteger(main_model_p->dim_I42_init));
  SET_VECTOR_ELT(state, 398, allocVector(REALSXP, main_model_p->dim_I42_init));
  memcpy(REAL(VECTOR_ELT(state, 398)), main_model_p->I42_init, main_model_p->dim_I42_init * sizeof(double));
  SET_VECTOR_ELT(state, 399, ScalarInteger(main_model_p->dim_I43_init));
  SET_VECTOR_ELT(state, 400, allocVector(REALSXP, main_model_p->dim_I43_init));
  memcpy(REAL(VECTOR_ELT(state, 400)), main_model_p->I43_init, main_model_p->dim_I43_init * sizeof(double));
  SET_VECTOR_ELT(state, 401, ScalarInteger(main_model_p->dim_I44_init));
  SET_VECTOR_ELT(state, 402, allocVector(REALSXP, main_model_p->dim_I44_init));
  memcpy(REAL(VECTOR_ELT(state, 402)), main_model_p->I44_init, main_model_p->dim_I44_init * sizeof(double));
  SET_VECTOR_ELT(state, 403, ScalarInteger(main_model_p->dim_I45_init));
  SET_VECTOR_ELT(state, 404, allocVector(REALSXP, main_model_p->dim_I45_init));
  memcpy(REAL(VECTOR_ELT(state, 404)), main_model_p->I45_init, main_model_p->dim_I45_init * sizeof(double));
  SET_VECTOR_ELT(state, 405, ScalarInteger(main_model_p->dim_N));
  SET_VECTOR_ELT(state, 406, allocVector(REALSXP, main_model_p->dim_N));
  memcpy(REAL(VECTOR_ELT(state, 406)), main_model_p->N, main_model_p->dim_N * sizeof(double));
  SET_VECTOR_ELT(state, 407, ScalarInteger(main_model_p->offset_output_N));
  SET_VECTOR_ELT(state, 408, ScalarInteger(main_model_p->dim_E0));
  SET_VECTOR_ELT(state, 409, allocVector(REALSXP, main_model_p->dim_E0));
  memcpy(REAL(VECTOR_ELT(state, 409)), main_model_p->E0, main_model_p->dim_E0 * sizeof(double));
  SET_VECTOR_ELT(state, 410, ScalarInteger(main_model_p->offset_output_E0));
  SET_VECTOR_ELT(state, 411, ScalarInteger(main_model_p->dim_E1a));
  SET_VECTOR_ELT(state, 412, allocVector(REALSXP, main_model_p->dim_E1a));
  memcpy(REAL(VECTOR_ELT(state, 412)), main_model_p->E1a, main_model_p->dim_E1a * sizeof(double));
  SET_VECTOR_ELT(state, 413, ScalarInteger(main_model_p->offset_output_E1a));
  SET_VECTOR_ELT(state, 414, ScalarInteger(main_model_p->dim_E1b));
  SET_VECTOR_ELT(state, 415, allocVector(REALSXP, main_model_p->dim_E1b));
  memcpy(REAL(VECTOR_ELT(state, 415)), main_model_p->E1b, main_model_p->dim_E1b * sizeof(double));
  SET_VECTOR_ELT(state, 416, ScalarInteger(main_model_p->offset_output_E1b));
  SET_VECTOR_ELT(state, 417, ScalarInteger(main_model_p->dim_E1c));
  SET_VECTOR_ELT(state, 418, allocVector(REALSXP, main_model_p->dim_E1c));
  memcpy(REAL(VECTOR_ELT(state, 418)), main_model_p->E1c, main_model_p->dim_E1c * sizeof(double));
  SET_VECTOR_ELT(state, 419, ScalarInteger(main_model_p->offset_output_E1c));
  SET_VECTOR_ELT(state, 420, ScalarInteger(main_model_p->dim_E1d));
  SET_VECTOR_ELT(state, 421, allocVector(REALSXP, main_model_p->dim_E1d));
  memcpy(REAL(VECTOR_ELT(state, 421)), main_model_p->E1d, main_model_p->dim_E1d * sizeof(double));
  SET_VECTOR_ELT(state, 422, ScalarInteger(main_model_p->offset_output_E1d));
  SET_VECTOR_ELT(state, 423, ScalarInteger(main_model_p->dim_cumuInf_init));
  SET_VECTOR_ELT(state, 424, allocVector(REALSXP, main_model_p->dim_cumuInf_init));
  memcpy(REAL(VECTOR_ELT(state, 424)), main_model_p->cumuInf_init, main_model_p->dim_cumuInf_init * sizeof(double));
  SET_VECTOR_ELT(state, 425, ScalarInteger(main_model_p->dim_alphaItot));
  SET_VECTOR_ELT(state, 426, allocVector(REALSXP, main_model_p->dim_alphaItot));
  memcpy(REAL(VECTOR_ELT(state, 426)), main_model_p->alphaItot, main_model_p->dim_alphaItot * sizeof(double));
  SET_VECTOR_ELT(state, 427, ScalarInteger(main_model_p->offset_output_alphaItot));
  SET_VECTOR_ELT(state, 428, ScalarInteger(main_model_p->dim_prev));
  SET_VECTOR_ELT(state, 429, allocVector(REALSXP, main_model_p->dim_prev));
  memcpy(REAL(VECTOR_ELT(state, 429)), main_model_p->prev, main_model_p->dim_prev * sizeof(double));
  SET_VECTOR_ELT(state, 430, ScalarInteger(main_model_p->offset_output_prev));
  SET_VECTOR_ELT(state, 431, ScalarInteger(main_model_p->dim_lambda));
  SET_VECTOR_ELT(state, 432, ScalarInteger(main_model_p->dim_lambda_1));
  SET_VECTOR_ELT(state, 433, ScalarInteger(main_model_p->dim_lambda_2));
  SET_VECTOR_ELT(state, 434, allocVector(REALSXP, main_model_p->dim_lambda));
  memcpy(REAL(VECTOR_ELT(state, 434)), main_model_p->lambda, main_model_p->dim_lambda * sizeof(double));
  odin_set_dim(VECTOR_ELT(state, 434), 2, main_model_p->dim_lambda_1, main_model_p->dim_lambda_2);
  SET_VECTOR_ELT(state, 435, ScalarInteger(main_model_p->offset_output_lambda));
  SET_VECTOR_ELT(state, 436, ScalarInteger(main_model_p->dim_lambda_0));
  SET_VECTOR_ELT(state, 437, ScalarInteger(main_model_p->dim_lambda_0_1));
  SET_VECTOR_ELT(state, 438, ScalarInteger(main_model_p->dim_lambda_0_2));
  SET_VECTOR_ELT(state, 439, allocVector(REALSXP, main_model_p->dim_lambda_0));
  memcpy(REAL(VECTOR_ELT(state, 439)), main_model_p->lambda_0, main_model_p->dim_lambda_0 * sizeof(double));
  odin_set_dim(VECTOR_ELT(state, 439), 2, main_model_p->dim_lambda_0_1, main_model_p->dim_lambda_0_2);
  SET_VECTOR_ELT(state, 440, ScalarInteger(main_model_p->offset_output_lambda_0));
  SET_VECTOR_ELT(state, 441, ScalarInteger(main_model_p->dim_lambda_1a));
  SET_VECTOR_ELT(state, 442, ScalarInteger(main_model_p->dim_lambda_1a_1));
  SET_VECTOR_ELT(state, 443, ScalarInteger(main_model_p->dim_lambda_1a_2));
  SET_VECTOR_ELT(state, 444, allocVector(REALSXP, main_model_p->dim_lambda_1a));
  memcpy(REAL(VECTOR_ELT(state, 444)), main_model_p->lambda_1a, main_model_p->dim_lambda_1a * sizeof(double));
  odin_set_dim(VECTOR_ELT(state, 444), 2, main_model_p->dim_lambda_1a_1, main_model_p->dim_lambda_1a_2);
  SET_VECTOR_ELT(state, 445, ScalarInteger(main_model_p->offset_output_lambda_1a));
  SET_VECTOR_ELT(state, 446, ScalarInteger(main_model_p->dim_lambda_1b));
  SET_VECTOR_ELT(state, 447, ScalarInteger(main_model_p->dim_lambda_1b_1));
  SET_VECTOR_ELT(state, 448, ScalarInteger(main_model_p->dim_lambda_1b_2));
  SET_VECTOR_ELT(state, 449, allocVector(REALSXP, main_model_p->dim_lambda_1b));
  memcpy(REAL(VECTOR_ELT(state, 449)), main_model_p->lambda_1b, main_model_p->dim_lambda_1b * sizeof(double));
  odin_set_dim(VECTOR_ELT(state, 449), 2, main_model_p->dim_lambda_1b_1, main_model_p->dim_lambda_1b_2);
  SET_VECTOR_ELT(state, 450, ScalarInteger(main_model_p->offset_output_lambda_1b));
  SET_VECTOR_ELT(state, 451, ScalarInteger(main_model_p->dim_lambda_1c));
  SET_VECTOR_ELT(state, 452, ScalarInteger(main_model_p->dim_lambda_1c_1));
  SET_VECTOR_ELT(state, 453, ScalarInteger(main_model_p->dim_lambda_1c_2));
  SET_VECTOR_ELT(state, 454, allocVector(REALSXP, main_model_p->dim_lambda_1c));
  memcpy(REAL(VECTOR_ELT(state, 454)), main_model_p->lambda_1c, main_model_p->dim_lambda_1c * sizeof(double));
  odin_set_dim(VECTOR_ELT(state, 454), 2, main_model_p->dim_lambda_1c_1, main_model_p->dim_lambda_1c_2);
  SET_VECTOR_ELT(state, 455, ScalarInteger(main_model_p->offset_output_lambda_1c));
  SET_VECTOR_ELT(state, 456, ScalarInteger(main_model_p->dim_lambda_1d));
  SET_VECTOR_ELT(state, 457, ScalarInteger(main_model_p->dim_lambda_1d_1));
  SET_VECTOR_ELT(state, 458, ScalarInteger(main_model_p->dim_lambda_1d_2));
  SET_VECTOR_ELT(state, 459, allocVector(REALSXP, main_model_p->dim_lambda_1d));
  memcpy(REAL(VECTOR_ELT(state, 459)), main_model_p->lambda_1d, main_model_p->dim_lambda_1d * sizeof(double));
  odin_set_dim(VECTOR_ELT(state, 459), 2, main_model_p->dim_lambda_1d_1, main_model_p->dim_lambda_1d_2);
  SET_VECTOR_ELT(state, 460, ScalarInteger(main_model_p->offset_output_lambda_1d));
  SET_VECTOR_ELT(state, 461, ScalarInteger(main_model_p->dim_lambda_sum_0));
  SET_VECTOR_ELT(state, 462, allocVector(REALSXP, main_model_p->dim_lambda_sum_0));
  memcpy(REAL(VECTOR_ELT(state, 462)), main_model_p->lambda_sum_0, main_model_p->dim_lambda_sum_0 * sizeof(double));
  SET_VECTOR_ELT(state, 463, ScalarInteger(main_model_p->offset_output_lambda_sum_0));
  SET_VECTOR_ELT(state, 464, ScalarInteger(main_model_p->dim_lambda_sum_1a));
  SET_VECTOR_ELT(state, 465, allocVector(REALSXP, main_model_p->dim_lambda_sum_1a));
  memcpy(REAL(VECTOR_ELT(state, 465)), main_model_p->lambda_sum_1a, main_model_p->dim_lambda_sum_1a * sizeof(double));
  SET_VECTOR_ELT(state, 466, ScalarInteger(main_model_p->offset_output_lambda_sum_1a));
  SET_VECTOR_ELT(state, 467, ScalarInteger(main_model_p->dim_lambda_sum_1b));
  SET_VECTOR_ELT(state, 468, allocVector(REALSXP, main_model_p->dim_lambda_sum_1b));
  memcpy(REAL(VECTOR_ELT(state, 468)), main_model_p->lambda_sum_1b, main_model_p->dim_lambda_sum_1b * sizeof(double));
  SET_VECTOR_ELT(state, 469, ScalarInteger(main_model_p->offset_output_lambda_sum_1b));
  SET_VECTOR_ELT(state, 470, ScalarInteger(main_model_p->dim_lambda_sum_1c));
  SET_VECTOR_ELT(state, 471, allocVector(REALSXP, main_model_p->dim_lambda_sum_1c));
  memcpy(REAL(VECTOR_ELT(state, 471)), main_model_p->lambda_sum_1c, main_model_p->dim_lambda_sum_1c * sizeof(double));
  SET_VECTOR_ELT(state, 472, ScalarInteger(main_model_p->offset_output_lambda_sum_1c));
  SET_VECTOR_ELT(state, 473, ScalarInteger(main_model_p->dim_lambda_sum_1d));
  SET_VECTOR_ELT(state, 474, allocVector(REALSXP, main_model_p->dim_lambda_sum_1d));
  memcpy(REAL(VECTOR_ELT(state, 474)), main_model_p->lambda_sum_1d, main_model_p->dim_lambda_sum_1d * sizeof(double));
  SET_VECTOR_ELT(state, 475, ScalarInteger(main_model_p->offset_output_lambda_sum_1d));
  SET_VECTOR_ELT(state, 476, ScalarInteger(main_model_p->dim_c_comm_balanced));
  SET_VECTOR_ELT(state, 477, allocVector(REALSXP, main_model_p->dim_c_comm_balanced));
  memcpy(REAL(VECTOR_ELT(state, 477)), main_model_p->c_comm_balanced, main_model_p->dim_c_comm_balanced * sizeof(double));
  SET_VECTOR_ELT(state, 478, ScalarInteger(main_model_p->offset_output_c_comm_balanced));
  SET_VECTOR_ELT(state, 479, ScalarInteger(main_model_p->dim_c_noncomm_balanced));
  SET_VECTOR_ELT(state, 480, allocVector(REALSXP, main_model_p->dim_c_noncomm_balanced));
  memcpy(REAL(VECTOR_ELT(state, 480)), main_model_p->c_noncomm_balanced, main_model_p->dim_c_noncomm_balanced * sizeof(double));
  SET_VECTOR_ELT(state, 481, ScalarInteger(main_model_p->offset_output_c_noncomm_balanced));
  SET_VECTOR_ELT(state, 482, ScalarInteger(main_model_p->dim_theta));
  SET_VECTOR_ELT(state, 483, ScalarInteger(main_model_p->dim_theta_1));
  SET_VECTOR_ELT(state, 484, ScalarInteger(main_model_p->dim_theta_2));
  SET_VECTOR_ELT(state, 485, allocVector(REALSXP, main_model_p->dim_theta));
  memcpy(REAL(VECTOR_ELT(state, 485)), main_model_p->theta, main_model_p->dim_theta * sizeof(double));
  odin_set_dim(VECTOR_ELT(state, 485), 2, main_model_p->dim_theta_1, main_model_p->dim_theta_2);
  SET_VECTOR_ELT(state, 486, ScalarInteger(main_model_p->offset_output_theta));
  SET_VECTOR_ELT(state, 487, ScalarInteger(main_model_p->dim_OnPrEP_init));
  SET_VECTOR_ELT(state, 488, allocVector(REALSXP, main_model_p->dim_OnPrEP_init));
  memcpy(REAL(VECTOR_ELT(state, 488)), main_model_p->OnPrEP_init, main_model_p->dim_OnPrEP_init * sizeof(double));
  SET_VECTOR_ELT(state, 489, ScalarInteger(main_model_p->dim_M_comm));
  SET_VECTOR_ELT(state, 490, ScalarInteger(main_model_p->dim_M_comm_1));
  SET_VECTOR_ELT(state, 491, ScalarInteger(main_model_p->dim_M_comm_2));
  SET_VECTOR_ELT(state, 492, allocVector(REALSXP, main_model_p->dim_M_comm));
  memcpy(REAL(VECTOR_ELT(state, 492)), main_model_p->M_comm, main_model_p->dim_M_comm * sizeof(double));
  odin_set_dim(VECTOR_ELT(state, 492), 2, main_model_p->dim_M_comm_1, main_model_p->dim_M_comm_2);
  SET_VECTOR_ELT(state, 493, ScalarInteger(main_model_p->offset_output_M_comm));
  SET_VECTOR_ELT(state, 494, ScalarInteger(main_model_p->dim_M_noncomm));
  SET_VECTOR_ELT(state, 495, ScalarInteger(main_model_p->dim_M_noncomm_1));
  SET_VECTOR_ELT(state, 496, ScalarInteger(main_model_p->dim_M_noncomm_2));
  SET_VECTOR_ELT(state, 497, allocVector(REALSXP, main_model_p->dim_M_noncomm));
  memcpy(REAL(VECTOR_ELT(state, 497)), main_model_p->M_noncomm, main_model_p->dim_M_noncomm * sizeof(double));
  odin_set_dim(VECTOR_ELT(state, 497), 2, main_model_p->dim_M_noncomm_1, main_model_p->dim_M_noncomm_2);
  SET_VECTOR_ELT(state, 498, ScalarInteger(main_model_p->offset_output_M_noncomm));
  SET_VECTOR_ELT(state, 499, ScalarInteger(main_model_p->dim_in_S0));
  SET_VECTOR_ELT(state, 500, ScalarInteger(main_model_p->dim_in_S0_1));
  SET_VECTOR_ELT(state, 501, ScalarInteger(main_model_p->dim_in_S0_2));
  SET_VECTOR_ELT(state, 502, allocVector(REALSXP, main_model_p->dim_in_S0));
  memcpy(REAL(VECTOR_ELT(state, 502)), main_model_p->in_S0, main_model_p->dim_in_S0 * sizeof(double));
  odin_set_dim(VECTOR_ELT(state, 502), 2, main_model_p->dim_in_S0_1, main_model_p->dim_in_S0_2);
  SET_VECTOR_ELT(state, 503, ScalarInteger(main_model_p->dim_in_S1a));
  SET_VECTOR_ELT(state, 504, ScalarInteger(main_model_p->dim_in_S1a_1));
  SET_VECTOR_ELT(state, 505, ScalarInteger(main_model_p->dim_in_S1a_2));
  SET_VECTOR_ELT(state, 506, allocVector(REALSXP, main_model_p->dim_in_S1a));
  memcpy(REAL(VECTOR_ELT(state, 506)), main_model_p->in_S1a, main_model_p->dim_in_S1a * sizeof(double));
  odin_set_dim(VECTOR_ELT(state, 506), 2, main_model_p->dim_in_S1a_1, main_model_p->dim_in_S1a_2);
  SET_VECTOR_ELT(state, 507, ScalarInteger(main_model_p->dim_in_S1b));
  SET_VECTOR_ELT(state, 508, ScalarInteger(main_model_p->dim_in_S1b_1));
  SET_VECTOR_ELT(state, 509, ScalarInteger(main_model_p->dim_in_S1b_2));
  SET_VECTOR_ELT(state, 510, allocVector(REALSXP, main_model_p->dim_in_S1b));
  memcpy(REAL(VECTOR_ELT(state, 510)), main_model_p->in_S1b, main_model_p->dim_in_S1b * sizeof(double));
  odin_set_dim(VECTOR_ELT(state, 510), 2, main_model_p->dim_in_S1b_1, main_model_p->dim_in_S1b_2);
  SET_VECTOR_ELT(state, 511, ScalarInteger(main_model_p->dim_in_S1c));
  SET_VECTOR_ELT(state, 512, ScalarInteger(main_model_p->dim_in_S1c_1));
  SET_VECTOR_ELT(state, 513, ScalarInteger(main_model_p->dim_in_S1c_2));
  SET_VECTOR_ELT(state, 514, allocVector(REALSXP, main_model_p->dim_in_S1c));
  memcpy(REAL(VECTOR_ELT(state, 514)), main_model_p->in_S1c, main_model_p->dim_in_S1c * sizeof(double));
  odin_set_dim(VECTOR_ELT(state, 514), 2, main_model_p->dim_in_S1c_1, main_model_p->dim_in_S1c_2);
  SET_VECTOR_ELT(state, 515, ScalarInteger(main_model_p->dim_in_S1d));
  SET_VECTOR_ELT(state, 516, ScalarInteger(main_model_p->dim_in_S1d_1));
  SET_VECTOR_ELT(state, 517, ScalarInteger(main_model_p->dim_in_S1d_2));
  SET_VECTOR_ELT(state, 518, allocVector(REALSXP, main_model_p->dim_in_S1d));
  memcpy(REAL(VECTOR_ELT(state, 518)), main_model_p->in_S1d, main_model_p->dim_in_S1d * sizeof(double));
  odin_set_dim(VECTOR_ELT(state, 518), 2, main_model_p->dim_in_S1d_1, main_model_p->dim_in_S1d_2);
  SET_VECTOR_ELT(state, 519, ScalarInteger(main_model_p->dim_in_I01));
  SET_VECTOR_ELT(state, 520, ScalarInteger(main_model_p->dim_in_I01_1));
  SET_VECTOR_ELT(state, 521, ScalarInteger(main_model_p->dim_in_I01_2));
  SET_VECTOR_ELT(state, 522, allocVector(REALSXP, main_model_p->dim_in_I01));
  memcpy(REAL(VECTOR_ELT(state, 522)), main_model_p->in_I01, main_model_p->dim_in_I01 * sizeof(double));
  odin_set_dim(VECTOR_ELT(state, 522), 2, main_model_p->dim_in_I01_1, main_model_p->dim_in_I01_2);
  SET_VECTOR_ELT(state, 523, ScalarInteger(main_model_p->dim_in_I11));
  SET_VECTOR_ELT(state, 524, ScalarInteger(main_model_p->dim_in_I11_1));
  SET_VECTOR_ELT(state, 525, ScalarInteger(main_model_p->dim_in_I11_2));
  SET_VECTOR_ELT(state, 526, allocVector(REALSXP, main_model_p->dim_in_I11));
  memcpy(REAL(VECTOR_ELT(state, 526)), main_model_p->in_I11, main_model_p->dim_in_I11 * sizeof(double));
  odin_set_dim(VECTOR_ELT(state, 526), 2, main_model_p->dim_in_I11_1, main_model_p->dim_in_I11_2);
  SET_VECTOR_ELT(state, 527, ScalarInteger(main_model_p->dim_in_I02));
  SET_VECTOR_ELT(state, 528, ScalarInteger(main_model_p->dim_in_I02_1));
  SET_VECTOR_ELT(state, 529, ScalarInteger(main_model_p->dim_in_I02_2));
  SET_VECTOR_ELT(state, 530, allocVector(REALSXP, main_model_p->dim_in_I02));
  memcpy(REAL(VECTOR_ELT(state, 530)), main_model_p->in_I02, main_model_p->dim_in_I02 * sizeof(double));
  odin_set_dim(VECTOR_ELT(state, 530), 2, main_model_p->dim_in_I02_1, main_model_p->dim_in_I02_2);
  SET_VECTOR_ELT(state, 531, ScalarInteger(main_model_p->dim_in_I03));
  SET_VECTOR_ELT(state, 532, ScalarInteger(main_model_p->dim_in_I03_1));
  SET_VECTOR_ELT(state, 533, ScalarInteger(main_model_p->dim_in_I03_2));
  SET_VECTOR_ELT(state, 534, allocVector(REALSXP, main_model_p->dim_in_I03));
  memcpy(REAL(VECTOR_ELT(state, 534)), main_model_p->in_I03, main_model_p->dim_in_I03 * sizeof(double));
  odin_set_dim(VECTOR_ELT(state, 534), 2, main_model_p->dim_in_I03_1, main_model_p->dim_in_I03_2);
  SET_VECTOR_ELT(state, 535, ScalarInteger(main_model_p->dim_in_I04));
  SET_VECTOR_ELT(state, 536, ScalarInteger(main_model_p->dim_in_I04_1));
  SET_VECTOR_ELT(state, 537, ScalarInteger(main_model_p->dim_in_I04_2));
  SET_VECTOR_ELT(state, 538, allocVector(REALSXP, main_model_p->dim_in_I04));
  memcpy(REAL(VECTOR_ELT(state, 538)), main_model_p->in_I04, main_model_p->dim_in_I04 * sizeof(double));
  odin_set_dim(VECTOR_ELT(state, 538), 2, main_model_p->dim_in_I04_1, main_model_p->dim_in_I04_2);
  SET_VECTOR_ELT(state, 539, ScalarInteger(main_model_p->dim_in_I05));
  SET_VECTOR_ELT(state, 540, ScalarInteger(main_model_p->dim_in_I05_1));
  SET_VECTOR_ELT(state, 541, ScalarInteger(main_model_p->dim_in_I05_2));
  SET_VECTOR_ELT(state, 542, allocVector(REALSXP, main_model_p->dim_in_I05));
  memcpy(REAL(VECTOR_ELT(state, 542)), main_model_p->in_I05, main_model_p->dim_in_I05 * sizeof(double));
  odin_set_dim(VECTOR_ELT(state, 542), 2, main_model_p->dim_in_I05_1, main_model_p->dim_in_I05_2);
  SET_VECTOR_ELT(state, 543, ScalarInteger(main_model_p->dim_in_I22));
  SET_VECTOR_ELT(state, 544, ScalarInteger(main_model_p->dim_in_I22_1));
  SET_VECTOR_ELT(state, 545, ScalarInteger(main_model_p->dim_in_I22_2));
  SET_VECTOR_ELT(state, 546, allocVector(REALSXP, main_model_p->dim_in_I22));
  memcpy(REAL(VECTOR_ELT(state, 546)), main_model_p->in_I22, main_model_p->dim_in_I22 * sizeof(double));
  odin_set_dim(VECTOR_ELT(state, 546), 2, main_model_p->dim_in_I22_1, main_model_p->dim_in_I22_2);
  SET_VECTOR_ELT(state, 547, ScalarInteger(main_model_p->dim_in_I23));
  SET_VECTOR_ELT(state, 548, ScalarInteger(main_model_p->dim_in_I23_1));
  SET_VECTOR_ELT(state, 549, ScalarInteger(main_model_p->dim_in_I23_2));
  SET_VECTOR_ELT(state, 550, allocVector(REALSXP, main_model_p->dim_in_I23));
  memcpy(REAL(VECTOR_ELT(state, 550)), main_model_p->in_I23, main_model_p->dim_in_I23 * sizeof(double));
  odin_set_dim(VECTOR_ELT(state, 550), 2, main_model_p->dim_in_I23_1, main_model_p->dim_in_I23_2);
  SET_VECTOR_ELT(state, 551, ScalarInteger(main_model_p->dim_in_I24));
  SET_VECTOR_ELT(state, 552, ScalarInteger(main_model_p->dim_in_I24_1));
  SET_VECTOR_ELT(state, 553, ScalarInteger(main_model_p->dim_in_I24_2));
  SET_VECTOR_ELT(state, 554, allocVector(REALSXP, main_model_p->dim_in_I24));
  memcpy(REAL(VECTOR_ELT(state, 554)), main_model_p->in_I24, main_model_p->dim_in_I24 * sizeof(double));
  odin_set_dim(VECTOR_ELT(state, 554), 2, main_model_p->dim_in_I24_1, main_model_p->dim_in_I24_2);
  SET_VECTOR_ELT(state, 555, ScalarInteger(main_model_p->dim_in_I25));
  SET_VECTOR_ELT(state, 556, ScalarInteger(main_model_p->dim_in_I25_1));
  SET_VECTOR_ELT(state, 557, ScalarInteger(main_model_p->dim_in_I25_2));
  SET_VECTOR_ELT(state, 558, allocVector(REALSXP, main_model_p->dim_in_I25));
  memcpy(REAL(VECTOR_ELT(state, 558)), main_model_p->in_I25, main_model_p->dim_in_I25 * sizeof(double));
  odin_set_dim(VECTOR_ELT(state, 558), 2, main_model_p->dim_in_I25_1, main_model_p->dim_in_I25_2);
  SET_VECTOR_ELT(state, 559, ScalarInteger(main_model_p->dim_in_I32));
  SET_VECTOR_ELT(state, 560, ScalarInteger(main_model_p->dim_in_I32_1));
  SET_VECTOR_ELT(state, 561, ScalarInteger(main_model_p->dim_in_I32_2));
  SET_VECTOR_ELT(state, 562, allocVector(REALSXP, main_model_p->dim_in_I32));
  memcpy(REAL(VECTOR_ELT(state, 562)), main_model_p->in_I32, main_model_p->dim_in_I32 * sizeof(double));
  odin_set_dim(VECTOR_ELT(state, 562), 2, main_model_p->dim_in_I32_1, main_model_p->dim_in_I32_2);
  SET_VECTOR_ELT(state, 563, ScalarInteger(main_model_p->dim_in_I33));
  SET_VECTOR_ELT(state, 564, ScalarInteger(main_model_p->dim_in_I33_1));
  SET_VECTOR_ELT(state, 565, ScalarInteger(main_model_p->dim_in_I33_2));
  SET_VECTOR_ELT(state, 566, allocVector(REALSXP, main_model_p->dim_in_I33));
  memcpy(REAL(VECTOR_ELT(state, 566)), main_model_p->in_I33, main_model_p->dim_in_I33 * sizeof(double));
  odin_set_dim(VECTOR_ELT(state, 566), 2, main_model_p->dim_in_I33_1, main_model_p->dim_in_I33_2);
  SET_VECTOR_ELT(state, 567, ScalarInteger(main_model_p->dim_in_I34));
  SET_VECTOR_ELT(state, 568, ScalarInteger(main_model_p->dim_in_I34_1));
  SET_VECTOR_ELT(state, 569, ScalarInteger(main_model_p->dim_in_I34_2));
  SET_VECTOR_ELT(state, 570, allocVector(REALSXP, main_model_p->dim_in_I34));
  memcpy(REAL(VECTOR_ELT(state, 570)), main_model_p->in_I34, main_model_p->dim_in_I34 * sizeof(double));
  odin_set_dim(VECTOR_ELT(state, 570), 2, main_model_p->dim_in_I34_1, main_model_p->dim_in_I34_2);
  SET_VECTOR_ELT(state, 571, ScalarInteger(main_model_p->dim_in_I35));
  SET_VECTOR_ELT(state, 572, ScalarInteger(main_model_p->dim_in_I35_1));
  SET_VECTOR_ELT(state, 573, ScalarInteger(main_model_p->dim_in_I35_2));
  SET_VECTOR_ELT(state, 574, allocVector(REALSXP, main_model_p->dim_in_I35));
  memcpy(REAL(VECTOR_ELT(state, 574)), main_model_p->in_I35, main_model_p->dim_in_I35 * sizeof(double));
  odin_set_dim(VECTOR_ELT(state, 574), 2, main_model_p->dim_in_I35_1, main_model_p->dim_in_I35_2);
  SET_VECTOR_ELT(state, 575, ScalarInteger(main_model_p->dim_in_I42));
  SET_VECTOR_ELT(state, 576, ScalarInteger(main_model_p->dim_in_I42_1));
  SET_VECTOR_ELT(state, 577, ScalarInteger(main_model_p->dim_in_I42_2));
  SET_VECTOR_ELT(state, 578, allocVector(REALSXP, main_model_p->dim_in_I42));
  memcpy(REAL(VECTOR_ELT(state, 578)), main_model_p->in_I42, main_model_p->dim_in_I42 * sizeof(double));
  odin_set_dim(VECTOR_ELT(state, 578), 2, main_model_p->dim_in_I42_1, main_model_p->dim_in_I42_2);
  SET_VECTOR_ELT(state, 579, ScalarInteger(main_model_p->dim_in_I43));
  SET_VECTOR_ELT(state, 580, ScalarInteger(main_model_p->dim_in_I43_1));
  SET_VECTOR_ELT(state, 581, ScalarInteger(main_model_p->dim_in_I43_2));
  SET_VECTOR_ELT(state, 582, allocVector(REALSXP, main_model_p->dim_in_I43));
  memcpy(REAL(VECTOR_ELT(state, 582)), main_model_p->in_I43, main_model_p->dim_in_I43 * sizeof(double));
  odin_set_dim(VECTOR_ELT(state, 582), 2, main_model_p->dim_in_I43_1, main_model_p->dim_in_I43_2);
  SET_VECTOR_ELT(state, 583, ScalarInteger(main_model_p->dim_in_I44));
  SET_VECTOR_ELT(state, 584, ScalarInteger(main_model_p->dim_in_I44_1));
  SET_VECTOR_ELT(state, 585, ScalarInteger(main_model_p->dim_in_I44_2));
  SET_VECTOR_ELT(state, 586, allocVector(REALSXP, main_model_p->dim_in_I44));
  memcpy(REAL(VECTOR_ELT(state, 586)), main_model_p->in_I44, main_model_p->dim_in_I44 * sizeof(double));
  odin_set_dim(VECTOR_ELT(state, 586), 2, main_model_p->dim_in_I44_1, main_model_p->dim_in_I44_2);
  SET_VECTOR_ELT(state, 587, ScalarInteger(main_model_p->dim_in_I45));
  SET_VECTOR_ELT(state, 588, ScalarInteger(main_model_p->dim_in_I45_1));
  SET_VECTOR_ELT(state, 589, ScalarInteger(main_model_p->dim_in_I45_2));
  SET_VECTOR_ELT(state, 590, allocVector(REALSXP, main_model_p->dim_in_I45));
  memcpy(REAL(VECTOR_ELT(state, 590)), main_model_p->in_I45, main_model_p->dim_in_I45 * sizeof(double));
  odin_set_dim(VECTOR_ELT(state, 590), 2, main_model_p->dim_in_I45_1, main_model_p->dim_in_I45_2);
  SET_VECTOR_ELT(state, 591, ScalarInteger(main_model_p->dim_sum_in_S0));
  SET_VECTOR_ELT(state, 592, allocVector(REALSXP, main_model_p->dim_sum_in_S0));
  memcpy(REAL(VECTOR_ELT(state, 592)), main_model_p->sum_in_S0, main_model_p->dim_sum_in_S0 * sizeof(double));
  SET_VECTOR_ELT(state, 593, ScalarInteger(main_model_p->offset_output_sum_in_S0));
  SET_VECTOR_ELT(state, 594, ScalarInteger(main_model_p->dim_rate_move_in));
  SET_VECTOR_ELT(state, 595, ScalarInteger(main_model_p->dim_rate_move_in_1));
  SET_VECTOR_ELT(state, 596, ScalarInteger(main_model_p->dim_rate_move_in_2));
  SET_VECTOR_ELT(state, 597, allocVector(REALSXP, main_model_p->dim_rate_move_in));
  memcpy(REAL(VECTOR_ELT(state, 597)), main_model_p->rate_move_in, main_model_p->dim_rate_move_in * sizeof(double));
  odin_set_dim(VECTOR_ELT(state, 597), 2, main_model_p->dim_rate_move_in_1, main_model_p->dim_rate_move_in_2);
  SET_VECTOR_ELT(state, 598, ScalarInteger(main_model_p->offset_output_rate_move_in));
  SET_VECTOR_ELT(state, 599, ScalarInteger(main_model_p->dim_rate_move_out));
  SET_VECTOR_ELT(state, 600, allocVector(REALSXP, main_model_p->dim_rate_move_out));
  memcpy(REAL(VECTOR_ELT(state, 600)), main_model_p->rate_move_out, main_model_p->dim_rate_move_out * sizeof(double));
  SET_VECTOR_ELT(state, 601, ScalarInteger(main_model_p->offset_output_rate_move_out));
  SET_VECTOR_ELT(state, 607, ScalarReal(main_model_p->epsilon));
  SET_VECTOR_ELT(state, 615, ScalarInteger(main_model_p->dim));
  SET_VECTOR_ELT(state, 616, ScalarInteger(main_model_p->dim_output));
  SEXP state_names = PROTECT(allocVector(STRSXP, 617));
  SET_STRING_ELT(state_names, 0, mkChar("odin_use_dde"));
  SET_STRING_ELT(state_names, 1, mkChar("replaceDeaths"));
  SET_STRING_ELT(state_names, 2, mkChar("dim_c_t_comm"));
  SET_STRING_ELT(state_names, 3, mkChar("c_t_comm"));
  SET_STRING_ELT(state_names, 4, mkChar("dim_c_t_noncomm"));
  SET_STRING_ELT(state_names, 5, mkChar("c_t_noncomm"));
  SET_STRING_ELT(state_names, 6, mkChar("dim_c_y_comm"));
  SET_STRING_ELT(state_names, 7, mkChar("dim_c_y_comm_1"));
  SET_STRING_ELT(state_names, 8, mkChar("dim_c_y_comm_2"));
  SET_STRING_ELT(state_names, 9, mkChar("c_y_comm"));
  SET_STRING_ELT(state_names, 10, mkChar("dim_c_y_noncomm"));
  SET_STRING_ELT(state_names, 11, mkChar("dim_c_y_noncomm_1"));
  SET_STRING_ELT(state_names, 12, mkChar("dim_c_y_noncomm_2"));
  SET_STRING_ELT(state_names, 13, mkChar("c_y_noncomm"));
  SET_STRING_ELT(state_names, 14, mkChar("who_believe_comm"));
  SET_STRING_ELT(state_names, 15, mkChar("dim_testing_prob_t"));
  SET_STRING_ELT(state_names, 16, mkChar("testing_prob_t"));
  SET_STRING_ELT(state_names, 17, mkChar("dim_testing_prob_y"));
  SET_STRING_ELT(state_names, 18, mkChar("dim_testing_prob_y_1"));
  SET_STRING_ELT(state_names, 19, mkChar("dim_testing_prob_y_2"));
  SET_STRING_ELT(state_names, 20, mkChar("testing_prob_y"));
  SET_STRING_ELT(state_names, 21, mkChar("dim_ART_prob_t"));
  SET_STRING_ELT(state_names, 22, mkChar("ART_prob_t"));
  SET_STRING_ELT(state_names, 23, mkChar("dim_ART_prob_y"));
  SET_STRING_ELT(state_names, 24, mkChar("dim_ART_prob_y_1"));
  SET_STRING_ELT(state_names, 25, mkChar("dim_ART_prob_y_2"));
  SET_STRING_ELT(state_names, 26, mkChar("ART_prob_y"));
  SET_STRING_ELT(state_names, 27, mkChar("RR_test_onPrEP"));
  SET_STRING_ELT(state_names, 28, mkChar("RR_test_CD4200"));
  SET_STRING_ELT(state_names, 29, mkChar("RR_ART_CD4200"));
  SET_STRING_ELT(state_names, 30, mkChar("Ncat"));
  SET_STRING_ELT(state_names, 31, mkChar("Nage"));
  SET_STRING_ELT(state_names, 32, mkChar("infect_ART"));
  SET_STRING_ELT(state_names, 33, mkChar("infect_acute"));
  SET_STRING_ELT(state_names, 34, mkChar("infect_AIDS"));
  SET_STRING_ELT(state_names, 35, mkChar("R"));
  SET_STRING_ELT(state_names, 36, mkChar("dim_epsilon_t"));
  SET_STRING_ELT(state_names, 37, mkChar("epsilon_t"));
  SET_STRING_ELT(state_names, 38, mkChar("dim_epsilon_y"));
  SET_STRING_ELT(state_names, 39, mkChar("epsilon_y"));
  SET_STRING_ELT(state_names, 40, mkChar("dim_fc_t_comm"));
  SET_STRING_ELT(state_names, 41, mkChar("fc_t_comm"));
  SET_STRING_ELT(state_names, 42, mkChar("dim_fc_y_comm"));
  SET_STRING_ELT(state_names, 43, mkChar("dim_fc_y_comm_1"));
  SET_STRING_ELT(state_names, 44, mkChar("dim_fc_y_comm_2"));
  SET_STRING_ELT(state_names, 45, mkChar("dim_fc_y_comm_3"));
  SET_STRING_ELT(state_names, 46, mkChar("dim_fc_y_comm_12"));
  SET_STRING_ELT(state_names, 47, mkChar("fc_y_comm"));
  SET_STRING_ELT(state_names, 48, mkChar("dim_fP_t_comm"));
  SET_STRING_ELT(state_names, 49, mkChar("fP_t_comm"));
  SET_STRING_ELT(state_names, 50, mkChar("dim_fP_y_comm"));
  SET_STRING_ELT(state_names, 51, mkChar("dim_fP_y_comm_1"));
  SET_STRING_ELT(state_names, 52, mkChar("dim_fP_y_comm_2"));
  SET_STRING_ELT(state_names, 53, mkChar("fP_y_comm"));
  SET_STRING_ELT(state_names, 54, mkChar("dim_fc_t_noncomm"));
  SET_STRING_ELT(state_names, 55, mkChar("fc_t_noncomm"));
  SET_STRING_ELT(state_names, 56, mkChar("dim_fc_y_noncomm"));
  SET_STRING_ELT(state_names, 57, mkChar("dim_fc_y_noncomm_1"));
  SET_STRING_ELT(state_names, 58, mkChar("dim_fc_y_noncomm_2"));
  SET_STRING_ELT(state_names, 59, mkChar("dim_fc_y_noncomm_3"));
  SET_STRING_ELT(state_names, 60, mkChar("dim_fc_y_noncomm_12"));
  SET_STRING_ELT(state_names, 61, mkChar("fc_y_noncomm"));
  SET_STRING_ELT(state_names, 62, mkChar("dim_fP_t_noncomm"));
  SET_STRING_ELT(state_names, 63, mkChar("fP_t_noncomm"));
  SET_STRING_ELT(state_names, 64, mkChar("dim_fP_y_noncomm"));
  SET_STRING_ELT(state_names, 65, mkChar("dim_fP_y_noncomm_1"));
  SET_STRING_ELT(state_names, 66, mkChar("dim_fP_y_noncomm_2"));
  SET_STRING_ELT(state_names, 67, mkChar("fP_y_noncomm"));
  SET_STRING_ELT(state_names, 68, mkChar("dur_FSW"));
  SET_STRING_ELT(state_names, 69, mkChar("dim_zetaa_t"));
  SET_STRING_ELT(state_names, 70, mkChar("zetaa_t"));
  SET_STRING_ELT(state_names, 71, mkChar("dim_zetab_t"));
  SET_STRING_ELT(state_names, 72, mkChar("zetab_t"));
  SET_STRING_ELT(state_names, 73, mkChar("dim_zetac_t"));
  SET_STRING_ELT(state_names, 74, mkChar("zetac_t"));
  SET_STRING_ELT(state_names, 75, mkChar("dim_zetaa_y"));
  SET_STRING_ELT(state_names, 76, mkChar("dim_zetaa_y_1"));
  SET_STRING_ELT(state_names, 77, mkChar("dim_zetaa_y_2"));
  SET_STRING_ELT(state_names, 78, mkChar("zetaa_y"));
  SET_STRING_ELT(state_names, 79, mkChar("dim_zetab_y"));
  SET_STRING_ELT(state_names, 80, mkChar("dim_zetab_y_1"));
  SET_STRING_ELT(state_names, 81, mkChar("dim_zetab_y_2"));
  SET_STRING_ELT(state_names, 82, mkChar("zetab_y"));
  SET_STRING_ELT(state_names, 83, mkChar("dim_zetac_y"));
  SET_STRING_ELT(state_names, 84, mkChar("dim_zetac_y_1"));
  SET_STRING_ELT(state_names, 85, mkChar("dim_zetac_y_2"));
  SET_STRING_ELT(state_names, 86, mkChar("zetac_y"));
  SET_STRING_ELT(state_names, 87, mkChar("dim_c_comm"));
  SET_STRING_ELT(state_names, 88, mkChar("c_comm"));
  SET_STRING_ELT(state_names, 89, mkChar("offset_output_c_comm"));
  SET_STRING_ELT(state_names, 90, mkChar("dim_c_noncomm"));
  SET_STRING_ELT(state_names, 91, mkChar("c_noncomm"));
  SET_STRING_ELT(state_names, 92, mkChar("offset_output_c_noncomm"));
  SET_STRING_ELT(state_names, 93, mkChar("dim_new_people_in_group"));
  SET_STRING_ELT(state_names, 94, mkChar("new_people_in_group"));
  SET_STRING_ELT(state_names, 95, mkChar("offset_output_new_people_in_group"));
  SET_STRING_ELT(state_names, 96, mkChar("dim_comm_partnerships_requested"));
  SET_STRING_ELT(state_names, 97, mkChar("dim_comm_partnerships_requested_1"));
  SET_STRING_ELT(state_names, 98, mkChar("dim_comm_partnerships_requested_2"));
  SET_STRING_ELT(state_names, 99, mkChar("comm_partnerships_requested"));
  SET_STRING_ELT(state_names, 100, mkChar("dim_noncomm_partnerships_requested"));
  SET_STRING_ELT(state_names, 101, mkChar("dim_noncomm_partnerships_requested_1"));
  SET_STRING_ELT(state_names, 102, mkChar("dim_noncomm_partnerships_requested_2"));
  SET_STRING_ELT(state_names, 103, mkChar("noncomm_partnerships_requested"));
  SET_STRING_ELT(state_names, 104, mkChar("dim_testing_prob"));
  SET_STRING_ELT(state_names, 105, mkChar("testing_prob"));
  SET_STRING_ELT(state_names, 106, mkChar("offset_output_testing_prob"));
  SET_STRING_ELT(state_names, 107, mkChar("dim_ART_prob"));
  SET_STRING_ELT(state_names, 108, mkChar("ART_prob"));
  SET_STRING_ELT(state_names, 109, mkChar("offset_output_ART_prob"));
  SET_STRING_ELT(state_names, 110, mkChar("dim_tau"));
  SET_STRING_ELT(state_names, 111, mkChar("tau"));
  SET_STRING_ELT(state_names, 112, mkChar("offset_output_tau"));
  SET_STRING_ELT(state_names, 113, mkChar("dim_rho"));
  SET_STRING_ELT(state_names, 114, mkChar("rho"));
  SET_STRING_ELT(state_names, 115, mkChar("offset_output_rho"));
  SET_STRING_ELT(state_names, 116, mkChar("dim_frac_F"));
  SET_STRING_ELT(state_names, 117, mkChar("frac_F"));
  SET_STRING_ELT(state_names, 118, mkChar("offset_output_frac_F"));
  SET_STRING_ELT(state_names, 119, mkChar("dim_frac_N_sexualpop"));
  SET_STRING_ELT(state_names, 120, mkChar("frac_N_sexualpop"));
  SET_STRING_ELT(state_names, 121, mkChar("offset_output_frac_N_sexualpop"));
  SET_STRING_ELT(state_names, 122, mkChar("dim_zetaa"));
  SET_STRING_ELT(state_names, 123, mkChar("zetaa"));
  SET_STRING_ELT(state_names, 124, mkChar("offset_output_zetaa"));
  SET_STRING_ELT(state_names, 125, mkChar("dim_zetab"));
  SET_STRING_ELT(state_names, 126, mkChar("zetab"));
  SET_STRING_ELT(state_names, 127, mkChar("offset_output_zetab"));
  SET_STRING_ELT(state_names, 128, mkChar("dim_zetac"));
  SET_STRING_ELT(state_names, 129, mkChar("zetac"));
  SET_STRING_ELT(state_names, 130, mkChar("offset_output_zetac"));
  SET_STRING_ELT(state_names, 131, mkChar("dim_omega"));
  SET_STRING_ELT(state_names, 132, mkChar("omega"));
  SET_STRING_ELT(state_names, 133, mkChar("offset_output_omega"));
  SET_STRING_ELT(state_names, 134, mkChar("dim_frac_N"));
  SET_STRING_ELT(state_names, 135, mkChar("frac_N"));
  SET_STRING_ELT(state_names, 136, mkChar("offset_output_frac_N"));
  SET_STRING_ELT(state_names, 137, mkChar("dim_mu"));
  SET_STRING_ELT(state_names, 138, mkChar("mu"));
  SET_STRING_ELT(state_names, 139, mkChar("offset_output_mu"));
  SET_STRING_ELT(state_names, 140, mkChar("dim_gamma01"));
  SET_STRING_ELT(state_names, 141, mkChar("gamma01"));
  SET_STRING_ELT(state_names, 142, mkChar("offset_output_gamma01"));
  SET_STRING_ELT(state_names, 143, mkChar("dim_gamma02"));
  SET_STRING_ELT(state_names, 144, mkChar("gamma02"));
  SET_STRING_ELT(state_names, 145, mkChar("dim_gamma03"));
  SET_STRING_ELT(state_names, 146, mkChar("gamma03"));
  SET_STRING_ELT(state_names, 147, mkChar("dim_gamma04"));
  SET_STRING_ELT(state_names, 148, mkChar("gamma04"));
  SET_STRING_ELT(state_names, 149, mkChar("dim_gamma11"));
  SET_STRING_ELT(state_names, 150, mkChar("gamma11"));
  SET_STRING_ELT(state_names, 151, mkChar("dim_gamma22"));
  SET_STRING_ELT(state_names, 152, mkChar("gamma22"));
  SET_STRING_ELT(state_names, 153, mkChar("dim_gamma23"));
  SET_STRING_ELT(state_names, 154, mkChar("gamma23"));
  SET_STRING_ELT(state_names, 155, mkChar("dim_gamma24"));
  SET_STRING_ELT(state_names, 156, mkChar("gamma24"));
  SET_STRING_ELT(state_names, 157, mkChar("dim_gamma32"));
  SET_STRING_ELT(state_names, 158, mkChar("gamma32"));
  SET_STRING_ELT(state_names, 159, mkChar("dim_gamma33"));
  SET_STRING_ELT(state_names, 160, mkChar("gamma33"));
  SET_STRING_ELT(state_names, 161, mkChar("dim_gamma34"));
  SET_STRING_ELT(state_names, 162, mkChar("gamma34"));
  SET_STRING_ELT(state_names, 163, mkChar("dim_gamma42"));
  SET_STRING_ELT(state_names, 164, mkChar("gamma42"));
  SET_STRING_ELT(state_names, 165, mkChar("dim_gamma43"));
  SET_STRING_ELT(state_names, 166, mkChar("gamma43"));
  SET_STRING_ELT(state_names, 167, mkChar("dim_gamma44"));
  SET_STRING_ELT(state_names, 168, mkChar("gamma44"));
  SET_STRING_ELT(state_names, 169, mkChar("dim_phi2"));
  SET_STRING_ELT(state_names, 170, mkChar("phi2"));
  SET_STRING_ELT(state_names, 171, mkChar("dim_phi3"));
  SET_STRING_ELT(state_names, 172, mkChar("phi3"));
  SET_STRING_ELT(state_names, 173, mkChar("dim_phi4"));
  SET_STRING_ELT(state_names, 174, mkChar("phi4"));
  SET_STRING_ELT(state_names, 175, mkChar("dim_phi5"));
  SET_STRING_ELT(state_names, 176, mkChar("phi5"));
  SET_STRING_ELT(state_names, 177, mkChar("dim_psia"));
  SET_STRING_ELT(state_names, 178, mkChar("psia"));
  SET_STRING_ELT(state_names, 179, mkChar("dim_psib"));
  SET_STRING_ELT(state_names, 180, mkChar("psib"));
  SET_STRING_ELT(state_names, 181, mkChar("dim_kappaa"));
  SET_STRING_ELT(state_names, 182, mkChar("kappaa"));
  SET_STRING_ELT(state_names, 183, mkChar("offset_output_kappaa"));
  SET_STRING_ELT(state_names, 184, mkChar("dim_kappab"));
  SET_STRING_ELT(state_names, 185, mkChar("kappab"));
  SET_STRING_ELT(state_names, 186, mkChar("offset_output_kappab"));
  SET_STRING_ELT(state_names, 187, mkChar("dim_kappac"));
  SET_STRING_ELT(state_names, 188, mkChar("kappac"));
  SET_STRING_ELT(state_names, 189, mkChar("offset_output_kappac"));
  SET_STRING_ELT(state_names, 190, mkChar("dim_alpha01"));
  SET_STRING_ELT(state_names, 191, mkChar("alpha01"));
  SET_STRING_ELT(state_names, 192, mkChar("dim_alpha02"));
  SET_STRING_ELT(state_names, 193, mkChar("alpha02"));
  SET_STRING_ELT(state_names, 194, mkChar("dim_alpha03"));
  SET_STRING_ELT(state_names, 195, mkChar("alpha03"));
  SET_STRING_ELT(state_names, 196, mkChar("dim_alpha04"));
  SET_STRING_ELT(state_names, 197, mkChar("alpha04"));
  SET_STRING_ELT(state_names, 198, mkChar("dim_alpha05"));
  SET_STRING_ELT(state_names, 199, mkChar("alpha05"));
  SET_STRING_ELT(state_names, 200, mkChar("offset_output_alpha05"));
  SET_STRING_ELT(state_names, 201, mkChar("dim_alpha11"));
  SET_STRING_ELT(state_names, 202, mkChar("alpha11"));
  SET_STRING_ELT(state_names, 203, mkChar("dim_alpha22"));
  SET_STRING_ELT(state_names, 204, mkChar("alpha22"));
  SET_STRING_ELT(state_names, 205, mkChar("dim_alpha23"));
  SET_STRING_ELT(state_names, 206, mkChar("alpha23"));
  SET_STRING_ELT(state_names, 207, mkChar("dim_alpha24"));
  SET_STRING_ELT(state_names, 208, mkChar("alpha24"));
  SET_STRING_ELT(state_names, 209, mkChar("dim_alpha25"));
  SET_STRING_ELT(state_names, 210, mkChar("alpha25"));
  SET_STRING_ELT(state_names, 211, mkChar("dim_alpha32"));
  SET_STRING_ELT(state_names, 212, mkChar("alpha32"));
  SET_STRING_ELT(state_names, 213, mkChar("dim_alpha33"));
  SET_STRING_ELT(state_names, 214, mkChar("alpha33"));
  SET_STRING_ELT(state_names, 215, mkChar("dim_alpha34"));
  SET_STRING_ELT(state_names, 216, mkChar("alpha34"));
  SET_STRING_ELT(state_names, 217, mkChar("dim_alpha35"));
  SET_STRING_ELT(state_names, 218, mkChar("alpha35"));
  SET_STRING_ELT(state_names, 219, mkChar("offset_output_alpha35"));
  SET_STRING_ELT(state_names, 220, mkChar("dim_alpha42"));
  SET_STRING_ELT(state_names, 221, mkChar("alpha42"));
  SET_STRING_ELT(state_names, 222, mkChar("dim_alpha43"));
  SET_STRING_ELT(state_names, 223, mkChar("alpha43"));
  SET_STRING_ELT(state_names, 224, mkChar("dim_alpha44"));
  SET_STRING_ELT(state_names, 225, mkChar("alpha44"));
  SET_STRING_ELT(state_names, 226, mkChar("dim_alpha45"));
  SET_STRING_ELT(state_names, 227, mkChar("alpha45"));
  SET_STRING_ELT(state_names, 228, mkChar("dim_beta_comm"));
  SET_STRING_ELT(state_names, 229, mkChar("beta_comm"));
  SET_STRING_ELT(state_names, 230, mkChar("offset_output_beta_comm"));
  SET_STRING_ELT(state_names, 231, mkChar("dim_beta_noncomm"));
  SET_STRING_ELT(state_names, 232, mkChar("beta_noncomm"));
  SET_STRING_ELT(state_names, 233, mkChar("offset_output_beta_noncomm"));
  SET_STRING_ELT(state_names, 234, mkChar("dim_p_comm"));
  SET_STRING_ELT(state_names, 235, mkChar("dim_p_comm_1"));
  SET_STRING_ELT(state_names, 236, mkChar("dim_p_comm_2"));
  SET_STRING_ELT(state_names, 237, mkChar("p_comm"));
  SET_STRING_ELT(state_names, 238, mkChar("offset_output_p_comm"));
  SET_STRING_ELT(state_names, 239, mkChar("dim_p_noncomm"));
  SET_STRING_ELT(state_names, 240, mkChar("dim_p_noncomm_1"));
  SET_STRING_ELT(state_names, 241, mkChar("dim_p_noncomm_2"));
  SET_STRING_ELT(state_names, 242, mkChar("p_noncomm"));
  SET_STRING_ELT(state_names, 243, mkChar("offset_output_p_noncomm"));
  SET_STRING_ELT(state_names, 244, mkChar("dim_ec"));
  SET_STRING_ELT(state_names, 245, mkChar("ec"));
  SET_STRING_ELT(state_names, 246, mkChar("dim_eP"));
  SET_STRING_ELT(state_names, 247, mkChar("eP"));
  SET_STRING_ELT(state_names, 248, mkChar("dim_eP0"));
  SET_STRING_ELT(state_names, 249, mkChar("eP0"));
  SET_STRING_ELT(state_names, 250, mkChar("dim_eP1a"));
  SET_STRING_ELT(state_names, 251, mkChar("eP1a"));
  SET_STRING_ELT(state_names, 252, mkChar("dim_eP1b"));
  SET_STRING_ELT(state_names, 253, mkChar("eP1b"));
  SET_STRING_ELT(state_names, 254, mkChar("dim_eP1c"));
  SET_STRING_ELT(state_names, 255, mkChar("eP1c"));
  SET_STRING_ELT(state_names, 256, mkChar("dim_eP1d"));
  SET_STRING_ELT(state_names, 257, mkChar("eP1d"));
  SET_STRING_ELT(state_names, 258, mkChar("dim_fc_comm"));
  SET_STRING_ELT(state_names, 259, mkChar("dim_fc_comm_1"));
  SET_STRING_ELT(state_names, 260, mkChar("dim_fc_comm_2"));
  SET_STRING_ELT(state_names, 261, mkChar("fc_comm"));
  SET_STRING_ELT(state_names, 262, mkChar("offset_output_fc_comm"));
  SET_STRING_ELT(state_names, 263, mkChar("dim_fP_comm"));
  SET_STRING_ELT(state_names, 264, mkChar("fP_comm"));
  SET_STRING_ELT(state_names, 265, mkChar("offset_output_fP_comm"));
  SET_STRING_ELT(state_names, 266, mkChar("dim_fc_noncomm"));
  SET_STRING_ELT(state_names, 267, mkChar("dim_fc_noncomm_1"));
  SET_STRING_ELT(state_names, 268, mkChar("dim_fc_noncomm_2"));
  SET_STRING_ELT(state_names, 269, mkChar("fc_noncomm"));
  SET_STRING_ELT(state_names, 270, mkChar("offset_output_fc_noncomm"));
  SET_STRING_ELT(state_names, 271, mkChar("dim_fP_noncomm"));
  SET_STRING_ELT(state_names, 272, mkChar("fP_noncomm"));
  SET_STRING_ELT(state_names, 273, mkChar("offset_output_fP_noncomm"));
  SET_STRING_ELT(state_names, 274, mkChar("dim_n_comm"));
  SET_STRING_ELT(state_names, 275, mkChar("dim_n_comm_1"));
  SET_STRING_ELT(state_names, 276, mkChar("dim_n_comm_2"));
  SET_STRING_ELT(state_names, 277, mkChar("n_comm"));
  SET_STRING_ELT(state_names, 278, mkChar("offset_output_n_comm"));
  SET_STRING_ELT(state_names, 279, mkChar("dim_n_noncomm"));
  SET_STRING_ELT(state_names, 280, mkChar("dim_n_noncomm_1"));
  SET_STRING_ELT(state_names, 281, mkChar("dim_n_noncomm_2"));
  SET_STRING_ELT(state_names, 282, mkChar("n_noncomm"));
  SET_STRING_ELT(state_names, 283, mkChar("offset_output_n_noncomm"));
  SET_STRING_ELT(state_names, 284, mkChar("dim_cumuInf"));
  SET_STRING_ELT(state_names, 285, mkChar("initial_cumuInf"));
  SET_STRING_ELT(state_names, 286, mkChar("offset_cumuInf"));
  SET_STRING_ELT(state_names, 287, mkChar("dim_OnPrEP"));
  SET_STRING_ELT(state_names, 288, mkChar("initial_OnPrEP"));
  SET_STRING_ELT(state_names, 289, mkChar("offset_OnPrEP"));
  SET_STRING_ELT(state_names, 290, mkChar("dim_S0"));
  SET_STRING_ELT(state_names, 291, mkChar("initial_S0"));
  SET_STRING_ELT(state_names, 292, mkChar("offset_S0"));
  SET_STRING_ELT(state_names, 293, mkChar("dim_S1a"));
  SET_STRING_ELT(state_names, 294, mkChar("initial_S1a"));
  SET_STRING_ELT(state_names, 295, mkChar("offset_S1a"));
  SET_STRING_ELT(state_names, 296, mkChar("dim_S1b"));
  SET_STRING_ELT(state_names, 297, mkChar("initial_S1b"));
  SET_STRING_ELT(state_names, 298, mkChar("offset_S1b"));
  SET_STRING_ELT(state_names, 299, mkChar("dim_S1c"));
  SET_STRING_ELT(state_names, 300, mkChar("initial_S1c"));
  SET_STRING_ELT(state_names, 301, mkChar("offset_S1c"));
  SET_STRING_ELT(state_names, 302, mkChar("dim_S1d"));
  SET_STRING_ELT(state_names, 303, mkChar("initial_S1d"));
  SET_STRING_ELT(state_names, 304, mkChar("offset_S1d"));
  SET_STRING_ELT(state_names, 305, mkChar("dim_I01"));
  SET_STRING_ELT(state_names, 306, mkChar("initial_I01"));
  SET_STRING_ELT(state_names, 307, mkChar("offset_I01"));
  SET_STRING_ELT(state_names, 308, mkChar("dim_I11"));
  SET_STRING_ELT(state_names, 309, mkChar("initial_I11"));
  SET_STRING_ELT(state_names, 310, mkChar("offset_I11"));
  SET_STRING_ELT(state_names, 311, mkChar("dim_I02"));
  SET_STRING_ELT(state_names, 312, mkChar("initial_I02"));
  SET_STRING_ELT(state_names, 313, mkChar("offset_I02"));
  SET_STRING_ELT(state_names, 314, mkChar("dim_I03"));
  SET_STRING_ELT(state_names, 315, mkChar("initial_I03"));
  SET_STRING_ELT(state_names, 316, mkChar("offset_I03"));
  SET_STRING_ELT(state_names, 317, mkChar("dim_I04"));
  SET_STRING_ELT(state_names, 318, mkChar("initial_I04"));
  SET_STRING_ELT(state_names, 319, mkChar("offset_I04"));
  SET_STRING_ELT(state_names, 320, mkChar("dim_I05"));
  SET_STRING_ELT(state_names, 321, mkChar("initial_I05"));
  SET_STRING_ELT(state_names, 322, mkChar("offset_I05"));
  SET_STRING_ELT(state_names, 323, mkChar("dim_I22"));
  SET_STRING_ELT(state_names, 324, mkChar("initial_I22"));
  SET_STRING_ELT(state_names, 325, mkChar("offset_I22"));
  SET_STRING_ELT(state_names, 326, mkChar("dim_I23"));
  SET_STRING_ELT(state_names, 327, mkChar("initial_I23"));
  SET_STRING_ELT(state_names, 328, mkChar("offset_I23"));
  SET_STRING_ELT(state_names, 329, mkChar("dim_I24"));
  SET_STRING_ELT(state_names, 330, mkChar("initial_I24"));
  SET_STRING_ELT(state_names, 331, mkChar("offset_I24"));
  SET_STRING_ELT(state_names, 332, mkChar("dim_I25"));
  SET_STRING_ELT(state_names, 333, mkChar("initial_I25"));
  SET_STRING_ELT(state_names, 334, mkChar("offset_I25"));
  SET_STRING_ELT(state_names, 335, mkChar("dim_I32"));
  SET_STRING_ELT(state_names, 336, mkChar("initial_I32"));
  SET_STRING_ELT(state_names, 337, mkChar("offset_I32"));
  SET_STRING_ELT(state_names, 338, mkChar("dim_I33"));
  SET_STRING_ELT(state_names, 339, mkChar("initial_I33"));
  SET_STRING_ELT(state_names, 340, mkChar("offset_I33"));
  SET_STRING_ELT(state_names, 341, mkChar("dim_I34"));
  SET_STRING_ELT(state_names, 342, mkChar("initial_I34"));
  SET_STRING_ELT(state_names, 343, mkChar("offset_I34"));
  SET_STRING_ELT(state_names, 344, mkChar("dim_I35"));
  SET_STRING_ELT(state_names, 345, mkChar("initial_I35"));
  SET_STRING_ELT(state_names, 346, mkChar("offset_I35"));
  SET_STRING_ELT(state_names, 347, mkChar("dim_I42"));
  SET_STRING_ELT(state_names, 348, mkChar("initial_I42"));
  SET_STRING_ELT(state_names, 349, mkChar("offset_I42"));
  SET_STRING_ELT(state_names, 350, mkChar("dim_I43"));
  SET_STRING_ELT(state_names, 351, mkChar("initial_I43"));
  SET_STRING_ELT(state_names, 352, mkChar("offset_I43"));
  SET_STRING_ELT(state_names, 353, mkChar("dim_I44"));
  SET_STRING_ELT(state_names, 354, mkChar("initial_I44"));
  SET_STRING_ELT(state_names, 355, mkChar("offset_I44"));
  SET_STRING_ELT(state_names, 356, mkChar("dim_I45"));
  SET_STRING_ELT(state_names, 357, mkChar("initial_I45"));
  SET_STRING_ELT(state_names, 358, mkChar("offset_I45"));
  SET_STRING_ELT(state_names, 359, mkChar("dim_S0_init"));
  SET_STRING_ELT(state_names, 360, mkChar("S0_init"));
  SET_STRING_ELT(state_names, 361, mkChar("dim_S1a_init"));
  SET_STRING_ELT(state_names, 362, mkChar("S1a_init"));
  SET_STRING_ELT(state_names, 363, mkChar("dim_S1b_init"));
  SET_STRING_ELT(state_names, 364, mkChar("S1b_init"));
  SET_STRING_ELT(state_names, 365, mkChar("dim_S1c_init"));
  SET_STRING_ELT(state_names, 366, mkChar("S1c_init"));
  SET_STRING_ELT(state_names, 367, mkChar("dim_S1d_init"));
  SET_STRING_ELT(state_names, 368, mkChar("S1d_init"));
  SET_STRING_ELT(state_names, 369, mkChar("dim_I01_init"));
  SET_STRING_ELT(state_names, 370, mkChar("I01_init"));
  SET_STRING_ELT(state_names, 371, mkChar("dim_I11_init"));
  SET_STRING_ELT(state_names, 372, mkChar("I11_init"));
  SET_STRING_ELT(state_names, 373, mkChar("dim_I02_init"));
  SET_STRING_ELT(state_names, 374, mkChar("I02_init"));
  SET_STRING_ELT(state_names, 375, mkChar("dim_I03_init"));
  SET_STRING_ELT(state_names, 376, mkChar("I03_init"));
  SET_STRING_ELT(state_names, 377, mkChar("dim_I04_init"));
  SET_STRING_ELT(state_names, 378, mkChar("I04_init"));
  SET_STRING_ELT(state_names, 379, mkChar("dim_I05_init"));
  SET_STRING_ELT(state_names, 380, mkChar("I05_init"));
  SET_STRING_ELT(state_names, 381, mkChar("dim_I22_init"));
  SET_STRING_ELT(state_names, 382, mkChar("I22_init"));
  SET_STRING_ELT(state_names, 383, mkChar("dim_I23_init"));
  SET_STRING_ELT(state_names, 384, mkChar("I23_init"));
  SET_STRING_ELT(state_names, 385, mkChar("dim_I24_init"));
  SET_STRING_ELT(state_names, 386, mkChar("I24_init"));
  SET_STRING_ELT(state_names, 387, mkChar("dim_I25_init"));
  SET_STRING_ELT(state_names, 388, mkChar("I25_init"));
  SET_STRING_ELT(state_names, 389, mkChar("dim_I32_init"));
  SET_STRING_ELT(state_names, 390, mkChar("I32_init"));
  SET_STRING_ELT(state_names, 391, mkChar("dim_I33_init"));
  SET_STRING_ELT(state_names, 392, mkChar("I33_init"));
  SET_STRING_ELT(state_names, 393, mkChar("dim_I34_init"));
  SET_STRING_ELT(state_names, 394, mkChar("I34_init"));
  SET_STRING_ELT(state_names, 395, mkChar("dim_I35_init"));
  SET_STRING_ELT(state_names, 396, mkChar("I35_init"));
  SET_STRING_ELT(state_names, 397, mkChar("dim_I42_init"));
  SET_STRING_ELT(state_names, 398, mkChar("I42_init"));
  SET_STRING_ELT(state_names, 399, mkChar("dim_I43_init"));
  SET_STRING_ELT(state_names, 400, mkChar("I43_init"));
  SET_STRING_ELT(state_names, 401, mkChar("dim_I44_init"));
  SET_STRING_ELT(state_names, 402, mkChar("I44_init"));
  SET_STRING_ELT(state_names, 403, mkChar("dim_I45_init"));
  SET_STRING_ELT(state_names, 404, mkChar("I45_init"));
  SET_STRING_ELT(state_names, 405, mkChar("dim_N"));
  SET_STRING_ELT(state_names, 406, mkChar("N"));
  SET_STRING_ELT(state_names, 407, mkChar("offset_output_N"));
  SET_STRING_ELT(state_names, 408, mkChar("dim_E0"));
  SET_STRING_ELT(state_names, 409, mkChar("E0"));
  SET_STRING_ELT(state_names, 410, mkChar("offset_output_E0"));
  SET_STRING_ELT(state_names, 411, mkChar("dim_E1a"));
  SET_STRING_ELT(state_names, 412, mkChar("E1a"));
  SET_STRING_ELT(state_names, 413, mkChar("offset_output_E1a"));
  SET_STRING_ELT(state_names, 414, mkChar("dim_E1b"));
  SET_STRING_ELT(state_names, 415, mkChar("E1b"));
  SET_STRING_ELT(state_names, 416, mkChar("offset_output_E1b"));
  SET_STRING_ELT(state_names, 417, mkChar("dim_E1c"));
  SET_STRING_ELT(state_names, 418, mkChar("E1c"));
  SET_STRING_ELT(state_names, 419, mkChar("offset_output_E1c"));
  SET_STRING_ELT(state_names, 420, mkChar("dim_E1d"));
  SET_STRING_ELT(state_names, 421, mkChar("E1d"));
  SET_STRING_ELT(state_names, 422, mkChar("offset_output_E1d"));
  SET_STRING_ELT(state_names, 423, mkChar("dim_cumuInf_init"));
  SET_STRING_ELT(state_names, 424, mkChar("cumuInf_init"));
  SET_STRING_ELT(state_names, 425, mkChar("dim_alphaItot"));
  SET_STRING_ELT(state_names, 426, mkChar("alphaItot"));
  SET_STRING_ELT(state_names, 427, mkChar("offset_output_alphaItot"));
  SET_STRING_ELT(state_names, 428, mkChar("dim_prev"));
  SET_STRING_ELT(state_names, 429, mkChar("prev"));
  SET_STRING_ELT(state_names, 430, mkChar("offset_output_prev"));
  SET_STRING_ELT(state_names, 431, mkChar("dim_lambda"));
  SET_STRING_ELT(state_names, 432, mkChar("dim_lambda_1"));
  SET_STRING_ELT(state_names, 433, mkChar("dim_lambda_2"));
  SET_STRING_ELT(state_names, 434, mkChar("lambda"));
  SET_STRING_ELT(state_names, 435, mkChar("offset_output_lambda"));
  SET_STRING_ELT(state_names, 436, mkChar("dim_lambda_0"));
  SET_STRING_ELT(state_names, 437, mkChar("dim_lambda_0_1"));
  SET_STRING_ELT(state_names, 438, mkChar("dim_lambda_0_2"));
  SET_STRING_ELT(state_names, 439, mkChar("lambda_0"));
  SET_STRING_ELT(state_names, 440, mkChar("offset_output_lambda_0"));
  SET_STRING_ELT(state_names, 441, mkChar("dim_lambda_1a"));
  SET_STRING_ELT(state_names, 442, mkChar("dim_lambda_1a_1"));
  SET_STRING_ELT(state_names, 443, mkChar("dim_lambda_1a_2"));
  SET_STRING_ELT(state_names, 444, mkChar("lambda_1a"));
  SET_STRING_ELT(state_names, 445, mkChar("offset_output_lambda_1a"));
  SET_STRING_ELT(state_names, 446, mkChar("dim_lambda_1b"));
  SET_STRING_ELT(state_names, 447, mkChar("dim_lambda_1b_1"));
  SET_STRING_ELT(state_names, 448, mkChar("dim_lambda_1b_2"));
  SET_STRING_ELT(state_names, 449, mkChar("lambda_1b"));
  SET_STRING_ELT(state_names, 450, mkChar("offset_output_lambda_1b"));
  SET_STRING_ELT(state_names, 451, mkChar("dim_lambda_1c"));
  SET_STRING_ELT(state_names, 452, mkChar("dim_lambda_1c_1"));
  SET_STRING_ELT(state_names, 453, mkChar("dim_lambda_1c_2"));
  SET_STRING_ELT(state_names, 454, mkChar("lambda_1c"));
  SET_STRING_ELT(state_names, 455, mkChar("offset_output_lambda_1c"));
  SET_STRING_ELT(state_names, 456, mkChar("dim_lambda_1d"));
  SET_STRING_ELT(state_names, 457, mkChar("dim_lambda_1d_1"));
  SET_STRING_ELT(state_names, 458, mkChar("dim_lambda_1d_2"));
  SET_STRING_ELT(state_names, 459, mkChar("lambda_1d"));
  SET_STRING_ELT(state_names, 460, mkChar("offset_output_lambda_1d"));
  SET_STRING_ELT(state_names, 461, mkChar("dim_lambda_sum_0"));
  SET_STRING_ELT(state_names, 462, mkChar("lambda_sum_0"));
  SET_STRING_ELT(state_names, 463, mkChar("offset_output_lambda_sum_0"));
  SET_STRING_ELT(state_names, 464, mkChar("dim_lambda_sum_1a"));
  SET_STRING_ELT(state_names, 465, mkChar("lambda_sum_1a"));
  SET_STRING_ELT(state_names, 466, mkChar("offset_output_lambda_sum_1a"));
  SET_STRING_ELT(state_names, 467, mkChar("dim_lambda_sum_1b"));
  SET_STRING_ELT(state_names, 468, mkChar("lambda_sum_1b"));
  SET_STRING_ELT(state_names, 469, mkChar("offset_output_lambda_sum_1b"));
  SET_STRING_ELT(state_names, 470, mkChar("dim_lambda_sum_1c"));
  SET_STRING_ELT(state_names, 471, mkChar("lambda_sum_1c"));
  SET_STRING_ELT(state_names, 472, mkChar("offset_output_lambda_sum_1c"));
  SET_STRING_ELT(state_names, 473, mkChar("dim_lambda_sum_1d"));
  SET_STRING_ELT(state_names, 474, mkChar("lambda_sum_1d"));
  SET_STRING_ELT(state_names, 475, mkChar("offset_output_lambda_sum_1d"));
  SET_STRING_ELT(state_names, 476, mkChar("dim_c_comm_balanced"));
  SET_STRING_ELT(state_names, 477, mkChar("c_comm_balanced"));
  SET_STRING_ELT(state_names, 478, mkChar("offset_output_c_comm_balanced"));
  SET_STRING_ELT(state_names, 479, mkChar("dim_c_noncomm_balanced"));
  SET_STRING_ELT(state_names, 480, mkChar("c_noncomm_balanced"));
  SET_STRING_ELT(state_names, 481, mkChar("offset_output_c_noncomm_balanced"));
  SET_STRING_ELT(state_names, 482, mkChar("dim_theta"));
  SET_STRING_ELT(state_names, 483, mkChar("dim_theta_1"));
  SET_STRING_ELT(state_names, 484, mkChar("dim_theta_2"));
  SET_STRING_ELT(state_names, 485, mkChar("theta"));
  SET_STRING_ELT(state_names, 486, mkChar("offset_output_theta"));
  SET_STRING_ELT(state_names, 487, mkChar("dim_OnPrEP_init"));
  SET_STRING_ELT(state_names, 488, mkChar("OnPrEP_init"));
  SET_STRING_ELT(state_names, 489, mkChar("dim_M_comm"));
  SET_STRING_ELT(state_names, 490, mkChar("dim_M_comm_1"));
  SET_STRING_ELT(state_names, 491, mkChar("dim_M_comm_2"));
  SET_STRING_ELT(state_names, 492, mkChar("M_comm"));
  SET_STRING_ELT(state_names, 493, mkChar("offset_output_M_comm"));
  SET_STRING_ELT(state_names, 494, mkChar("dim_M_noncomm"));
  SET_STRING_ELT(state_names, 495, mkChar("dim_M_noncomm_1"));
  SET_STRING_ELT(state_names, 496, mkChar("dim_M_noncomm_2"));
  SET_STRING_ELT(state_names, 497, mkChar("M_noncomm"));
  SET_STRING_ELT(state_names, 498, mkChar("offset_output_M_noncomm"));
  SET_STRING_ELT(state_names, 499, mkChar("dim_in_S0"));
  SET_STRING_ELT(state_names, 500, mkChar("dim_in_S0_1"));
  SET_STRING_ELT(state_names, 501, mkChar("dim_in_S0_2"));
  SET_STRING_ELT(state_names, 502, mkChar("in_S0"));
  SET_STRING_ELT(state_names, 503, mkChar("dim_in_S1a"));
  SET_STRING_ELT(state_names, 504, mkChar("dim_in_S1a_1"));
  SET_STRING_ELT(state_names, 505, mkChar("dim_in_S1a_2"));
  SET_STRING_ELT(state_names, 506, mkChar("in_S1a"));
  SET_STRING_ELT(state_names, 507, mkChar("dim_in_S1b"));
  SET_STRING_ELT(state_names, 508, mkChar("dim_in_S1b_1"));
  SET_STRING_ELT(state_names, 509, mkChar("dim_in_S1b_2"));
  SET_STRING_ELT(state_names, 510, mkChar("in_S1b"));
  SET_STRING_ELT(state_names, 511, mkChar("dim_in_S1c"));
  SET_STRING_ELT(state_names, 512, mkChar("dim_in_S1c_1"));
  SET_STRING_ELT(state_names, 513, mkChar("dim_in_S1c_2"));
  SET_STRING_ELT(state_names, 514, mkChar("in_S1c"));
  SET_STRING_ELT(state_names, 515, mkChar("dim_in_S1d"));
  SET_STRING_ELT(state_names, 516, mkChar("dim_in_S1d_1"));
  SET_STRING_ELT(state_names, 517, mkChar("dim_in_S1d_2"));
  SET_STRING_ELT(state_names, 518, mkChar("in_S1d"));
  SET_STRING_ELT(state_names, 519, mkChar("dim_in_I01"));
  SET_STRING_ELT(state_names, 520, mkChar("dim_in_I01_1"));
  SET_STRING_ELT(state_names, 521, mkChar("dim_in_I01_2"));
  SET_STRING_ELT(state_names, 522, mkChar("in_I01"));
  SET_STRING_ELT(state_names, 523, mkChar("dim_in_I11"));
  SET_STRING_ELT(state_names, 524, mkChar("dim_in_I11_1"));
  SET_STRING_ELT(state_names, 525, mkChar("dim_in_I11_2"));
  SET_STRING_ELT(state_names, 526, mkChar("in_I11"));
  SET_STRING_ELT(state_names, 527, mkChar("dim_in_I02"));
  SET_STRING_ELT(state_names, 528, mkChar("dim_in_I02_1"));
  SET_STRING_ELT(state_names, 529, mkChar("dim_in_I02_2"));
  SET_STRING_ELT(state_names, 530, mkChar("in_I02"));
  SET_STRING_ELT(state_names, 531, mkChar("dim_in_I03"));
  SET_STRING_ELT(state_names, 532, mkChar("dim_in_I03_1"));
  SET_STRING_ELT(state_names, 533, mkChar("dim_in_I03_2"));
  SET_STRING_ELT(state_names, 534, mkChar("in_I03"));
  SET_STRING_ELT(state_names, 535, mkChar("dim_in_I04"));
  SET_STRING_ELT(state_names, 536, mkChar("dim_in_I04_1"));
  SET_STRING_ELT(state_names, 537, mkChar("dim_in_I04_2"));
  SET_STRING_ELT(state_names, 538, mkChar("in_I04"));
  SET_STRING_ELT(state_names, 539, mkChar("dim_in_I05"));
  SET_STRING_ELT(state_names, 540, mkChar("dim_in_I05_1"));
  SET_STRING_ELT(state_names, 541, mkChar("dim_in_I05_2"));
  SET_STRING_ELT(state_names, 542, mkChar("in_I05"));
  SET_STRING_ELT(state_names, 543, mkChar("dim_in_I22"));
  SET_STRING_ELT(state_names, 544, mkChar("dim_in_I22_1"));
  SET_STRING_ELT(state_names, 545, mkChar("dim_in_I22_2"));
  SET_STRING_ELT(state_names, 546, mkChar("in_I22"));
  SET_STRING_ELT(state_names, 547, mkChar("dim_in_I23"));
  SET_STRING_ELT(state_names, 548, mkChar("dim_in_I23_1"));
  SET_STRING_ELT(state_names, 549, mkChar("dim_in_I23_2"));
  SET_STRING_ELT(state_names, 550, mkChar("in_I23"));
  SET_STRING_ELT(state_names, 551, mkChar("dim_in_I24"));
  SET_STRING_ELT(state_names, 552, mkChar("dim_in_I24_1"));
  SET_STRING_ELT(state_names, 553, mkChar("dim_in_I24_2"));
  SET_STRING_ELT(state_names, 554, mkChar("in_I24"));
  SET_STRING_ELT(state_names, 555, mkChar("dim_in_I25"));
  SET_STRING_ELT(state_names, 556, mkChar("dim_in_I25_1"));
  SET_STRING_ELT(state_names, 557, mkChar("dim_in_I25_2"));
  SET_STRING_ELT(state_names, 558, mkChar("in_I25"));
  SET_STRING_ELT(state_names, 559, mkChar("dim_in_I32"));
  SET_STRING_ELT(state_names, 560, mkChar("dim_in_I32_1"));
  SET_STRING_ELT(state_names, 561, mkChar("dim_in_I32_2"));
  SET_STRING_ELT(state_names, 562, mkChar("in_I32"));
  SET_STRING_ELT(state_names, 563, mkChar("dim_in_I33"));
  SET_STRING_ELT(state_names, 564, mkChar("dim_in_I33_1"));
  SET_STRING_ELT(state_names, 565, mkChar("dim_in_I33_2"));
  SET_STRING_ELT(state_names, 566, mkChar("in_I33"));
  SET_STRING_ELT(state_names, 567, mkChar("dim_in_I34"));
  SET_STRING_ELT(state_names, 568, mkChar("dim_in_I34_1"));
  SET_STRING_ELT(state_names, 569, mkChar("dim_in_I34_2"));
  SET_STRING_ELT(state_names, 570, mkChar("in_I34"));
  SET_STRING_ELT(state_names, 571, mkChar("dim_in_I35"));
  SET_STRING_ELT(state_names, 572, mkChar("dim_in_I35_1"));
  SET_STRING_ELT(state_names, 573, mkChar("dim_in_I35_2"));
  SET_STRING_ELT(state_names, 574, mkChar("in_I35"));
  SET_STRING_ELT(state_names, 575, mkChar("dim_in_I42"));
  SET_STRING_ELT(state_names, 576, mkChar("dim_in_I42_1"));
  SET_STRING_ELT(state_names, 577, mkChar("dim_in_I42_2"));
  SET_STRING_ELT(state_names, 578, mkChar("in_I42"));
  SET_STRING_ELT(state_names, 579, mkChar("dim_in_I43"));
  SET_STRING_ELT(state_names, 580, mkChar("dim_in_I43_1"));
  SET_STRING_ELT(state_names, 581, mkChar("dim_in_I43_2"));
  SET_STRING_ELT(state_names, 582, mkChar("in_I43"));
  SET_STRING_ELT(state_names, 583, mkChar("dim_in_I44"));
  SET_STRING_ELT(state_names, 584, mkChar("dim_in_I44_1"));
  SET_STRING_ELT(state_names, 585, mkChar("dim_in_I44_2"));
  SET_STRING_ELT(state_names, 586, mkChar("in_I44"));
  SET_STRING_ELT(state_names, 587, mkChar("dim_in_I45"));
  SET_STRING_ELT(state_names, 588, mkChar("dim_in_I45_1"));
  SET_STRING_ELT(state_names, 589, mkChar("dim_in_I45_2"));
  SET_STRING_ELT(state_names, 590, mkChar("in_I45"));
  SET_STRING_ELT(state_names, 591, mkChar("dim_sum_in_S0"));
  SET_STRING_ELT(state_names, 592, mkChar("sum_in_S0"));
  SET_STRING_ELT(state_names, 593, mkChar("offset_output_sum_in_S0"));
  SET_STRING_ELT(state_names, 594, mkChar("dim_rate_move_in"));
  SET_STRING_ELT(state_names, 595, mkChar("dim_rate_move_in_1"));
  SET_STRING_ELT(state_names, 596, mkChar("dim_rate_move_in_2"));
  SET_STRING_ELT(state_names, 597, mkChar("rate_move_in"));
  SET_STRING_ELT(state_names, 598, mkChar("offset_output_rate_move_in"));
  SET_STRING_ELT(state_names, 599, mkChar("dim_rate_move_out"));
  SET_STRING_ELT(state_names, 600, mkChar("rate_move_out"));
  SET_STRING_ELT(state_names, 601, mkChar("offset_output_rate_move_out"));
  SET_STRING_ELT(state_names, 602, mkChar("interpolate_c_comm"));
  SET_STRING_ELT(state_names, 603, mkChar("interpolate_c_noncomm"));
  SET_STRING_ELT(state_names, 604, mkChar("interpolate_testing_prob"));
  SET_STRING_ELT(state_names, 605, mkChar("interpolate_ART_prob"));
  SET_STRING_ELT(state_names, 606, mkChar("interpolate_epsilon"));
  SET_STRING_ELT(state_names, 607, mkChar("epsilon"));
  SET_STRING_ELT(state_names, 608, mkChar("interpolate_zetaa"));
  SET_STRING_ELT(state_names, 609, mkChar("interpolate_zetab"));
  SET_STRING_ELT(state_names, 610, mkChar("interpolate_zetac"));
  SET_STRING_ELT(state_names, 611, mkChar("interpolate_fc_comm"));
  SET_STRING_ELT(state_names, 612, mkChar("interpolate_fP_comm"));
  SET_STRING_ELT(state_names, 613, mkChar("interpolate_fc_noncomm"));
  SET_STRING_ELT(state_names, 614, mkChar("interpolate_fP_noncomm"));
  SET_STRING_ELT(state_names, 615, mkChar("dim"));
  SET_STRING_ELT(state_names, 616, mkChar("dim_output"));
  setAttrib(state, R_NamesSymbol, state_names);
  UNPROTECT(2);
  return state;
}

// Report back to R information on variable ordering
// The reported information includes position and length of each
// variable, from which offset, etc, can be worked out.
SEXP main_model_variable_order(SEXP main_model_ptr) {
  main_model_pars *main_model_p = main_model_get_pointer(main_model_ptr, 1);
  SEXP state_len = PROTECT(allocVector(VECSXP, 25));
  SEXP state_names = PROTECT(allocVector(STRSXP, 25));
  SET_VECTOR_ELT(state_len, 0, ScalarInteger(main_model_p->dim_cumuInf));
  SET_STRING_ELT(state_names, 0, mkChar("cumuInf"));
  SET_VECTOR_ELT(state_len, 1, ScalarInteger(main_model_p->dim_OnPrEP));
  SET_STRING_ELT(state_names, 1, mkChar("OnPrEP"));
  SET_VECTOR_ELT(state_len, 2, ScalarInteger(main_model_p->dim_S0));
  SET_STRING_ELT(state_names, 2, mkChar("S0"));
  SET_VECTOR_ELT(state_len, 3, ScalarInteger(main_model_p->dim_S1a));
  SET_STRING_ELT(state_names, 3, mkChar("S1a"));
  SET_VECTOR_ELT(state_len, 4, ScalarInteger(main_model_p->dim_S1b));
  SET_STRING_ELT(state_names, 4, mkChar("S1b"));
  SET_VECTOR_ELT(state_len, 5, ScalarInteger(main_model_p->dim_S1c));
  SET_STRING_ELT(state_names, 5, mkChar("S1c"));
  SET_VECTOR_ELT(state_len, 6, ScalarInteger(main_model_p->dim_S1d));
  SET_STRING_ELT(state_names, 6, mkChar("S1d"));
  SET_VECTOR_ELT(state_len, 7, ScalarInteger(main_model_p->dim_I01));
  SET_STRING_ELT(state_names, 7, mkChar("I01"));
  SET_VECTOR_ELT(state_len, 8, ScalarInteger(main_model_p->dim_I11));
  SET_STRING_ELT(state_names, 8, mkChar("I11"));
  SET_VECTOR_ELT(state_len, 9, ScalarInteger(main_model_p->dim_I02));
  SET_STRING_ELT(state_names, 9, mkChar("I02"));
  SET_VECTOR_ELT(state_len, 10, ScalarInteger(main_model_p->dim_I03));
  SET_STRING_ELT(state_names, 10, mkChar("I03"));
  SET_VECTOR_ELT(state_len, 11, ScalarInteger(main_model_p->dim_I04));
  SET_STRING_ELT(state_names, 11, mkChar("I04"));
  SET_VECTOR_ELT(state_len, 12, ScalarInteger(main_model_p->dim_I05));
  SET_STRING_ELT(state_names, 12, mkChar("I05"));
  SET_VECTOR_ELT(state_len, 13, ScalarInteger(main_model_p->dim_I22));
  SET_STRING_ELT(state_names, 13, mkChar("I22"));
  SET_VECTOR_ELT(state_len, 14, ScalarInteger(main_model_p->dim_I23));
  SET_STRING_ELT(state_names, 14, mkChar("I23"));
  SET_VECTOR_ELT(state_len, 15, ScalarInteger(main_model_p->dim_I24));
  SET_STRING_ELT(state_names, 15, mkChar("I24"));
  SET_VECTOR_ELT(state_len, 16, ScalarInteger(main_model_p->dim_I25));
  SET_STRING_ELT(state_names, 16, mkChar("I25"));
  SET_VECTOR_ELT(state_len, 17, ScalarInteger(main_model_p->dim_I32));
  SET_STRING_ELT(state_names, 17, mkChar("I32"));
  SET_VECTOR_ELT(state_len, 18, ScalarInteger(main_model_p->dim_I33));
  SET_STRING_ELT(state_names, 18, mkChar("I33"));
  SET_VECTOR_ELT(state_len, 19, ScalarInteger(main_model_p->dim_I34));
  SET_STRING_ELT(state_names, 19, mkChar("I34"));
  SET_VECTOR_ELT(state_len, 20, ScalarInteger(main_model_p->dim_I35));
  SET_STRING_ELT(state_names, 20, mkChar("I35"));
  SET_VECTOR_ELT(state_len, 21, ScalarInteger(main_model_p->dim_I42));
  SET_STRING_ELT(state_names, 21, mkChar("I42"));
  SET_VECTOR_ELT(state_len, 22, ScalarInteger(main_model_p->dim_I43));
  SET_STRING_ELT(state_names, 22, mkChar("I43"));
  SET_VECTOR_ELT(state_len, 23, ScalarInteger(main_model_p->dim_I44));
  SET_STRING_ELT(state_names, 23, mkChar("I44"));
  SET_VECTOR_ELT(state_len, 24, ScalarInteger(main_model_p->dim_I45));
  SET_STRING_ELT(state_names, 24, mkChar("I45"));
  setAttrib(state_len, R_NamesSymbol, state_names);
  UNPROTECT(2);
  return state_len;
}

// Report back to R information on output variable ordering
// Like the variable order above, but for any output vars
SEXP main_model_output_order(SEXP main_model_ptr) {
  main_model_pars *main_model_p = main_model_get_pointer(main_model_ptr, 1);
  int *tmp;
  SEXP state_len = PROTECT(allocVector(VECSXP, 79));
  SEXP state_names = PROTECT(allocVector(STRSXP, 79));
  SET_VECTOR_ELT(state_len, 0, R_NilValue);
  SET_STRING_ELT(state_names, 0, mkChar("who_believe_comm"));
  SET_VECTOR_ELT(state_len, 1, R_NilValue);
  SET_STRING_ELT(state_names, 1, mkChar("cumuInftot"));
  SET_VECTOR_ELT(state_len, 2, R_NilValue);
  SET_STRING_ELT(state_names, 2, mkChar("ART_coverage_men"));
  SET_VECTOR_ELT(state_len, 3, R_NilValue);
  SET_STRING_ELT(state_names, 3, mkChar("ART_coverage_women"));
  SET_VECTOR_ELT(state_len, 4, R_NilValue);
  SET_STRING_ELT(state_names, 4, mkChar("ART_coverage_FSW"));
  SET_VECTOR_ELT(state_len, 5, R_NilValue);
  SET_STRING_ELT(state_names, 5, mkChar("ART_coverage_all"));
  SET_VECTOR_ELT(state_len, 6, R_NilValue);
  SET_STRING_ELT(state_names, 6, mkChar("Ncat"));
  SET_VECTOR_ELT(state_len, 7, R_NilValue);
  SET_STRING_ELT(state_names, 7, mkChar("Nage"));
  SET_VECTOR_ELT(state_len, 8, R_NilValue);
  SET_STRING_ELT(state_names, 8, mkChar("dur_FSW"));
  SET_VECTOR_ELT(state_len, 9, R_NilValue);
  SET_STRING_ELT(state_names, 9, mkChar("epsilon"));
  SET_VECTOR_ELT(state_len, 10, R_NilValue);
  SET_STRING_ELT(state_names, 10, mkChar("Ntot_inc_former_FSW_nonCot"));
  SET_VECTOR_ELT(state_len, 11, R_NilValue);
  SET_STRING_ELT(state_names, 11, mkChar("frac_virgin"));
  SET_VECTOR_ELT(state_len, 12, R_NilValue);
  SET_STRING_ELT(state_names, 12, mkChar("prev_LowFSW"));
  SET_VECTOR_ELT(state_len, 13, R_NilValue);
  SET_STRING_ELT(state_names, 13, mkChar("prev_men"));
  SET_VECTOR_ELT(state_len, 14, R_NilValue);
  SET_STRING_ELT(state_names, 14, mkChar("prev_women"));
  SET_VECTOR_ELT(state_len, 15, R_NilValue);
  SET_STRING_ELT(state_names, 15, mkChar("Ntot"));
  SET_VECTOR_ELT(state_len, 16, R_NilValue);
  SET_STRING_ELT(state_names, 16, mkChar("new_people"));
  SET_VECTOR_ELT(state_len, 17, R_NilValue);
  SET_STRING_ELT(state_names, 17, mkChar("prev_FSW"));
  SET_VECTOR_ELT(state_len, 18, R_NilValue);
  SET_STRING_ELT(state_names, 18, mkChar("prev_client"));
  SET_VECTOR_ELT(state_len, 19, R_NilValue);
  SET_STRING_ELT(state_names, 19, mkChar("B_check_comm"));
  SET_VECTOR_ELT(state_len, 20, R_NilValue);
  SET_STRING_ELT(state_names, 20, mkChar("B_check_noncomm"));
  SET_VECTOR_ELT(state_len, 21, ScalarInteger(main_model_p->dim_c_comm));
  SET_STRING_ELT(state_names, 21, mkChar("c_comm"));
  SET_VECTOR_ELT(state_len, 22, ScalarInteger(main_model_p->dim_c_noncomm));
  SET_STRING_ELT(state_names, 22, mkChar("c_noncomm"));
  SET_VECTOR_ELT(state_len, 23, ScalarInteger(main_model_p->dim_new_people_in_group));
  SET_STRING_ELT(state_names, 23, mkChar("new_people_in_group"));
  SET_VECTOR_ELT(state_len, 24, ScalarInteger(main_model_p->dim_testing_prob));
  SET_STRING_ELT(state_names, 24, mkChar("testing_prob"));
  SET_VECTOR_ELT(state_len, 25, ScalarInteger(main_model_p->dim_ART_prob));
  SET_STRING_ELT(state_names, 25, mkChar("ART_prob"));
  SET_VECTOR_ELT(state_len, 26, ScalarInteger(main_model_p->dim_tau));
  SET_STRING_ELT(state_names, 26, mkChar("tau"));
  SET_VECTOR_ELT(state_len, 27, ScalarInteger(main_model_p->dim_rho));
  SET_STRING_ELT(state_names, 27, mkChar("rho"));
  SET_VECTOR_ELT(state_len, 28, ScalarInteger(main_model_p->dim_frac_F));
  SET_STRING_ELT(state_names, 28, mkChar("frac_F"));
  SET_VECTOR_ELT(state_len, 29, ScalarInteger(main_model_p->dim_frac_N_sexualpop));
  SET_STRING_ELT(state_names, 29, mkChar("frac_N_sexualpop"));
  SET_VECTOR_ELT(state_len, 30, ScalarInteger(main_model_p->dim_zetaa));
  SET_STRING_ELT(state_names, 30, mkChar("zetaa"));
  SET_VECTOR_ELT(state_len, 31, ScalarInteger(main_model_p->dim_zetab));
  SET_STRING_ELT(state_names, 31, mkChar("zetab"));
  SET_VECTOR_ELT(state_len, 32, ScalarInteger(main_model_p->dim_zetac));
  SET_STRING_ELT(state_names, 32, mkChar("zetac"));
  SET_VECTOR_ELT(state_len, 33, ScalarInteger(main_model_p->dim_omega));
  SET_STRING_ELT(state_names, 33, mkChar("omega"));
  SET_VECTOR_ELT(state_len, 34, ScalarInteger(main_model_p->dim_frac_N));
  SET_STRING_ELT(state_names, 34, mkChar("frac_N"));
  SET_VECTOR_ELT(state_len, 35, ScalarInteger(main_model_p->dim_mu));
  SET_STRING_ELT(state_names, 35, mkChar("mu"));
  SET_VECTOR_ELT(state_len, 36, ScalarInteger(main_model_p->dim_gamma01));
  SET_STRING_ELT(state_names, 36, mkChar("gamma01"));
  SET_VECTOR_ELT(state_len, 37, ScalarInteger(main_model_p->dim_kappaa));
  SET_STRING_ELT(state_names, 37, mkChar("kappaa"));
  SET_VECTOR_ELT(state_len, 38, ScalarInteger(main_model_p->dim_kappab));
  SET_STRING_ELT(state_names, 38, mkChar("kappab"));
  SET_VECTOR_ELT(state_len, 39, ScalarInteger(main_model_p->dim_kappac));
  SET_STRING_ELT(state_names, 39, mkChar("kappac"));
  SET_VECTOR_ELT(state_len, 40, ScalarInteger(main_model_p->dim_alpha05));
  SET_STRING_ELT(state_names, 40, mkChar("alpha05"));
  SET_VECTOR_ELT(state_len, 41, ScalarInteger(main_model_p->dim_alpha35));
  SET_STRING_ELT(state_names, 41, mkChar("alpha35"));
  SET_VECTOR_ELT(state_len, 42, ScalarInteger(main_model_p->dim_beta_comm));
  SET_STRING_ELT(state_names, 42, mkChar("beta_comm"));
  SET_VECTOR_ELT(state_len, 43, ScalarInteger(main_model_p->dim_beta_noncomm));
  SET_STRING_ELT(state_names, 43, mkChar("beta_noncomm"));
  SET_VECTOR_ELT(state_len, 44, allocVector(INTSXP, 2));
  tmp = INTEGER(VECTOR_ELT(state_len, 44));
  tmp[0] = main_model_p->dim_p_comm_1;
  tmp[1] = main_model_p->dim_p_comm_2;
  SET_STRING_ELT(state_names, 44, mkChar("p_comm"));
  SET_VECTOR_ELT(state_len, 45, allocVector(INTSXP, 2));
  tmp = INTEGER(VECTOR_ELT(state_len, 45));
  tmp[0] = main_model_p->dim_p_noncomm_1;
  tmp[1] = main_model_p->dim_p_noncomm_2;
  SET_STRING_ELT(state_names, 45, mkChar("p_noncomm"));
  SET_VECTOR_ELT(state_len, 46, allocVector(INTSXP, 2));
  tmp = INTEGER(VECTOR_ELT(state_len, 46));
  tmp[0] = main_model_p->dim_fc_comm_1;
  tmp[1] = main_model_p->dim_fc_comm_2;
  SET_STRING_ELT(state_names, 46, mkChar("fc_comm"));
  SET_VECTOR_ELT(state_len, 47, ScalarInteger(main_model_p->dim_fP_comm));
  SET_STRING_ELT(state_names, 47, mkChar("fP_comm"));
  SET_VECTOR_ELT(state_len, 48, allocVector(INTSXP, 2));
  tmp = INTEGER(VECTOR_ELT(state_len, 48));
  tmp[0] = main_model_p->dim_fc_noncomm_1;
  tmp[1] = main_model_p->dim_fc_noncomm_2;
  SET_STRING_ELT(state_names, 48, mkChar("fc_noncomm"));
  SET_VECTOR_ELT(state_len, 49, ScalarInteger(main_model_p->dim_fP_noncomm));
  SET_STRING_ELT(state_names, 49, mkChar("fP_noncomm"));
  SET_VECTOR_ELT(state_len, 50, allocVector(INTSXP, 2));
  tmp = INTEGER(VECTOR_ELT(state_len, 50));
  tmp[0] = main_model_p->dim_n_comm_1;
  tmp[1] = main_model_p->dim_n_comm_2;
  SET_STRING_ELT(state_names, 50, mkChar("n_comm"));
  SET_VECTOR_ELT(state_len, 51, allocVector(INTSXP, 2));
  tmp = INTEGER(VECTOR_ELT(state_len, 51));
  tmp[0] = main_model_p->dim_n_noncomm_1;
  tmp[1] = main_model_p->dim_n_noncomm_2;
  SET_STRING_ELT(state_names, 51, mkChar("n_noncomm"));
  SET_VECTOR_ELT(state_len, 52, ScalarInteger(main_model_p->dim_N));
  SET_STRING_ELT(state_names, 52, mkChar("N"));
  SET_VECTOR_ELT(state_len, 53, ScalarInteger(main_model_p->dim_E0));
  SET_STRING_ELT(state_names, 53, mkChar("E0"));
  SET_VECTOR_ELT(state_len, 54, ScalarInteger(main_model_p->dim_E1a));
  SET_STRING_ELT(state_names, 54, mkChar("E1a"));
  SET_VECTOR_ELT(state_len, 55, ScalarInteger(main_model_p->dim_E1b));
  SET_STRING_ELT(state_names, 55, mkChar("E1b"));
  SET_VECTOR_ELT(state_len, 56, ScalarInteger(main_model_p->dim_E1c));
  SET_STRING_ELT(state_names, 56, mkChar("E1c"));
  SET_VECTOR_ELT(state_len, 57, ScalarInteger(main_model_p->dim_E1d));
  SET_STRING_ELT(state_names, 57, mkChar("E1d"));
  SET_VECTOR_ELT(state_len, 58, ScalarInteger(main_model_p->dim_alphaItot));
  SET_STRING_ELT(state_names, 58, mkChar("alphaItot"));
  SET_VECTOR_ELT(state_len, 59, ScalarInteger(main_model_p->dim_prev));
  SET_STRING_ELT(state_names, 59, mkChar("prev"));
  SET_VECTOR_ELT(state_len, 60, allocVector(INTSXP, 2));
  tmp = INTEGER(VECTOR_ELT(state_len, 60));
  tmp[0] = main_model_p->dim_lambda_1;
  tmp[1] = main_model_p->dim_lambda_2;
  SET_STRING_ELT(state_names, 60, mkChar("lambda"));
  SET_VECTOR_ELT(state_len, 61, allocVector(INTSXP, 2));
  tmp = INTEGER(VECTOR_ELT(state_len, 61));
  tmp[0] = main_model_p->dim_lambda_0_1;
  tmp[1] = main_model_p->dim_lambda_0_2;
  SET_STRING_ELT(state_names, 61, mkChar("lambda_0"));
  SET_VECTOR_ELT(state_len, 62, allocVector(INTSXP, 2));
  tmp = INTEGER(VECTOR_ELT(state_len, 62));
  tmp[0] = main_model_p->dim_lambda_1a_1;
  tmp[1] = main_model_p->dim_lambda_1a_2;
  SET_STRING_ELT(state_names, 62, mkChar("lambda_1a"));
  SET_VECTOR_ELT(state_len, 63, allocVector(INTSXP, 2));
  tmp = INTEGER(VECTOR_ELT(state_len, 63));
  tmp[0] = main_model_p->dim_lambda_1b_1;
  tmp[1] = main_model_p->dim_lambda_1b_2;
  SET_STRING_ELT(state_names, 63, mkChar("lambda_1b"));
  SET_VECTOR_ELT(state_len, 64, allocVector(INTSXP, 2));
  tmp = INTEGER(VECTOR_ELT(state_len, 64));
  tmp[0] = main_model_p->dim_lambda_1c_1;
  tmp[1] = main_model_p->dim_lambda_1c_2;
  SET_STRING_ELT(state_names, 64, mkChar("lambda_1c"));
  SET_VECTOR_ELT(state_len, 65, allocVector(INTSXP, 2));
  tmp = INTEGER(VECTOR_ELT(state_len, 65));
  tmp[0] = main_model_p->dim_lambda_1d_1;
  tmp[1] = main_model_p->dim_lambda_1d_2;
  SET_STRING_ELT(state_names, 65, mkChar("lambda_1d"));
  SET_VECTOR_ELT(state_len, 66, ScalarInteger(main_model_p->dim_lambda_sum_0));
  SET_STRING_ELT(state_names, 66, mkChar("lambda_sum_0"));
  SET_VECTOR_ELT(state_len, 67, ScalarInteger(main_model_p->dim_lambda_sum_1a));
  SET_STRING_ELT(state_names, 67, mkChar("lambda_sum_1a"));
  SET_VECTOR_ELT(state_len, 68, ScalarInteger(main_model_p->dim_lambda_sum_1b));
  SET_STRING_ELT(state_names, 68, mkChar("lambda_sum_1b"));
  SET_VECTOR_ELT(state_len, 69, ScalarInteger(main_model_p->dim_lambda_sum_1c));
  SET_STRING_ELT(state_names, 69, mkChar("lambda_sum_1c"));
  SET_VECTOR_ELT(state_len, 70, ScalarInteger(main_model_p->dim_lambda_sum_1d));
  SET_STRING_ELT(state_names, 70, mkChar("lambda_sum_1d"));
  SET_VECTOR_ELT(state_len, 71, ScalarInteger(main_model_p->dim_c_comm_balanced));
  SET_STRING_ELT(state_names, 71, mkChar("c_comm_balanced"));
  SET_VECTOR_ELT(state_len, 72, ScalarInteger(main_model_p->dim_c_noncomm_balanced));
  SET_STRING_ELT(state_names, 72, mkChar("c_noncomm_balanced"));
  SET_VECTOR_ELT(state_len, 73, allocVector(INTSXP, 2));
  tmp = INTEGER(VECTOR_ELT(state_len, 73));
  tmp[0] = main_model_p->dim_theta_1;
  tmp[1] = main_model_p->dim_theta_2;
  SET_STRING_ELT(state_names, 73, mkChar("theta"));
  SET_VECTOR_ELT(state_len, 74, allocVector(INTSXP, 2));
  tmp = INTEGER(VECTOR_ELT(state_len, 74));
  tmp[0] = main_model_p->dim_M_comm_1;
  tmp[1] = main_model_p->dim_M_comm_2;
  SET_STRING_ELT(state_names, 74, mkChar("M_comm"));
  SET_VECTOR_ELT(state_len, 75, allocVector(INTSXP, 2));
  tmp = INTEGER(VECTOR_ELT(state_len, 75));
  tmp[0] = main_model_p->dim_M_noncomm_1;
  tmp[1] = main_model_p->dim_M_noncomm_2;
  SET_STRING_ELT(state_names, 75, mkChar("M_noncomm"));
  SET_VECTOR_ELT(state_len, 76, ScalarInteger(main_model_p->dim_sum_in_S0));
  SET_STRING_ELT(state_names, 76, mkChar("sum_in_S0"));
  SET_VECTOR_ELT(state_len, 77, allocVector(INTSXP, 2));
  tmp = INTEGER(VECTOR_ELT(state_len, 77));
  tmp[0] = main_model_p->dim_rate_move_in_1;
  tmp[1] = main_model_p->dim_rate_move_in_2;
  SET_STRING_ELT(state_names, 77, mkChar("rate_move_in"));
  SET_VECTOR_ELT(state_len, 78, ScalarInteger(main_model_p->dim_rate_move_out));
  SET_STRING_ELT(state_names, 78, mkChar("rate_move_out"));
  setAttrib(state_len, R_NamesSymbol, state_names);
  UNPROTECT(2);
  return state_len;
}

// Report back to R information about interpolating functions
SEXP main_model_interpolate_t(SEXP main_model_ptr) {
  main_model_pars *main_model_p = main_model_get_pointer(main_model_ptr, 1);
  SEXP ret = PROTECT(allocVector(REALSXP, 2));
  double *r = REAL(ret);
  r[0] = main_model_p->ART_prob_t[0];
  r[1] = main_model_p->ART_prob_t[main_model_p->dim_ART_prob_t - 1];
  r[0] = fmax(r[0], main_model_p->c_t_comm[0]);
  r[1] = fmin(r[1], main_model_p->c_t_comm[main_model_p->dim_c_t_comm - 1]);
  r[0] = fmax(r[0], main_model_p->c_t_noncomm[0]);
  r[1] = fmin(r[1], main_model_p->c_t_noncomm[main_model_p->dim_c_t_noncomm - 1]);
  r[0] = fmax(r[0], main_model_p->fc_t_comm[0]);
  r[1] = fmin(r[1], main_model_p->fc_t_comm[main_model_p->dim_fc_t_comm - 1]);
  r[0] = fmax(r[0], main_model_p->fc_t_noncomm[0]);
  r[1] = fmin(r[1], main_model_p->fc_t_noncomm[main_model_p->dim_fc_t_noncomm - 1]);
  r[0] = fmax(r[0], main_model_p->fP_t_comm[0]);
  r[1] = fmin(r[1], main_model_p->fP_t_comm[main_model_p->dim_fP_t_comm - 1]);
  r[0] = fmax(r[0], main_model_p->fP_t_noncomm[0]);
  r[1] = fmin(r[1], main_model_p->fP_t_noncomm[main_model_p->dim_fP_t_noncomm - 1]);
  r[0] = fmax(r[0], main_model_p->testing_prob_t[0]);
  r[1] = fmin(r[1], main_model_p->testing_prob_t[main_model_p->dim_testing_prob_t - 1]);
  r[0] = fmax(r[0], main_model_p->epsilon_t[0]);
  r[0] = fmax(r[0], main_model_p->zetaa_t[0]);
  r[0] = fmax(r[0], main_model_p->zetab_t[0]);
  r[0] = fmax(r[0], main_model_p->zetac_t[0]);
  UNPROTECT(1);
  return ret;
}

main_model_pars* main_model_get_pointer(SEXP main_model_ptr, int closed_error) {
  main_model_pars *main_model_p = NULL;
  if (TYPEOF(main_model_ptr) != EXTPTRSXP) {
    Rf_error("Expected an external pointer");
  }
  main_model_p = (main_model_pars*) R_ExternalPtrAddr(main_model_ptr);
  if (!main_model_p && closed_error) {
    Rf_error("Pointer has been invalidated");
  }
  return main_model_p;
}

SEXP get_ds_pars() {
  static DL_FUNC get_deSolve_gparms = NULL;
  if (get_deSolve_gparms == NULL) {
    get_deSolve_gparms = R_GetCCallable("deSolve", "get_deSolve_gparms");
  }
  return get_deSolve_gparms();
}
double get_user_double(SEXP user, const char *name, double default_value) {
  double ret = default_value;
  SEXP el = get_list_element(user, name);
  if (el != R_NilValue) {
    if (length(el) != 1) {
      Rf_error("Expected scalar numeric for %s", name);
    }
    if (TYPEOF(el) == REALSXP) {
      ret = REAL(el)[0];
    } else if (TYPEOF(el) == INTSXP) {
      ret = INTEGER(el)[0];
    } else {
      Rf_error("Expected a numeric value for %s", name);
    }
  }
  if (ISNA(ret)) {
    Rf_error("Expected value for %s", name);
  }
  return ret;
}
double* get_user_array_dim(SEXP user, const char *name, bool is_real, int nd, int *dest_dim) {
  SEXP el = get_user_array_check_rank(user, name, nd);

  if (nd == 1) {
    dest_dim[0] = LENGTH(el);
  } else {
    SEXP r_dim = PROTECT(coerceVector(getAttrib(el, R_DimSymbol), INTSXP));
    int *dim = INTEGER(r_dim);

    for (size_t i = 0; i < (size_t) nd; ++i) {
      dest_dim[i] = dim[i];
    }

    UNPROTECT(1);
  }

  void *dest;
  if (is_real) {
    dest = (double*) Calloc(length(el), double);
  } else {
    dest = (int*) Calloc(length(el), int);
  }
  get_user_array_copy(el, name, is_real, dest);
  return dest;
}
SEXP get_user_array_check_rank(SEXP user, const char *name, int nd) {
  SEXP el = get_list_element(user, name);
  if (el == R_NilValue) {
    Rf_error("Expected value for %s", name);
  } else {
    if (nd == 1) {
      if (isArray(el)) {
        // this may be too strict as a length-1 dim here will fail
        Rf_error("Expected a vector for %s", name);
      }
    } else {
      SEXP r_dim = getAttrib(el, R_DimSymbol);
      if (r_dim == R_NilValue || LENGTH(r_dim) != nd) {
        if (nd == 2) {
          Rf_error("Expected a matrix for %s", name);
        } else {
          Rf_error("Expected a %dd array for %s", nd, name);
        }
      }
    }
  }
  return el;
}
void get_user_array_copy(SEXP el, const char *name, bool is_real, void *dest) {
  int given_int = TYPEOF(el) == INTSXP;
  size_t n = (size_t) length(el);
  if (is_real) {
    if (given_int) {
      el = PROTECT(coerceVector(el, REALSXP));
    } else if (TYPEOF(el) != REALSXP) {
      Rf_error("Expected a numeric value for %s", name);
    }
    memcpy(dest, REAL(el), n * sizeof(double));
  } else {
    if (TYPEOF(el) == REALSXP) {
      el = PROTECT(coerceVector(el, INTSXP));
    } else if (TYPEOF(el) != INTSXP) {
      Rf_error("Expected a numeric value for %s", name);
    }
    memcpy(dest, INTEGER(el), n * sizeof(int));
  }
  if (given_int == is_real) {
    UNPROTECT(1);
  }
}
void odin_set_dim(SEXP target, int nd, ...) {
  SEXP r_dim = PROTECT(allocVector(INTSXP, nd));
  int *dim = INTEGER(r_dim);

  va_list ap;
  va_start(ap, nd);
  for (size_t i = 0; i < (size_t)nd; ++i) {
    dim[i] = va_arg(ap, int);
  }
  va_end(ap);

  setAttrib(target, R_DimSymbol, r_dim);
  UNPROTECT(1);
}
int get_user_int(SEXP user, const char *name, int default_value) {
  int ret = default_value;
  SEXP el = get_list_element(user, name);
  if (el != R_NilValue) {
    if (length(el) != 1) {
      Rf_error("Expected scalar integer for %d", name);
    }
    ret = INTEGER(coerceVector(el, INTSXP))[0];
  }
  if (ret == NA_INTEGER) {
    Rf_error("Expected value for %s", name);
  }
  return ret;
}
void get_user_array(SEXP user, const char *name, bool is_real, void *dest, int nd, ...) {
  SEXP el = get_user_array_check_rank(user, name, nd);
  SEXP r_dim;
  int *dim;

  if (nd == 1) {
    r_dim = PROTECT(ScalarInteger(LENGTH(el)));
  } else {
    r_dim = PROTECT(coerceVector(getAttrib(el, R_DimSymbol), INTSXP));
  }
  dim = INTEGER(r_dim);

  va_list ap;
  va_start(ap, nd);
  for (size_t i = 0; i < (size_t) nd; ++i) {
    int dim_expected = va_arg(ap, int);
    if (dim[i] != dim_expected) {
      va_end(ap); // avoid a leak
      if (nd == 1) {
        Rf_error("Expected length %d value for %s", dim_expected, name);
      } else {
        Rf_error("Incorrect size of dimension %d of %s (expected %d)",
                 i + 1, name, dim_expected);
      }
    }
  }
  va_end(ap);
  UNPROTECT(1);

  get_user_array_copy(el, name, is_real, dest);
}
SEXP get_list_element(SEXP list, const char *name) {
  SEXP ret = R_NilValue, names = getAttrib(list, R_NamesSymbol);
  for (int i = 0; i < length(list); ++i) {
    if(strcmp(CHAR(STRING_ELT(names, i)), name) == 0) {
      ret = VECTOR_ELT(list, i);
      break;
    }
  }
  return ret;
}
double odin_sum1(double *x, int from_i, int to_i) {
  double tot = 0.0;
  for (int i = from_i; i <= to_i; ++i) {
    tot += x[i];
  }
  return tot;
}
double odin_sum2(double *x, int from_i, int to_i, int from_j, int to_j, int dim_x_1) {
  double tot = 0.0;
  for (int j = from_j; j <= to_j; ++j) {
    int jj = j * dim_x_1;
    for (int i = from_i; i <= to_i; ++i) {
      tot += x[i + jj];
    }
  }
  return tot;
}
double FOI_part(double I, double N, double beta, double RR, double fc, double fP, double n, double eP, double ec) {
  
  return I * (1 -
              pow(1 -                       beta * RR, n * (1 - fc) * (1 - fP)) *
              pow(1 - (1 - ec) *            beta * RR, n *      fc  * (1 - fP)) *
              pow(1 -            (1 - eP) * beta * RR, n * (1 - fc) *      fP ) *
              pow(1 - (1 - ec) * (1 - eP) * beta * RR, n *      fc  *      fP ));
}
double all_FOI_together(double c, double p, double S0, double S1a, double S1b, double S1c, double I01, double I11, double I02, double I03, double I04, double I05, double I22, double I23, double I24, double I25, double I32, double I33, double I34, double I35, double I42, double I43, double I44, double I45, double N, double beta, double R, double fc, double fP, double n, double eP, double ec, double infect_ART, double infect_acute, double infect_AIDS) {
  if (c == 0 || p == 0) {
    return 0.0;
  } else {
    return 1 / N * c * p * (
        FOI_part(I01, N, beta, infect_acute, fc, fP, n, eP, ec) +
          FOI_part(I02, N, beta, R, fc, fP, n, eP, ec) +
          FOI_part(I03, N, beta, R, fc, fP, n, eP, ec) +
          FOI_part(I04, N, beta, R, fc, fP, n, eP, ec) +
          FOI_part(I05, N, beta, infect_AIDS, fc, fP, n, eP, ec) +
          
          FOI_part(I11, N, beta, infect_acute, fc, fP, n, eP, ec) +
          
          FOI_part(I22, N, beta, R, fc, fP, n, eP, ec) +
          FOI_part(I23, N, beta, R, fc, fP, n, eP, ec) +
          FOI_part(I24, N, beta, R, fc, fP, n, eP, ec) +
          FOI_part(I25, N, beta, infect_AIDS, fc, fP, n, eP, ec) +
          
          FOI_part(I32, N, beta, infect_ART, fc, fP, n, eP, ec) +
          FOI_part(I33, N, beta, infect_ART, fc, fP, n, eP, ec) +
          FOI_part(I34, N, beta, infect_ART, fc, fP, n, eP, ec) +
          FOI_part(I35, N, beta, infect_ART*infect_AIDS, fc, fP, n, eP, ec) +
          
          FOI_part(I42, N, beta, R, fc, fP, n, eP, ec) +
          FOI_part(I43, N, beta, R, fc, fP, n, eP, ec) +
          FOI_part(I44, N, beta, R, fc, fP, n, eP, ec) +
          FOI_part(I45, N, beta, infect_AIDS, fc, fP, n, eP, ec));
  }
}
double compute_lambda(double c_comm, double p_comm, double S0, double S1a, double S1b, double S1c, double I01, double I11, double I02, double I03, double I04, double I05, double I22, double I23, double I24, double I25, double I32, double I33, double I34, double I35, double I42, double I43, double I44, double I45, double N, double beta_comm, double R, double fc_comm, double fP_comm, double n_comm, double eP, double ec, double fc_noncomm, double fP_noncomm, double n_noncomm, double c_noncomm, double p_noncomm, double infect_ART, double infect_acute, double infect_AIDS,  double beta_noncomm) {
  return all_FOI_together(c_comm, p_comm, S0, S1a, S1b, S1c, I01, I11, I02, I03, I04, I05, I22, I23, I24, I25, I32, I33, I34, I35, I42, I43, I44, I45, N, beta_comm, R, fc_comm, fP_comm, n_comm, eP, ec, infect_ART, infect_acute, infect_AIDS) + all_FOI_together(c_noncomm, p_noncomm, S0, S1a, S1b, S1c, I01, I11, I02, I03, I04, I05, I22, I23, I24, I25, I32, I33, I34, I35, I42, I43, I44, I45, N, beta_noncomm, R, fc_noncomm, fP_noncomm, n_noncomm, eP, ec, infect_ART, infect_acute, infect_AIDS);
}

interpolate_data * interpolate_alloc(interpolate_type type,
                                     size_t n, size_t ny,
                                     double *x, double *y) {
  interpolate_data * ret = Calloc(1, interpolate_data);
  ret->type = type;
  ret->n = n;
  ret->ny = ny;
  ret->i = 0;
  ret->x = (double*) Calloc(n, double);
  ret->y = (double*) Calloc(n * ny, double);
  ret->k = NULL;
  memcpy(ret->x, x, sizeof(double) * n);
  memcpy(ret->y, y, sizeof(double) * n * ny);

  if (type == SPLINE) {
    ret->k = (double*) Calloc(n * ny, double);
    // Some transient space for the A matrix:
    double **A = (double**)R_alloc(n, sizeof(double*));
    for (size_t i = 0; i < n; ++i) {
      A[i] = (double*)R_alloc(n + 1, sizeof(double));
      memset(A[i], 0, (n + 1) * sizeof(double));
    }
    for (size_t i = 0; i < ny; ++i) {
      spline_knots(n, ret->x, ret->y + i * n, ret->k + i * n, A);
    }
  }
  return ret;
}

void interpolate_free(interpolate_data* obj) {
  if (obj) {
    Free(obj->x);
    Free(obj->y);
    Free(obj->k);
    Free(obj);
  }
}

// int interpolate_run(double x, interpolate_data *obj, double *y) {
// do a switch here...
//}

// Constant
int interpolate_constant_run(double x, interpolate_data *obj, double *y) {
  // Do a hunt/bisect search here
  int i = interpolate_search(x, obj);
  // In theory we might be able to handle this, but it's simpler to
  // forbid it I think.  In odin we'll do a check that the
  // interpolation times span the entire range of integration times.
  if (i < 0) {
    for (size_t j = 0; j < obj->ny; ++j) {
      y[j] = NA_REAL;
    }
    return -1;
  } else if (i == (int) obj->n) { // off the rhs
    i = obj->n - 1;
  }
  // TODO: In general, I wonder if this should be dealt with in interpolate
  // search?
  //
  // NOTE: In the R function 'approx' there is an argument 'f' that
  // deals with the 'ties' case more gracefully.  This is like the
  // default f=0, omitting this becomes like the option f=1.
  if (i != (int)obj->n - 1 && obj->x[i + 1] == x) {
    ++i;
  }

  double *y0 = obj->y + i;
  for (size_t j = 0; j < obj->ny; ++j, y0 += obj->n) {
    y[j] = *y0;
  }
  return 0;
}

// Linear
int interpolate_linear_run(double x, interpolate_data* obj, double *y) {
  int i = interpolate_search(x, obj);
  // In theory we might be able to handle this, but it's simpler to
  // forbid it I think.  In odin we'll do a check that the
  // interpolation times span the entire range of integration times.
  if (i < 0 || i == (int)obj->n) { // off the lhs or rhs
    for (size_t j = 0; j < obj->ny; ++j) {
      y[j] = NA_REAL;
    }
    return -1;
  }

  // Here we need to compute some things.
  //
  // TODO: deal with the case where i+1 is out of bounds; in that
  // case, it must be the case that x0 is equal to x.  This affects y1
  // in the same way.
  double x0 = obj->x[i], x1 = obj->x[i + 1];
  double scal = (x - x0) / (x1 - x0);

  double *y0 = obj->y + i;
  double *y1 = y0 + 1;

  for (size_t j = 0; j < obj->ny; ++j, y0 += obj->n, y1 += obj->n) {
    y[j] = *y0 + (*y1 - *y0) * scal;
  }

  return 0;
}

// Spline
int interpolate_spline_run(double x, interpolate_data* obj, double *y) {
  int i = interpolate_search(x, obj);
  if (i < 0 || i == (int)obj->n) { // off the lhs or rhs
    for (size_t j = 0; j < obj->ny; ++j) {
      y[j] = NA_REAL;
    }
    return -1;
  }
  double *ys = obj->y, *ks = obj->k;
  for (size_t j = 0; j < obj->ny; ++j, ys += obj->n, ks += obj->n) {
    y[j] = spline_eval_i(i, x, obj->x, ys, ks);
  }
  return 0;
}

int interpolate_search(double target, interpolate_data *obj) {
  int i0 = (int)obj->i, i1 = (int)obj->i, inc = 1;
  size_t n = obj->n;
  double *x = obj->x;

  if (x[i0] <= target) { // advance up until we hit the top
    if (i0 == (int)n - 1) { // guess is already *at* the top.
      return n;
    }
    i1 = i0 + inc;
    while (x[i1] < target) {
      i0 = i1;
      inc *= 2;
      i1 += inc;
      if (i1 >= (int)n) { // off the end of the buffer
        i1 = n - 1;
        if (x[i1] < target) {
          return n;
        }
        break;
      }
    }
  } else { // advance down
    if (i0 == 0) { // guess is already at the bottom
      return -1;
    }
    i0 = i0 - inc;
    while (x[i0] > target) {
      i1 = i0;
      inc *= 2;
      if (i0 < inc) {
        i0 = 0;
        if (x[i0] > target) {
          return -1;
        }
        break;
      }
      i0 -= inc;
    }
  }

  // Need to deal specially with this case apparently, but not sure
  // why.  It's possible that this only needs doing on one of the
  // early exits from the above loops.
  if (i1 - i0 == 1 && x[i1] < target) {
    obj->i = (size_t)i1;
    return i1;
  }

  while (i1 - i0 > 1) {
    int i2 = (i1 + i0) / 2;
    if (x[i2] < target) {
      i0 = i2;
    } else {
      i1 = i2;
    }
  }

  obj->i = (size_t)i0;
  return i0;
}

// Spline support
void spline_knots(size_t n, double *x, double *y, double *k, double **A) {
  spline_knots_A(n, x, y, A);
  gauss_solve(n, A, k);
}

double spline_eval_i(size_t i, double x, double *xs, double *ys, double *ks) {
  double t = (x - xs[i]) / (xs[i + 1] - xs[i]);
  double a =  ks[i] * (xs[i + 1] - xs[i]) - (ys[i + 1] - ys[i]);
  double b = -ks[i + 1] * (xs[i + 1] - xs[i]) + (ys[i + 1] - ys[i]);
  return (1 - t) * ys[i] + t * ys[i + 1] + t * (1 - t) * (a * (1 - t) + b * t);
}

void spline_knots_A(size_t n, double *x, double *y, double **A) {
  n--;
  for (size_t i = 1; i < n; i++) {
    A[i][i-1] = 1 / (x[i] - x[i-1]);
    A[i][i  ] = 2 * (1 / (x[i] - x[i-1]) + 1 / (x[i+1] - x[i])) ;
    A[i][i+1] = 1 / (x[i+1] - x[i]);
    A[i][n+1] = 3 *
      ((y[i]   - y[i-1]) / ((x[i  ] - x[i-1]) * (x[i  ] - x[i-1])) +
       (y[i+1] - y[i  ]) / ((x[i+1] - x[i  ]) * (x[i+1] - x[i  ])));
  }
  A[0][0  ] = 2 / (x[1] - x[0]);
  A[0][1  ] = 1 / (x[1] - x[0]);
  A[0][n+1] = 3 * (y[1] - y[0]) / ((x[1] - x[0]) * (x[1] - x[0]));
  A[n][n-1] = 1 / (x[n] - x[n-1]);
  A[n][n  ] = 2 / (x[n] - x[n-1]);
  A[n][n+1] = 3 * (y[n] - y[n-1]) / ((x[n] - x[n-1]) * (x[n] - x[n-1]));
}

// TODO: probably move to proper matrix at some point, rather than
// double pointer which is ugly to allocate (or allocate it in one
// blob).
void gauss_solve(size_t n, double **A, double *x) {
  size_t m = n;
  for (size_t k = 0; k < m; k++) { // column
    // pivot for column
    size_t i_max = 0;
    double i_max_val = -1000000; // -DBL_MAX
    for (size_t i = k; i < m; i++) {
      if (A[i][k] > i_max_val) {
        i_max = i;
        i_max_val = A[i][k];
      }
    }
    if (A[i_max][k] == 0) {
      Rf_error("matrix is singular!");
    };
    // Swap rows:
    double *tmp = A[k];
    A[k] = A[i_max];
    A[i_max] = tmp;
    // for all rows below pivot
    for (size_t i = k + 1; i < m; i++) {
      for (size_t j = k + 1; j < m + 1; j++) {
        A[i][j] = A[i][j] - A[k][j] * (A[i][k] / A[k][k]);
      }
      A[i][k] = 0;
    }
  }
  // NOTE: Some ints here...
  for (int i = m - 1; i >= 0; i--) { // rows = columns
    double v = A[i][m] / A[i][i];
    x[i] = v;
    for (int j = i - 1; j >= 0; j--) { // rows
      A[j][m] -= A[j][i] * v;
      A[j][i] = 0;
    }
  }
}

// check here, given information on the type, that we have at least 1
// point for type 0, 2 for type 1, and 3 for type 2.  That should work
// pretty happily.
void odin_interpolate_check(size_t nx, size_t ny, size_t i, const char *name_arg, const char *name_target) {
  if (nx != ny) {
    if (i == 0) {
      // vector case
      Rf_error("Expected %s to have length %d (for %s)",
               name_arg, nx, name_target);
    } else {
      // array case
      Rf_error("Expected dimension %d of %s to have size %d (for %s)",
               i, name_arg, nx, name_target);
    }
  }
}
